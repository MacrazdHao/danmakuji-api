!function(t){function e(e){for(var i,r,o=e[0],c=e[1],l=e[2],p=0,d=[];p<o.length;p++)r=o[p],s[r]&&d.push(s[r][0]),s[r]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);for(u&&u(e);d.length;)d.shift()();return n.push.apply(n,l||[]),a()}function a(){for(var t,e=0;e<n.length;e++){for(var a=n[e],i=!0,o=1;o<a.length;o++){var c=a[o];0!==s[c]&&(i=!1)}i&&(n.splice(e--,1),t=r(r.s=a[0]))}return t}var i={},s={1:0},n=[];function r(e){if(i[e])return i[e].exports;var a=i[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=i,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:a})},r.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var o=window.webpackJsonp=window.webpackJsonp||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var l=0;l<o.length;l++)e(o[l]);var u=c;n.push([43,0]),a()}({"+aD3":function(t,e,a){},"/0Mw":function(t,e,a){"use strict";var i=a("cIwn");a.n(i).a},"/2vu":function(t,e,a){"use strict";var i=a("i20A");a.n(i).a},"2Vk6":function(t,e,a){"use strict";var i=a("VLxh");a.n(i).a},"3LyO":function(t,e,a){},43:function(t,e,a){t.exports=a("Vtdi")},"5GW5":function(t,e,a){"use strict";var i=a("CVHr");a.n(i).a},"5Omr":function(t,e,a){"use strict";var i=a("NQdo");a.n(i).a},"5Pec":function(t,e,a){},"6+t+":function(t,e,a){"use strict";var i=a("+aD3");a.n(i).a},"9hM8":function(t,e,a){"use strict";var i=a("Ixc4");a.n(i).a},AIeq:function(t,e,a){"use strict";var i=a("bp7G");a.n(i).a},AOPO:function(t,e,a){"use strict";var i=a("AVLG");a.n(i).a},AVLG:function(t,e,a){},BP3X:function(t,e,a){"use strict";var i=a("qxA7");a.n(i).a},CVHr:function(t,e,a){},Ehod:function(t,e,a){"use strict";var i=a("ROX1");a.n(i).a},G6UV:function(t,e,a){"use strict";var i=a("iDRx");a.n(i).a},HJDd:function(t,e,a){},Ixc4:function(t,e,a){},JUUE:function(t,e,a){"use strict";var i=a("jd1T");a.n(i).a},Kd1n:function(t,e,a){"use strict";var i=a("gCL+");a.n(i).a},KtVF:function(t,e,a){},Ky9A:function(t,e,a){},L0Vw:function(t,e,a){},MIgP:function(t,e,a){},NQdo:function(t,e,a){},OPwn:function(t,e,a){"use strict";var i=a("bW/s");a.n(i).a},P24W:function(t,e,a){},ROX1:function(t,e,a){},RmXx:function(t,e,a){},VLxh:function(t,e,a){},Vtdi:function(t,e,a){"use strict";a.r(e),a("VRzm");var i=a("Kw5r"),s=a("XJYT"),n=a.n(s),r=(a("D66Q"),a("ls82"),a("MECJ")),o=a("vDqi"),c=a.n(o);c.a.interceptors.request.use(function(t){return localStorage.JWT_TOKEN&&(t.headers.Authorization="".concat(localStorage.JWT_TOKEN)),localStorage.setItem("ClientId",new Date-0),t.headers.ClientId="".concat(localStorage.ClientId),t},function(t){return Promise.reject(t)}),c.a.interceptors.response.use(function(t){return t},function(t){if(t&&t.response){switch(t.response.status){case 403:return t.message=t.response.data.msg,i.default.prototype.$message({message:t.message,type:"error"}),localStorage.setItem("USER_ID",""),localStorage.setItem("JWT_TOKEN",""),localStorage.setItem("loginUserName",""),localStorage.setItem("face",""),localStorage.setItem("ROLE",""),void setTimeout(function(){window.location.href="/"},2500);case 404:t.message="请求地址出错: ".concat(t.response.config.url);break;case 408:t.message="请求超时";break;case 500:t.message="服务器内部错误";break;default:t.message=t.response.data.msg}i.default.prototype.$message({message:t.message,type:"error"})}return Promise.reject(t)});var l,u,p,d,m,h=function(t){return c.a.post("".concat("","/auth/login"),t)},g=function(){return c.a.get("".concat("","/auth/logout"))},f=function(t){return c.a.get("".concat("","/tokens"),t)},v=function(t,e){return c.a.get("".concat("","/videos/").concat(t,"/").concat(e))},b=function(t,e){return c.a.get("".concat("","/episodes"),{params:{bangumiId:t,epIndex:e}})},y=function(t){return c.a.get("".concat("","/bangumis"),{params:{bangumiName:t}})},x=function(t){return c.a.get("".concat("","/replies"),{params:{epId:t}})},_=function(t,e){return c.a.get("".concat("","/replies"),{params:{epId:t,pn:e}})},w=function(t){return c.a.post("".concat("","/replies"),t)},C=function(t){return c.a.delete("".concat("","/replies/").concat(t))},k=function(t,e){return c.a.post("".concat("","/replies/like/").concat(t,"/").concat(e))},I=function(t,e){return c.a.get("".concat("","/replies/son"),{params:{prid:t,pn:e}})},S=function(t){return c.a.post("".concat("","/users"),t)},R=function(t,e){return c.a.put("".concat("","/users/").concat(t),e)},j=function(t){return c.a.get("".concat("","/episodes/").concat(t))},B=function(t,e){return c.a.get("".concat("","/messages/").concat(t,"/type/").concat(e))},E=function(t,e,a){return c.a.get("".concat("","/messages/").concat(t,"/type/").concat(e),{params:{pn:a}})},N=function(t){return c.a.get("".concat("","/messages/").concat(t,"/countInfo"))},T=function(t){return c.a.get("".concat("","/replies"),{params:{rid:t}})},O=function(t,e){return c.a.get("".concat("","/auth/verify/uid/").concat(t,"/key/").concat(e))},D=function(t){return c.a.get("".concat("","/users/").concat(t))},U=function(t){return c.a.post("".concat("","/videos/videoMatchInfo"),t)},L=function(t){return c.a.post("".concat("","/postBangumis"),t)},$=function(t){return c.a.get("".concat("","/postBangumis"),{params:t})},M=function(t){return c.a.put("".concat("","/postBangumis"),t)},P=function(t){return c.a.put("".concat("","/postBangumis/thumb"),t)},z=function(t){return c.a.delete("".concat("","/postBangumis/").concat(t))},A=function(t){return c.a.post("".concat("","/videos/matchSuccess"),t)},V=function(){return c.a.get("".concat("","/auth/emailReVerify"))},F=function(t,e){return c.a.put("".concat("","/users/").concat(t,"/pwd"),e)},G=function(t){return c.a.get("".concat("","/episodes/bid/").concat(t))},W=function(){return c.a.get("".concat("","/bangumis/mostView"))},Z=function(t){return c.a.get("".concat("","/bangumis/").concat(t))},K=function(t,e,a){return c.a.get("".concat("","/bangumis"),{params:{bangumiName:t,pageNum:e,pageSize:a}})},J=function(){return c.a.get("".concat("","/notices/showIndex"))},q=function(t){return c.a.get("".concat("","/notices/").concat(t))},H={name:"BangumiCard",props:["bangumi"],data:function(){return{}},methods:{goBangumiDetail:function(t){var e=this.$router.resolve({name:"bangumidetail",params:{bid:t.bangumiId,bangumi:t}});window.open(e.href,"_blank")}}},X=(a("lpWx"),a("KHd+")),Y=Object(X.a)(H,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"bangumi-card",on:{click:function(e){t.goBangumiDetail(t.bangumi)}}},[a("div",{staticClass:"bc-img-wrap"},[a("img",{staticClass:"bc-img",attrs:{src:t.bangumi.thumb}})]),a("div",{staticClass:"bangumi-card-info"},[a("div",[a("a",[t._v(t._s(t.bangumi.bangumiName.substring(0,28)))])]),a("div",[a("a",[t._v("集数:"+t._s(t.bangumi.episodeTotal))])])])])},[],!1,null,"49b32f72",null).exports,Q={name:"HelloWorld",props:{msg:String},components:{"bangumi-card":Y},data:function(){return{bangumis:"",page:"",showSearchResult:!1,searchBangumis:"",searchPage:"",searchBangumiName:"",snForPageSearch:"",searchResloading:!0,notice:"",showNotice:!1,lastNoticeId:"",curNoticeId:""}},methods:{initBangumis:(m=Object(r.a)(regeneratorRuntime.mark(function t(){var e,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,W();case 2:e=t.sent,0===(a=e.data).code&&(this.bangumis=a.data.bangumi);case 5:case"end":return t.stop()}},t,this)})),function(){return m.apply(this,arguments)}),searchBangumisByName:(d=Object(r.a)(regeneratorRuntime.mark(function t(e){var a,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(""!==e){t.next=2;break}return t.abrupt("return");case 2:return this.snForPageSearch=e,t.next=5,y(e);case 5:a=t.sent,0===(i=a.data).code?(this.searchBangumis=i.data.content,this.page=i.data.page,this.showSearchResult=!0,this.searchResloading=!1):(this.searchBangumis="",this.showSearchResult=!0);case 9:case"end":return t.stop()}},t,this)})),function(t){return d.apply(this,arguments)}),goBangumiDetail:function(t){this.$router.push({name:"bangumidetail",params:{bid:t.bangumiId,bangumi:t}})},handleCurrentChange:(p=Object(r.a)(regeneratorRuntime.mark(function t(e){var a,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,K(this.snForPageSearch,e,this.page.pageSize);case 3:a=t.sent,0===(i=a.data).code&&(this.searchBangumis=i.data.content,this.page=i.data.page);case 6:case"end":return t.stop()}},t,this)})),function(t){return p.apply(this,arguments)}),handleSizeChange:(u=Object(r.a)(regeneratorRuntime.mark(function t(e){var a,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,K(this.snForPageSearch,1,e);case 3:a=t.sent,0===(i=a.data).code&&(this.searchBangumis=i.data.content,this.page=i.data.page);case 6:case"end":return t.stop()}},t,this)})),function(t){return u.apply(this,arguments)}),getNotice:(l=Object(r.a)(regeneratorRuntime.mark(function t(){var e,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,J();case 2:if(e=t.sent,0!==(a=e.data).code){t.next=14;break}if(this.notice=a.data.indexNotice,null!==a.data.indexNotice){t.next=10;break}return this.showNotice=!1,t.abrupt("return");case 10:this.curNoticeId=a.data.indexNotice.id,null!==this.lastNoticeId?this.lastNoticeId!==this.curNoticeId&&(this.showNotice=!0):this.showNotice=!0,t.next=15;break;case 14:case 15:case"end":return t.stop()}},t,this)})),function(){return l.apply(this,arguments)}),closeNotice:function(){localStorage.setItem("lastNoticeId",this.curNoticeId),this.showNotice=!1}},created:function(){var t=localStorage.getItem("lastNoticeId");t&&(this.lastNoticeId=parseInt(t)),this.initBangumis(),this.getNotice()}},tt=(a("2Vk6"),a("Yavw"),a("BP3X"),Object(X.a)(Q,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"hello"},[a("div",{staticClass:"dk-search-tr"},[t.notice&&t.showNotice?a("div",{staticClass:"notify"},[a("div",{staticClass:"content"},[a("i",{staticClass:"el-icon-bell notify-bell"}),a("a",{staticClass:"notify-link",attrs:{href:"#/announce/"+t.notice.id}},[t._v(t._s(t.notice.title))]),a("i",{staticClass:"el-icon-close notify-close",on:{click:t.closeNotice}})])]):t._e(),a("div",{staticClass:"search-container"},[a("el-input",{staticClass:"dk-search-ipt",attrs:{placeholder:"搜索"},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.searchBangumisByName(t.searchBangumiName)}},model:{value:t.searchBangumiName,callback:function(e){t.searchBangumiName=e},expression:"searchBangumiName"}}),a("el-button",{staticClass:"dk-search-btn",attrs:{type:"text",icon:"el-icon-search"},on:{click:function(e){t.searchBangumisByName(t.searchBangumiName)}}})],1)]),a("div",[a("div",{directives:[{name:"show",rawName:"v-show",value:!t.showSearchResult,expression:"!showSearchResult"}],staticClass:"top"},[a("el-carousel",{attrs:{interval:5e3,type:"card",height:"320px"}},t._l(t.bangumis,function(e){return a("el-carousel-item",{key:e.bangumiId},[a("div",[a("a",{staticClass:"c-img",style:{"background-image":"url("+e.thumb+")"},attrs:{href:"javascript:void(0);"},on:{click:function(a){t.goBangumiDetail(e)}}})]),a("div",{staticClass:"dk-shadow"},[a("span",{staticClass:"dk-b-name"},[t._v(t._s(e.bangumiName))])])])}))],1)]),t.showSearchResult?a("div",{staticClass:"dk-search-res"},[""===t.searchBangumis?a("h1",[t._v("什么都没有找到")]):a("h1",[t._v("搜索结果")]),t._l(t.searchBangumis,function(t){return a("bangumi-card",{key:t.bangumiId,attrs:{bangumi:t}})})],2):t._e(),t.searchResloading?t._e():a("div",{staticClass:"page page-container"},[a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.page.totalSize>10,expression:"page.totalSize>10"}],attrs:{"current-page":t.page.pageNumber,"page-sizes":[10,20,30,40,50],"page-size":t.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.page.totalSize},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.$set(t.page,"pageNumber",e)}}})],1)])},[],!1,null,"cc90bd00",null).exports),et=(a("tUrg"),0);function at(t){return nt(rt(st(t),8*t.length))}function it(t){for(var e,a=et?"0123456789ABCDEF":"0123456789abcdef",i="",s=0;s<t.length;s++)e=t.charCodeAt(s),i+=a.charAt(e>>>4&15)+a.charAt(15&e);return i}function st(t){for(var e=Array(t.length>>2),a=0;a<e.length;a++)e[a]=0;for(a=0;a<8*t.length;a+=8)e[a>>5]|=(255&t.charCodeAt(a/8))<<a%32;return e}function nt(t){for(var e="",a=0;a<32*t.length;a+=8)e+=String.fromCharCode(t[a>>5]>>>a%32&255);return e}function rt(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;for(var a=1732584193,i=-271733879,s=-1732584194,n=271733878,r=0;r<t.length;r+=16){var o=a,c=i,l=s,u=n;i=pt(i=pt(i=pt(i=pt(i=ut(i=ut(i=ut(i=ut(i=lt(i=lt(i=lt(i=lt(i=ct(i=ct(i=ct(i=ct(i,s=ct(s,n=ct(n,a=ct(a,i,s,n,t[r+0],7,-680876936),i,s,t[r+1],12,-389564586),a,i,t[r+2],17,606105819),n,a,t[r+3],22,-1044525330),s=ct(s,n=ct(n,a=ct(a,i,s,n,t[r+4],7,-176418897),i,s,t[r+5],12,1200080426),a,i,t[r+6],17,-1473231341),n,a,t[r+7],22,-45705983),s=ct(s,n=ct(n,a=ct(a,i,s,n,t[r+8],7,1770035416),i,s,t[r+9],12,-1958414417),a,i,t[r+10],17,-42063),n,a,t[r+11],22,-1990404162),s=ct(s,n=ct(n,a=ct(a,i,s,n,t[r+12],7,1804603682),i,s,t[r+13],12,-40341101),a,i,t[r+14],17,-1502002290),n,a,t[r+15],22,1236535329),s=lt(s,n=lt(n,a=lt(a,i,s,n,t[r+1],5,-165796510),i,s,t[r+6],9,-1069501632),a,i,t[r+11],14,643717713),n,a,t[r+0],20,-373897302),s=lt(s,n=lt(n,a=lt(a,i,s,n,t[r+5],5,-701558691),i,s,t[r+10],9,38016083),a,i,t[r+15],14,-660478335),n,a,t[r+4],20,-405537848),s=lt(s,n=lt(n,a=lt(a,i,s,n,t[r+9],5,568446438),i,s,t[r+14],9,-1019803690),a,i,t[r+3],14,-187363961),n,a,t[r+8],20,1163531501),s=lt(s,n=lt(n,a=lt(a,i,s,n,t[r+13],5,-1444681467),i,s,t[r+2],9,-51403784),a,i,t[r+7],14,1735328473),n,a,t[r+12],20,-1926607734),s=ut(s,n=ut(n,a=ut(a,i,s,n,t[r+5],4,-378558),i,s,t[r+8],11,-2022574463),a,i,t[r+11],16,1839030562),n,a,t[r+14],23,-35309556),s=ut(s,n=ut(n,a=ut(a,i,s,n,t[r+1],4,-1530992060),i,s,t[r+4],11,1272893353),a,i,t[r+7],16,-155497632),n,a,t[r+10],23,-1094730640),s=ut(s,n=ut(n,a=ut(a,i,s,n,t[r+13],4,681279174),i,s,t[r+0],11,-358537222),a,i,t[r+3],16,-722521979),n,a,t[r+6],23,76029189),s=ut(s,n=ut(n,a=ut(a,i,s,n,t[r+9],4,-640364487),i,s,t[r+12],11,-421815835),a,i,t[r+15],16,530742520),n,a,t[r+2],23,-995338651),s=pt(s,n=pt(n,a=pt(a,i,s,n,t[r+0],6,-198630844),i,s,t[r+7],10,1126891415),a,i,t[r+14],15,-1416354905),n,a,t[r+5],21,-57434055),s=pt(s,n=pt(n,a=pt(a,i,s,n,t[r+12],6,1700485571),i,s,t[r+3],10,-1894986606),a,i,t[r+10],15,-1051523),n,a,t[r+1],21,-2054922799),s=pt(s,n=pt(n,a=pt(a,i,s,n,t[r+8],6,1873313359),i,s,t[r+15],10,-30611744),a,i,t[r+6],15,-1560198380),n,a,t[r+13],21,1309151649),s=pt(s,n=pt(n,a=pt(a,i,s,n,t[r+4],6,-145523070),i,s,t[r+11],10,-1120210379),a,i,t[r+2],15,718787259),n,a,t[r+9],21,-343485551),a=dt(a,o),i=dt(i,c),s=dt(s,l),n=dt(n,u)}return Array(a,i,s,n)}function ot(t,e,a,i,s,n){return dt((r=dt(dt(e,t),dt(i,n)))<<(o=s)|r>>>32-o,a);var r,o}function ct(t,e,a,i,s,n,r){return ot(e&a|~e&i,t,e,s,n,r)}function lt(t,e,a,i,s,n,r){return ot(e&i|a&~i,t,e,s,n,r)}function ut(t,e,a,i,s,n,r){return ot(e^a^i,t,e,s,n,r)}function pt(t,e,a,i,s,n,r){return ot(a^(e|~i),t,e,s,n,r)}function dt(t,e){var a=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(a>>16)<<16|65535&a}var mt,ht=function(t,e){var a=this,i="",s=new FileReader,n=new FileReader;this.setBinAndHash=function(t,e){switch(t){case 0:this._binStart=e;break;case 1:this._binEnd=e}this._binStart&&this._binEnd&&this.md5sum(this._binStart,this._binEnd)},this.md5sum=function(t,e){this._hash=it(at(t+e)),i(this._hash)},this.getHash=function(){return this._hash},this.calculateHashOfFile=function(t){s.onload=function(t){a.setBinAndHash(0,t.target.result)},n.onload=function(t){a.setBinAndHash(1,t.target.result)};var e=t.slice(0,65536),i=t.slice(t.size-65536,t.size);s.readAsBinaryString(e),n.readAsBinaryString(i)},this.calculateHashOfFile(t),i=e},gt=a("ce6G"),ft=a.n(gt),vt=(a("pIFo"),{props:["root","r_uid","reply_id","index"],data:function(){return{displayOper:{display:"none"},uid:"",visible1:!1,visible2:!1,role:""}},methods:{deleteReply:(mt=Object(r.a)(regeneratorRuntime.mark(function t(e){var a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,C(e);case 2:0===(a=t.sent).data.code?(this.$message({showClose:!0,message:a.data.msg,type:"success"}),this.root?this.$emit("delRootReply",this.index):this.$emit("delSubReply",this.index)):this.$message({showClose:!0,message:a.data.msg,type:"error"}),this.visible2=!1;case 5:case"end":return t.stop()}},t,this)})),function(t){return mt.apply(this,arguments)})},created:function(){var t=localStorage.getItem("USER_ID"),e=localStorage.getItem("ROLE");t&&(this.uid=parseInt(t)),e&&(this.role=e)}}),bt=(a("fKhJ"),Object(X.a)(vt,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"operation"},[a("el-popover",{attrs:{"popper-class":"del-pop",placement:"bottom",trigger:"click"},model:{value:t.visible1,callback:function(e){t.visible1=e},expression:"visible1"}},["ROLE_ADMIN"===t.role||"ROLE_MANAGER"===t.role||t.r_uid===t.uid?a("div",{staticClass:"del-self"},[a("el-popover",{attrs:{placement:"top",width:"160"},model:{value:t.visible2,callback:function(e){t.visible2=e},expression:"visible2"}},[a("p",[t._v("这是一段内容这是一段内容确定删除吗？")]),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t.visible2=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.deleteReply(t.reply_id)}}},[t._v("确定")])],1),a("el-button",{staticClass:"oper-item",attrs:{slot:"reference",size:"small",type:"text"},on:{click:function(e){t.visible1=!1}},slot:"reference"},[t._v("删除")])],1)],1):a("div",[a("div",{staticClass:"oper-item"},[t._v("举报")])]),a("el-button",{staticStyle:{float:"right",padding:"2px 0",color:"#999",transform:"rotate(90deg)","font-size":"18px"},attrs:{slot:"reference",icon:"el-icon-more",type:"text"},slot:"reference"})],1)],1)},[],!1,null,"44cfccbe",null).exports);function yt(t,e){/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));var a={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds()};for(var i in a)if(new RegExp("(".concat(i,")")).test(e)){var s=a[i]+"";e=e.replace(RegExp.$1,1===RegExp.$1.length?s:xt(s))}return e}function xt(t){return("00"+t).substr(t.length)}a("Oyvg");var _t,wt,Ct,kt,It,St,Rt,jt,Bt,Et,Nt,Tt,Ot,Dt,Ut,Lt,$t,Mt,Pt,zt,At,Vt,Ft,Gt,Wt,Zt,Kt,Jt,qt,Ht,Xt,Yt,Qt,te,ee,ae,ie,se,ne,re,oe,ce,le,ue={props:["m_reply","reply","index"],data:function(){return{replyInfo:{nick:"",p_uid:"",p_rid:"",is_parent:0,prefix:""},is_root:!1}},components:{operation:bt},methods:{getDateDiff:function(t){var e=(new Date).getTime()-t;if(!(e<0)){var a=e/36e5,i=e/6e4;return e/864e5>=1?yt(new Date(t),"yyyy-MM-dd hh:mm"):a>=1?parseInt(a)+"小时前":i>=1?parseInt(i)+"分钟前":"刚刚"}},showReplyBox:function(){this.tap("setInfo from SubRply!"),this.replyInfo.nick=this.m_reply.user.nick,this.replyInfo.p_uid=this.m_reply.user.uid,this.replyInfo.p_rid=this.m_reply.reply.parentId,this.replyInfo.prefix="回复 @"+this.m_reply.user.nick+" :",this.tap("reply nick: "+this.replyInfo.nick),this.tap("reply p_uid: "+this.replyInfo.p_uid),this.tap("reply p_rid: "+this.replyInfo.p_rid),this.tap("reply prefix: "+this.replyInfo.prefix),this.$emit("toggleRB",this.replyInfo)},postAttitide:(_t=Object(r.a)(regeneratorRuntime.mark(function t(e){var a,i,s,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(localStorage.getItem("USER_ID")){t.next=4;break}return this.tap("useridddddddddd:"+localStorage.getItem("USER_ID")),this.$message({message:"请先登陆",type:"warning"}),t.abrupt("return");case 4:if(0!==this.m_reply.likeStatus){t.next=14;break}return this.tap("post attitude,rid:"+e+" action: 1"),t.next=9,k(e,1);case 9:a=t.sent,0===(i=a.data).code?(this.tap(i.data),this.m_reply.likeStatus=1,this.m_reply.reply.rLike+=1):this.$message({message:"点赞失败",type:"error"}),t.next=20;break;case 14:return this.tap("post attitude,rid:"+e+" action: 0"),t.next=17,k(e,0);case 17:s=t.sent,0===(n=s.data).code?(this.tap(n.data),this.m_reply.likeStatus=0,this.m_reply.reply.rLike-=1):this.$message({message:"取消点赞失败",type:"error"});case 20:case"end":return t.stop()}},t,this)})),function(t){return _t.apply(this,arguments)}),delSubReply:function(t){this.reply.replies.splice(t,1)}}},pe=(a("AOPO"),Object(X.a)(ue,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"reply-item reply-wrap",attrs:{id:"r-"+t.m_reply.reply.replyId}},[a("a",{staticClass:"reply-face",attrs:{href:"#/user/"+t.m_reply.user.uid,target:"_blank"}},[a("img",{attrs:{src:t.m_reply.user.face?t.m_reply.user.face:"/static/akari.jpg",alt:""}})]),a("div",{staticClass:"reply-con"},[a("div",{staticClass:"user"},[a("a",{staticClass:"name vip-red-name",attrs:{href:"#/user/"+t.m_reply.user.uid,target:"_blank"}},[t._v(t._s(t.m_reply.user.nick))]),a("span",{staticClass:"text-con"},[t._v(t._s(t.m_reply.reply.content))])]),a("div",{staticClass:"info"},[a("span",{staticClass:"time"},[t._v(t._s(t.getDateDiff(t.m_reply.reply.modifyTime)))]),a("span",{staticClass:"like ",class:{liked:t.m_reply.likeStatus},on:{click:function(e){t.postAttitide(t.m_reply.reply.replyId)}}},[a("i"),a("span",[t._v(t._s(t.m_reply.reply.rLike))])]),a("span",{staticClass:"reply btn-hover",on:{click:t.showReplyBox}},[t._v("回复")]),a("operation",{attrs:{root:t.is_root,r_uid:t.m_reply.user.uid,reply_id:t.m_reply.reply.replyId,index:t.index},on:{delSubReply:t.delSubReply}})],1)])])},[],!1,null,null,null).exports),de={props:["sub_replies","root_reply","view_more","sub_page"],data:function(){return{}},methods:{loadSubReplies:(Ct=Object(r.a)(regeneratorRuntime.mark(function t(e,a){var i,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.tap("load subReplies, prid:"+e+" pn:"+a),t.next=3,I(e,a);case 3:return i=t.sent,s=i.data,t.abrupt("return",s);case 7:case"end":return t.stop()}},t,this)})),function(t,e){return Ct.apply(this,arguments)}),targetPageSub:(wt=Object(r.a)(regeneratorRuntime.mark(function t(e){var a,i,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.tap("targer page sub invoked!"),this.root_reply.reply.cur_page=e,a=this.root_reply.reply.reply.replyId,t.next=5,this.loadSubReplies(a,e);case 5:i=t.sent,s=i.data.replies,this.$emit("changeSubRepliesPage",s);case 8:case"end":return t.stop()}},t,this)})),function(t){return wt.apply(this,arguments)})}},me=(a("JUUE"),Object(X.a)(de,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"paging-box"},[a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.view_more,expression:"view_more"}],attrs:{small:"","current-page":t.root_reply.reply.cur_page,"page-size":10,"pager-count":11,layout:"prev, pager, next",total:t.root_reply.reply.totalSize},on:{"current-change":t.targetPageSub,"update:currentPage":function(e){t.$set(t.root_reply.reply,"cur_page",e)}}})],1)},[],!1,null,"08881971",null).exports),he=(new i.default,{data:function(){return{}},methods:{addEmojiToCtx:function(t){var e=t.target.getAttribute("data-emoji-text");this.$emit("selectedEmoji",e)}}}),ge=(a("9hM8"),Object(X.a)(he,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"emoji-box"},[t._m(0),a("div",{staticClass:"emoji-wrap"},[a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"(⌒▽⌒)"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("(⌒▽⌒)")]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"（￣▽￣）"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("（￣▽￣）")]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"(=・ω・=)"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("(=・ω・=)")]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"(｀・ω・´)"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("(｀・ω・´)")]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"(〜￣△￣)〜"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("(〜￣△￣)〜")]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"(･∀･)"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("(･∀･)")]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"(°∀°)ﾉ"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("(°∀°)ﾉ")]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"(￣3￣)"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("(￣3￣)")]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"╮(￣▽￣)╭"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("╮(￣▽￣)╭")]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"( ´_ゝ｀)"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("( ´_ゝ｀)")]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"←_←"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("←_←")]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"→_→"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("→_→")]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"(<_<)"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("(<_<)")]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"(>_>)"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("(>_>)")]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"(;¬_¬)"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("(;¬_¬)")]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":'("▔□▔)/'},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v('("▔□▔)/')]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"(ﾟДﾟ≡ﾟдﾟ)!?"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("(ﾟДﾟ≡ﾟдﾟ)!?")]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"Σ(ﾟдﾟ;)"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("Σ(ﾟдﾟ;)")]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"Σ( ￣□￣||)"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("Σ( ￣□￣||)")]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"(´；ω；`)"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("(´；ω；`)")]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"（/TДT)/"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("（/TДT)/")]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"(^・ω・^ )"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("(^・ω・^ )")]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"(｡･ω･｡)"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("(｡･ω･｡)")]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"(●￣(ｴ)￣●)"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("(●￣(ｴ)￣●)")]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"ε=ε=(ノ≧∇≦)ノ"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("ε=ε=(ノ≧∇≦)ノ")]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"(´･_･`)"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("(´･_･`)")]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"(-_-#)"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("(-_-#)")]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"（￣へ￣）"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("（￣へ￣）")]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"(￣ε(#￣) Σ"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("(￣ε(#￣) Σ")]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"ヽ(`Д´)ﾉ"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("ヽ(`Д´)ﾉ")]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"(╯°口°)╯(┴—┴"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("(╯°口°)╯(┴—┴")]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"（#-_-)┯━┯"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("（#-_-)┯━┯")]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"_(:3」∠)_"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("_(:3」∠)_")]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"(笑)"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("(笑)")]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"(汗)"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("(汗)")]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"(泣)"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("(泣)")]),a("a",{staticClass:"emoji-list emoji-text",attrs:{"data-emoji-text":"(苦笑)"},on:{click:function(e){t.addEmojiToCtx(e)}}},[t._v("(苦笑)")])])])},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"emoji-title"},[e("span",[this._v("颜文字")])])}],!1,null,"58dee546",null).exports),fe={props:["replies","m_replies","episode_id","reply_info","show_reply_box","is_top"],data:function(){return{content:"",r_page:1,is_parent:1,p_uid:"",p_rid:"",pos_x:0,pos_y:0,activeFocus:!1,show_emoji_box:!1,post_succ:!1,curUserFace:""}},components:{"emoji-box":ge},methods:{getCurUserFace:function(){return localStorage.getItem("face")},selectedEmoji:function(t){this.show_emoji_box=!1,this.content=this.content+t},addFocusClass:function(){this.tap("add focus"),this.activeFocus=!0},removeFocusClass:function(){this.tap("remove focus"),this.activeFocus=!1},postComment:(kt=Object(r.a)(regeneratorRuntime.mark(function t(){var e,a,i,s,n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e={uid:localStorage.getItem("USER_ID"),ep_id:this.episode_id,content:this.content,r_page:1,is_parent:1,p_uid:"",p_rid:""},localStorage.getItem("USER_ID")){t.next=5;break}return this.tap("useridddddddddd:"+localStorage.getItem("USER_ID")),this.$message({message:"发送评论请先登陆",type:"warning"}),t.abrupt("return");case 5:return this.reply_info&&(e.p_uid=this.reply_info.p_uid,e.p_rid=this.reply_info.p_rid,e.is_parent=this.reply_info.is_parent,e.content=this.reply_info.prefix+e.content),this.tap("get_uid:"+e.uid),this.tap("get_ep_id:"+e.ep_id),this.tap("get_p_uid:"+e.p_uid),this.tap("get_p_rid:"+e.p_rid),this.tap("get_is_parent:"+e.is_parent),this.tap("get reply content: "+e.content),t.next=15,w(e);case 15:a=t.sent,i=a.data,this.tap(a),this.tap(a.status),this.tap(i),0===i.code?(this.content="",this.tap("post success"),this.post_succ=!0,this.reply_info&&(this.tap("has_reply_info and post success"),this.$emit("postReplySuccess")),s=i.data,1===e.is_parent?(this.tap("update RootComment!"),this.$emit("updateRootComment",s)):(this.tap("update SubComment!"),this.$emit("updateSubComment",s)),setTimeout(function(){n.post_succ=!1},2e3)):this.tap("发送评论失败");case 21:case"end":return t.stop()}},t,this)})),function(){return kt.apply(this,arguments)})},computed:{getReplyUser:function(){return this.reply_info?"回复@"+this.reply_info.nick:"请自觉遵守互联网相关的政策法规，严禁发布色情、暴力、反动的言论。"}},mounted:function(){this.curUserFace=this.getCurUserFace()}},ve=(a("xFsN"),Object(X.a)(fe,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"comment-send"},[a("div",{staticClass:"user-face"},[a("img",{staticClass:"user-head",attrs:{src:t.curUserFace?t.curUserFace:"/static/akari.jpg"}})]),a("div",{staticClass:"textarea-container",class:{focus:t.activeFocus}},[a("i",{staticClass:"ipt-arrow"}),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"content"}],staticClass:"ipt-txt",attrs:{cols:"80",name:"msg",rows:"5",placeholder:t.getReplyUser},domProps:{value:t.content},on:{focus:t.addFocusClass,blur:t.removeFocusClass,input:function(e){e.target.composing||(t.content=e.target.value)}}}),a("el-tooltip",{attrs:{"visible-arrow":!1,manual:!0,"hide-after":2,content:"发送成功",placement:"top"},model:{value:t.post_succ,callback:function(e){t.post_succ=e},expression:"post_succ"}},[a("button",{staticClass:"comment-submit",on:{click:t.postComment}},[t._v("发表评论")])])],1),a("el-popover",{attrs:{width:"400",placement:"bottom-start",trigger:"click"},model:{value:t.show_emoji_box,callback:function(e){t.show_emoji_box=e},expression:"show_emoji_box"}},[a("div",[a("emoji-box",{on:{selectedEmoji:t.selectedEmoji}})],1),a("div",{ref:"mybox",staticClass:"comment-emoji",attrs:{slot:"reference",tabindex:"1"},slot:"reference"},[a("i",{staticClass:"face"}),a("span",{staticClass:"text"},[t._v("表情")])])])],1)},[],!1,null,"30a4c6e0",null).exports),be={props:["reply","replies","episode_id","page","index","reply_total"],data:function(){return{reply_root:!1,show_reply_box:!1,replyInfo:{nick:"",p_uid:"",p_rid:"",is_parent:1,prefix:""},view_more:!1,is_root:!0}},components:{"sub-reply":pe,"padding-box":me,operation:bt,"post-reply":ve},methods:{getDateDiff:function(t){var e=(new Date).getTime()-t;if(!(e<0)){var a=e/36e5,i=e/6e4;return e/864e5>=1?yt(new Date(t),"yyyy-MM-dd hh:mm"):a>=1?parseInt(a)+"小时前":i>=1?parseInt(i)+"分钟前":"刚刚"}},showReplyBox:function(){this.replyInfo.nick=this.reply.reply.user.nick,this.replyInfo.p_uid=this.reply.reply.user.uid,this.replyInfo.p_rid=this.reply.reply.reply.replyId,this.tap("reply root!"),this.tap("nick:"+this.replyInfo.nick),this.tap("p_uid:"+this.replyInfo.p_uid),this.tap("p_rid:"+this.replyInfo.p_rid),this.tap("prefix:"+this.replyInfo.prefix),this.replyInfo.is_parent=0,this.replyInfo.prefix="",this.reply_root?this.show_reply_box=!this.show_reply_box:this.show_reply_box=!0,this.reply_root=!0},toggleRB:function(t){this.tap("toggle reply box!"),this.replyInfo=t,this.tap("set info!"),this.show_reply_box=!0,this.reply_root=!1},postReplySuccess:function(){this.show_reply_box=!1,this.view_more=!0,this.tap("post reply success")},updateSubComment:function(t){this.tap("updateSubComment invoked!"),this.reply.replies.push(t)},postAttitide:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(e){var a,i,s,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(localStorage.getItem("USER_ID")){t.next=4;break}return this.tap("useridddddddddd:"+localStorage.getItem("USER_ID")),this.$message({message:"请先登陆",type:"warning"}),t.abrupt("return");case 4:if(0!==this.reply.reply.likeStatus){t.next=13;break}return this.tap("post attitude,rid:"+e+" action: 1"),t.next=8,k(e,1);case 8:a=t.sent,0===(i=a.data).code?(this.tap(i.data),this.reply.reply.likeStatus=1,this.reply.reply.reply.rLike+=1):this.$message({message:"点赞失败",type:"error"}),t.next=19;break;case 13:return this.tap("post attitude,rid:"+e+" action: 0"),t.next=16,k(e,0);case 16:s=t.sent,0===(n=s.data).code?(this.tap(n.data),this.reply.reply.likeStatus=0,this.reply.reply.reply.rLike-=1):this.$message({message:"取消点赞失败",type:"error"});case 19:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),viewMore:function(){this.view_more=!0,this.tap("view_more: "+this.view_more)},changeSubRepliesPage:function(t){this.tap("changeSubRepliesPage"),this.tap("sub_replies:"+t),this.reply.replies=t},delRootReply:function(t){this.replies.splice(t,1)},delSubReply:function(t){}},computed:{replyContent:function(){var t=this.reply.reply.reply.content;return(t=(t=t.replace(/\r\n/g,"<br>")).replace(/\n/g,"<br>")).replace(/\s/g,"&nbsp;")}},created:function(){1===this.reply.reply.is_target&&(this.view_more=!0)}},ye=(a("lmhV"),{props:["replies","episode_id","page","hot"],data:function(){return{refreshLoading:!1}},components:{"root-reply":Object(X.a)(be,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"list-item reply-wrap",attrs:{id:"r-"+t.reply.reply.reply.replyId}},[a("div",{staticClass:"user-face"},[a("a",{attrs:{href:"#/user/"+t.reply.reply.user.uid,target:"_blank"}},[a("img",{attrs:{src:t.reply.reply.user.face?t.reply.reply.user.face:"/static/akari.jpg",alt:""}})]),a("div",{staticClass:"hot-follow"})]),a("div",{staticClass:"con"},[a("div",{staticClass:"user"},[a("a",{staticClass:"name vip-red-name",attrs:{href:"#/user/"+t.reply.reply.user.uid,target:"_blank"}},[t._v(t._s(t.reply.reply.user.nick))])]),a("p",{staticClass:"text",domProps:{innerHTML:t._s(t.replyContent)}}),a("div",{staticClass:"info"},[a("span",{staticClass:"floor"},[t._v("#"+t._s(t.reply.reply.reply.floor))]),a("span",{staticClass:"time"},[t._v(t._s(t.getDateDiff(t.reply.reply.reply.createTime)))]),a("span",{staticClass:"like ",class:{liked:t.reply.reply.likeStatus},on:{click:function(e){t.postAttitide(t.reply.reply.reply.replyId)}}},[a("i"),a("span",[t._v(t._s(t.reply.reply.reply.rLike))])]),a("span",{staticClass:"reply btn-hover",on:{click:t.showReplyBox}},[t._v("回复")]),a("operation",{attrs:{root:t.is_root,index:t.index,r_uid:t.reply.reply.user.uid,reply_id:t.reply.reply.reply.replyId},on:{delRootReply:t.delRootReply}})],1),a("div",{staticClass:"reply-box"},[t._l(t.view_more?t.reply.replies.slice(0,10):t.reply.replies.slice(0,3),function(e,i){return a("sub-reply",{key:e.reply.replyId,attrs:{show_reply_box:t.show_reply_box,index:i,reply:t.reply,m_reply:e},on:{toggleRB:t.toggleRB}})}),t.reply.reply.totalSize>3&&!t.view_more?a("div",{staticClass:"view-more",on:{click:t.viewMore}},[t._v("共"),a("b",[t._v(t._s(t.reply.reply.totalSize))]),t._v("条回复,\n        "),a("a",{staticClass:"btn-more",attrs:{"data-pid":"809139213"}},[t._v("点击查看")])]):t._e()],2),a("padding-box",{directives:[{name:"show",rawName:"v-show",value:t.reply.reply.totalSize>10,expression:"reply.reply.totalSize>10"}],attrs:{sub_replies:t.reply.replies,view_more:t.view_more,root_reply:t.reply},on:{changeSubRepliesPage:t.changeSubRepliesPage}}),t.show_reply_box?a("post-reply",{attrs:{show_reply_box:t.show_reply_box,episode_id:t.episode_id,reply_info:t.replyInfo},on:{updateSubComment:t.updateSubComment,postReplySuccess:t.postReplySuccess}}):t._e()],1)])},[],!1,null,null,null).exports,"post-reply":ve,"emoji-box":ge},methods:{refreshComment:(Rt=Object(r.a)(regeneratorRuntime.mark(function t(){var e,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.refreshLoading=!0,t.next=4,_(this.episode_id,this.page.pageNumber);case 4:e=t.sent,0===(a=e.data).code&&this.$emit("refreshComm",a),this.refreshLoading=!1;case 8:case"end":return t.stop()}},t,this)})),function(){return Rt.apply(this,arguments)}),updateRootComment:function(t){this.tap("updateRootComment invoked!"),this.replies.unshift(t),this.tap("replies.length:"+this.replies.length)},loadData:(St=Object(r.a)(regeneratorRuntime.mark(function t(e,a){var i,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_(e,a);case 2:return i=t.sent,s=i.data,this.tap("epdi: "+e+" pageNum: "+a+" resData:"+s),t.abrupt("return",s);case 6:case"end":return t.stop()}},t,this)})),function(t,e){return St.apply(this,arguments)}),targetPage:(It=Object(r.a)(regeneratorRuntime.mark(function t(e){var a,i,s,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_(this.episode_id,e);case 2:a=t.sent,0===(i=a.data).code&&(s=i.data.page,n=i.data.replies,this.$emit("updateRepliesAndPage",n,s),this.tap("targetPage invoked!"));case 5:case"end":return t.stop()}},t,this)})),function(t){return It.apply(this,arguments)}),deleteReply:function(t){this.replies.splice(t,1)},readMoreHot:function(){this.$message.info("先不写了,好累")}},mounted:function(){}}),xe=(a("sWhz"),Object(X.a)(ye,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"comment-wrapper common"},[a("div",{staticClass:"comment-title b-head",staticStyle:{color:"#f9efc1"}},[a("span",{staticClass:"results"},[t._v(t._s(t.page.totalSize))]),t._v("评论\n  ")]),a("div",{staticClass:"comm",staticStyle:{position:"relative"}},[a("div",{staticClass:"bb-comment "},[a("div",{staticClass:"reply-notice"}),a("div",{staticClass:"comment-header clearfix"},[a("div",{staticClass:"tabs-order"},[a("ul",{staticClass:"clearfix"},[a("li",{staticClass:"on",attrs:{"data-sort":"0"}},[t._v("全部评论")]),a("li",{staticClass:"hot-sort",staticStyle:{display:"list-item"},on:{click:t.refreshComment}},[a("i",{directives:[{name:"show",rawName:"v-show",value:!t.refreshLoading,expression:"!refreshLoading"}],staticClass:"el-icon-refresh"}),a("i",{directives:[{name:"show",rawName:"v-show",value:t.refreshLoading,expression:"refreshLoading"}],staticClass:"el-icon-loading"}),t._v("\n              刷新评论")])])]),a("div",{staticClass:"header-page paging-box"})]),a("post-reply",{attrs:{is_top:!0,episode_id:t.episode_id},on:{updateRootComment:t.updateRootComment}}),a("div",{directives:[{name:"show",rawName:"v-show",value:t.replies.length>0,expression:"replies.length>0"}],staticClass:"comment-list"},[1===t.page.pageNumber?a("div",[t._l(t.hot,function(e,i){return a("root-reply",{key:e.reply.reply.replyId+e.reply.reply.rLike,attrs:{reply_total:t.replies.length,index:i,replies:t.hot,reply:e,episode_id:t.episode_id}})}),t.hot.length>0?a("div",{staticClass:"hot-line"},[a("span",{on:{click:t.readMoreHot}},[t._v("以上为热门评论，"),a("a",{staticClass:"more-hot"},[t._v("查看更多")])])]):t._e()],2):t._e(),t._l(t.replies,function(e,i){return a("root-reply",{key:e.reply.reply.replyId,attrs:{reply_total:t.replies.length,index:i,replies:t.replies,reply:e,episode_id:t.episode_id}})})],2),a("div",{staticClass:"bottom-page paging-box-big"},[t.page.parentTotalSize>20?a("el-pagination",{attrs:{"current-page":t.page.pageNumber,"pager-count":11,"page-size":t.page.pageSize,layout:"total, prev, pager, next, jumper",total:t.page.parentTotalSize},on:{"current-change":t.targetPage,"update:currentPage":function(e){t.$set(t.page,"pageNumber",e)}}}):t._e()],1)],1)])])},[],!1,null,null,null).exports),_e=a("aaBP"),we=a.n(_e),Ce=(a("Tal1"),a("201c"),a("C03Y")),ke={data:function(){return{episodeId:"",episodeIndex:"",watchEpisodeIndex:"",episodeTotal:0,searchOption:[],searchBangumisId:[],bangumiName:"",replyable:!0,videoId:"",viewCount:"",danmakuCount:"",msgReplyId:"",msgEpId:"",list:[],replies:[],hot:[],page:"",loading:!1,states:[],hasInfo:!0,searchInput:"",activeNames:["1"],videoInput:"",videoURL:"",videoMd5:"",videoSize:"",isMatch:!1,hasSearch:!1,dialogConfirmBangumiVisible:!1,videoList:[],expectVideo:"",hasEpisode:!1,postBangumiDialogVisible:!1,postBangumi:{bangumiName:"",episodeIndex:"",hasZeroIndex:0,thumb:""},langExtObj:{preview:"封面预览"},show:!1,playerOpts:{autoplay:!0,theme:"#FADFA3",lang:"zh-cn",screenshot:!0,hotkey:!0,preload:"auto",volume:.7,mutex:!0,opacity:1,video:{url:this.videoURL,pic:"",type:"auto"},danmaku:{id:"null",api:"/dplayer/",token:"",maximum:1e3,user:"Father",bottom:"15%",unlimited:!0}}}},components:{"d-player":ft.a,"post-reply":ve,comment:xe,myUpload:Ce.a},watch:{searchBangumisId:function(t){var e=this.states.filter(function(e){return e.bangumiId===t});0===e.length?this.episodeTotal=0:this.episodeTotal=e[0].episodeTotal},watchEpisodeIndex:(Lt=Object(r.a)(regeneratorRuntime.mark(function t(e){var a,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,b(this.searchBangumisId,e);case 2:a=t.sent,this.tap(a),i=a.data.data.danmakuId,this.switchVideo(this.videoURL,i),this.tap("in watch videoURL:"+this.videoURL),this.episodeIndex=a.data.data.episodeIndex,this.episodeId=a.data.data.episodeId,this.bangumiName=a.data.data.bangumiName,this.hasInfo=!0,this.danmakuCount=a.data.data.danmakuCount,this.viewCount=a.data.data.viewCount,this.initComments(),this.sendVideoInfo();case 15:case"end":return t.stop()}},t,this)})),function(t){return Lt.apply(this,arguments)})},methods:{getFileMd5Full:function(t){this.tap("getFileFd5Full invoked!");var e=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice,a=t,i=4194304,s=Math.ceil((a.size>16777216?16777216:a.size)/i),n=0,r=new we.a.ArrayBuffer,o=new FileReader,c=(new Date,"");function l(){var t=n*i,s=t+i>=(a.size>16777216?16777216:a.size)?a.size>16777216?16777216:a.size:t+i;o.readAsArrayBuffer(e.call(a,t,s))}return o.onload=function(t){r.append(t.target.result),++n<s?l():c=r.end()},o.onerror=function(){},l(),c},sendVideoInfo:(Ut=Object(r.a)(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e={ep_id:this.episodeId,v_md5:this.videoMd5,v_size:this.videoSize},t.next=4,U(e);case 4:t.sent.data;case 6:case"end":return t.stop()}},t,this)})),function(){return Ut.apply(this,arguments)}),play:function(){this.tap("play callback"),this.tap(this.videoURL)},getFileMd5:function(t){return new Promise(function(e,a){try{new ht(t,function(t){e(t)})}catch(t){a(t)}})},reSearchBangumi:function(){""!==this.expectVideo&&0!==this.videoList.length?this.dialogConfirmBangumiVisible=!0:(this.hasInfo=!1,this.isMatch=!1,this.activeNames=["2"])},handleChange:(Dt=Object(r.a)(regeneratorRuntime.mark(function t(e){var a,i,s,n,r,o,c,l=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.videoURL=e.url,t.next=3,this.getFileMd5(e.raw);case 3:return a=t.sent,i=e.size,this.videoMd5=a,this.videoSize=i,this.tap(a),this.tap(i),this.tap("handleFileChange, fileURL:"+this.videoURL),this.tap(e),this.tap("寻找弹幕资源"),t.next=14,v(i,a);case 14:s=t.sent.data,this.tap("结束寻找弹幕资源"),this.tap("episode data :"+s),n=s.data.videoInfos,r=s.data.ev,0===s.code||"OK"===s.msg?void 0===r?void 0===n?(this.hasInfo=!1,this.isMatch=!1):n.length>1?(this.dialogConfirmBangumiVisible=!0,this.videoList=n):1===n.length?(this.isMatch=!0,this.hasInfo=!0,o=n[0],c=o.danmakuId,this.tap("有弹幕, videoURL:"+this.videoURL),this.switchVideo(this.videoURL,c),this.bangumiName=o.bangumiName,this.episodeIndex=o.episodeIndex,this.episodeId=o.episodeId,this.viewCount=o.viewCount,this.danmakuCount=o.danmakuCount,this.tap("setEpId in:"+o.episodeId),this.initComments(),this.tap("bangumiName:"+this.bangumiName),this.tap("episodeIndex:"+this.episodeIndex),setTimeout(function(){l.$notify({title:"识别成功",message:l.bangumiName+" "+l.episodeIndex,type:"success"})},800)):(this.tap("没有弹幕，直接播放, videoURL:"+this.videoURL),this.switchVideo(this.videoURL,""),this.playerOpts.autoplay=!1,this.hasInfo=!1,this.activeNames=["2"],this.bangumiName="",this.episodeIndex="",this.episodeId="",this.viewCount="",this.replies="",this.danmakuCount=""):(this.videoList=n,this.expectVideo=r,this.isMatch=!0,this.hasInfo=!0,this.switchVideo(this.videoURL,r.danmakuId),this.bangumiName=r.bangumiName,this.episodeIndex=r.episodeIndex,this.episodeId=r.episodeId,this.viewCount=r.viewCount,this.danmakuCount=r.danmakuCount,this.tap("setEpId in:"+r.episodeId),this.initComments(),this.tap("bangumiName:"+this.bangumiName),this.tap("episodeIndex:"+this.episodeIndex),setTimeout(function(){l.$notify({title:"识别成功",message:l.bangumiName+" "+l.episodeIndex,type:"success"})},800)):(this.switchVideo(this.videoURL,""),this.playerOpts.autoplay=!1,this.hasInfo=!1,this.activeNames=["2"],this.bangumiName="",this.episodeIndex="",this.episodeId="",this.replies=[],this.viewCount="",this.danmakuCount="");case 20:case"end":return t.stop()}},t,this)})),function(t){return Dt.apply(this,arguments)}),switchVideo:function(t,e){this.tap("switch video invoked!"),this.tap("videoURL:"+t+"   danmakuId:"+e),this.$refs.player.dp.switchVideo({url:t},{id:e,api:"/dplayer/",token:localStorage.getItem("JWT_TOKEN"),maximum:1e3,user:localStorage.getItem("loginUserName"),bottom:"15%",unlimited:!0})},remoteMethod:(Ot=Object(r.a)(regeneratorRuntime.mark(function t(e){var a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(""===e){t.next=10;break}return this.loading=!0,this.tap(e),t.next=5,y(e);case 5:a=t.sent.data,this.loading=!1,"0"===a.code||"OK"===a.msg?(this.states=a.data.content,this.list=this.states.map(function(t){return{value:t.bangumiId,label:t.bangumiName}}),this.searchOption=this.list.filter(function(t){return t.label.toLowerCase().indexOf(e.toLowerCase())>-1})):this.hasSearch=!0,t.next=11;break;case 10:this.searchOption=[];case 11:case"end":return t.stop()}},t,this)})),function(t){return Ot.apply(this,arguments)}),initComments:(Tt=Object(r.a)(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.tap("episodeId:"+this.episodeId),t.next=3,x(this.episodeId);case 3:e=t.sent.data,this.tap(e),"0"!==e.code&&"OK"!==e.msg||(this.tap("get replies:"),this.tap(e.data.replies),this.tap("get page:"),this.tap(e.data.page),this.replies=e.data.replies,this.page=e.data.page,this.hot=e.data.hot);case 6:case"end":return t.stop()}},t,this)})),function(){return Tt.apply(this,arguments)}),initEpisodeInfo:(Nt=Object(r.a)(regeneratorRuntime.mark(function t(e){var a,i,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,j(e);case 3:a=t.sent,0===(i=a.data).code&&(this.bangumiName=i.data.bangumiName,this.episodeIndex=i.data.episodeIndex,this.viewCount=i.data.viewCount,this.danmakuCount=i.data.danmakuCount,(s=this.$refs.player.dp).video.pic=i.data.thumb,s.video.poster=i.data.thumb,this.activeNames=["2"]);case 6:case"end":return t.stop()}},t,this)})),function(t){return Nt.apply(this,arguments)}),getSpecificReply:(Et=Object(r.a)(regeneratorRuntime.mark(function t(){var e,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.msgReplyId){t.next=7;break}return t.next=4,T(this.msgReplyId);case 4:e=t.sent,0===(a=e.data).code&&(this.replies=a.data.replies,this.page=a.data.page);case 7:case"end":return t.stop()}},t,this)})),function(){return Et.apply(this,arguments)}),updateRepliesAndPage:function(t,e){this.replies=t,this.page=e,this.tap("updateRepliesAndPage passed success!")},goAnchor:function(t){var e=document.getElementById(t);e?e.scrollIntoView():this.$message({message:"评论已被删除",type:"info"})},selectBangumi:function(t){this.isMatch=!0,t.episodeId;var e=t.danmakuId;this.tap("有弹幕, videoURL:"+this.videoURL),this.bangumiName=t.bangumiName,this.episodeIndex=t.episodeIndex,this.episodeId=t.episodeId,this.danmakuCount=t.danmakuCount,this.viewCount=t.viewCount,this.dialogConfirmBangumiVisible=!1,this.switchVideo(this.videoURL,e),this.initComments(),this.tap("setEpId in:"+t.episodeId),this.tap("bangumiName:"+this.bangumiName),this.tap("episodeIndex:"+this.episodeIndex),this.videoId=t.videoId,this.sendMatchSuccessVideoInfo()},sendMatchSuccessVideoInfo:(Bt=Object(r.a)(regeneratorRuntime.mark(function t(){var e,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e={v:this.videoId},t.next=3,A(e);case 3:a=t.sent,a.data;case 6:case"end":return t.stop()}},t,this)})),function(){return Bt.apply(this,arguments)}),closeDialog:function(){this.isMatch||(this.switchVideo(this.videoURL,""),this.hasInfo=!1,this.isMatch=!1,this.activeNames=["2"],this.bangumiName="",this.episodeIndex="",this.episodeId="",this.replies=[])},handleNoResult:function(){this.dialogConfirmBangumiVisible=!1,this.hasInfo=!1,this.isMatch=!1},postPostBangumiToUs:function(){localStorage.getItem("JWT_TOKEN")?this.postBangumiDialogVisible=!0:this.$message.warning("请先登陆后再提交吧~")},sendPostBangumiInfo:(jt=Object(r.a)(regeneratorRuntime.mark(function t(){var e,a,i,s,n,r,o=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.postBangumi.bangumiName,a=this.postBangumi.episodeTotal,i=this.postBangumi.hasZeroIndex,s=this.postBangumi.thumb,n={bangumiName:e,episodeTotal:a,hasZeroIndex:i,thumb:s},t.next=7,L(n);case 7:0===(r=t.sent.data).code?this.$alert(r.msg,"提交成功",{confirmButtonText:"确定",callback:function(t){o.postBangumi.bangumiName="",o.postBangumi.episodeTotal="",o.postBangumi.hasZeroIndex=0,setTimeout(function(){return o.postBangumiDialogVisible=!1},400)}}):5003===r.code?this.$alert(r.msg,"提示",{confirmButtonText:"确定",callback:function(t){o.postBangumi.bangumiName="",o.postBangumi.episodeTotal="",o.postBangumi.hasZeroIndex=0}}):this.$alert(r.msg,"参数有误",{confirmButtonText:"确定",callback:function(t){}});case 9:case"end":return t.stop()}},t,this)})),function(){return jt.apply(this,arguments)}),cropUploadSuccess:function(t,e){var a=this,i=t.data.link;i=i.substring(i.lastIndexOf("/")),this.postBangumi.thumb=this.GLOBAL.imgURL+i,setTimeout(function(){return a.show=!1},100)},cropSuccess:function(t,e){},cropUploadFail:function(t,e){},refreshComm:function(t){this.replies=t.data.replies,this.page=t.data.page,this.hot=t.data.hot}},mounted:function(){var t=this;setTimeout(function(){var t=document.getElementsByClassName("watchVideo")[0];t&&t.setAttribute("class","watchVideo")},1e3),this.msgReplyId&&this.msgEpId&&setTimeout(function(){t.goAnchor("r-"+t.msgReplyId)},1e3)},created:function(){var t=this.$route.params.epid,e=this.$route.query.rid;t&&(this.msgEpId=t,this.episodeId=t,this.initEpisodeInfo(t)),e?(this.msgReplyId=e,this.getSpecificReply()):t&&this.initComments()}},Ie=(a("5Omr"),Object(X.a)(ke,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"watchVideo Anime"},[a("div",{staticClass:"container"},[a("el-collapse",{staticClass:"dragArea",attrs:{accordion:""},model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[a("el-collapse-item",{directives:[{name:"show",rawName:"v-show",value:!t.isMatch,expression:"!isMatch"}],attrs:{title:"请将番剧拖入此处",name:"1"}},[a("el-upload",{staticClass:"upload-demo",attrs:{drag:"",multiple:!1,"auto-upload":!1,"on-change":t.handleChange,action:"/"}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[t._v("将番剧拖到此处，或\n            "),a("em",[t._v("点击打开")])])])],1),a("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:!0,expression:"true"}],attrs:{title:"确认番剧",visible:t.dialogConfirmBangumiVisible,top:"18vh",width:"550px"},on:{"update:visible":function(e){t.dialogConfirmBangumiVisible=e},close:t.closeDialog}},[t._l(t.videoList,function(e){return a("div",{staticClass:"bangumi-video-list"},[a("el-button",{key:e.episodeId,staticClass:"select-bangumi-name",attrs:{type:"text"},on:{click:function(a){t.selectBangumi(e)}}},[t._v("\n            "+t._s(e.bangumiName+" "+e.episodeIndex)+"\n          ")])],1)}),a("div",[a("el-button",{staticStyle:{padding:"6px 20px 6px 20px","margin-top":"20px","border-radius":"1px"},attrs:{type:"info"},on:{click:t.handleNoResult}},[t._v("以上都不是\n          ")])],1)],2),a("el-dialog",{attrs:{title:"提供番剧信息",visible:t.postBangumiDialogVisible,width:"550px"},on:{"update:visible":function(e){t.postBangumiDialogVisible=e}}},[a("el-form",[a("el-form-item",{staticClass:"post-bangumi-explain"},[a("div",{staticClass:"explain-container"},[a("span",[a("strong",[t._v("* 番剧名称定义需要按照以下规则")])]),a("br"),a("span",[t._v("- 番剧名称以百度百科为准")]),a("br"),a("span",[t._v("- 第一个季度直接采取该名称,例如「darker」")]),a("br"),a("span",[t._v("- 多个季度,则以「番剧名称+空格+第几季」命名,例如「darker 第二季」")]),a("br"),a("span",[t._v("- sp,ova,剧场版规则与以上规则一致,例如「darker ova」")]),a("br"),a("span",[t._v("- 当然也不仅限于番剧,电影也是一样可以的")])])]),a("el-form-item",{attrs:{label:"番剧名称","label-width":"140"}},[a("el-input",{staticStyle:{width:"350px",display:"inherit"},attrs:{"auto-complete":"off"},model:{value:t.postBangumi.bangumiName,callback:function(e){t.$set(t.postBangumi,"bangumiName",e)},expression:"postBangumi.bangumiName"}})],1),a("el-form-item",{attrs:{label:"是否有第0集"}},[a("div",{staticStyle:{float:"left","margin-left":"20px"}},[a("el-radio-group",{attrs:{size:"small","text-color":"#141422"},model:{value:t.postBangumi.hasZeroIndex,callback:function(e){t.$set(t.postBangumi,"hasZeroIndex",e)},expression:"postBangumi.hasZeroIndex"}},[a("el-radio",{attrs:{border:"",label:0}},[t._v("没有")]),a("el-radio",{attrs:{border:"",label:1}},[t._v("有")])],1)],1)]),a("el-form-item",{staticStyle:{"margin-bottom":"0"}},[a("div",{staticClass:"explain-container"},[a("span",[t._v("* 若剧场版或电影则集数为「1」")]),a("br")])]),a("el-form-item",{attrs:{label:"总集数","label-width":"120"}},[a("el-input",{staticStyle:{width:"80px",display:"inherit"},attrs:{type:"text"},model:{value:t.postBangumi.episodeTotal,callback:function(e){t.$set(t.postBangumi,"episodeTotal",e)},expression:"postBangumi.episodeTotal"}})],1),a("el-form-item",{attrs:{label:"封面"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.postBangumi.thumb,expression:"postBangumi.thumb"}],attrs:{type:"hidden"},domProps:{value:t.postBangumi.thumb},on:{input:function(e){e.target.composing||t.$set(t.postBangumi,"thumb",e.target.value)}}}),a("el-button",{staticStyle:{float:"left",margin:"7px 0",border:"none"},attrs:{type:"primary",size:"mini"},on:{click:function(e){t.show=!0}}},[t._v("\n              上传封面\n            ")])],1),a("el-form-item",[a("img",{directives:[{name:"show",rawName:"v-show",value:t.postBangumi.thumb,expression:"postBangumi.thumb"}],staticStyle:{"border-radius":"5px"},attrs:{src:t.postBangumi.thumb,alt:"加载不出来呢",width:"100%"}})]),a("el-form-item",{staticStyle:{"margin-bottom":"0"}},[a("div",{staticClass:"explain-container"},[a("span",[a("strong",[t._v("* 若本次提交被收录后封面仍可修改 *")])]),a("br")])])],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticStyle:{"background-color":"lightgray","border-color":"darkslategray"},attrs:{size:"small"},on:{click:function(e){t.postBangumiDialogVisible=!1}}},[t._v("取 消\n          ")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.sendPostBangumiInfo}},[t._v("确 定")])],1)],1),a("my-upload",{attrs:{field:"image",width:620,height:350,noCircle:!0,url:t.GLOBAL.uploadURL,headers:t.GLOBAL.uploadHEADERS,langExt:t.langExtObj,"img-format":"jpg"},on:{"crop-success":t.cropSuccess,"crop-upload-success":t.cropUploadSuccess,"crop-upload-fail":t.cropUploadFail},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}}),a("el-collapse-item",{directives:[{name:"show",rawName:"v-show",value:!t.hasInfo,expression:"!hasInfo "}],attrs:{title:"未能正确识别番剧,请手动输入搜索",name:"2"},on:{click:function(e){t.hasInfo=!t.hasInfo}}},[a("div",{staticClass:"search"},[a("el-select",{attrs:{filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入番剧关键词","remote-method":t.remoteMethod,loading:t.loading},model:{value:t.searchBangumisId,callback:function(e){t.searchBangumisId=e},expression:"searchBangumisId"}},[t._l(t.searchOption,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),0===t.searchOption.length&&t.hasSearch?a("el-option",{attrs:{value:""}},[a("el-button",{staticStyle:{padding:"0"},attrs:{type:"text"},on:{click:t.postPostBangumiToUs}},[t._v("找不到该番剧?提交给我们吧!\n              ")])],1):t._e()],2),a("el-select",{attrs:{filterable:"",placeholder:"请选择集数"},model:{value:t.watchEpisodeIndex,callback:function(e){t.watchEpisodeIndex=e},expression:"watchEpisodeIndex"}},t._l(t.episodeTotal,function(t){return a("el-option",{key:t,attrs:{label:t,value:t}})}))],1)])],1)],1),""!==t.bangumiName?a("div",{staticClass:"container bangumi-header"},[a("div",{staticStyle:{width:"50%",margin:"0 auto"}},[a("div",{staticClass:"bangumi-name-container"},[a("h1",{staticClass:"bangumi-title"},[t._v(t._s(t.bangumiName)+"：第"+t._s(t.episodeIndex)+"集")]),a("div",{staticClass:"re-choose-v2",on:{click:t.reSearchBangumi}},[t._v("\n          匹配有误？重新选择\n        ")])]),a("div",{staticClass:"bangumi-info"},[a("i",{staticClass:"el-icon-view",attrs:{title:"访问量"}}),a("span",[t._v(t._s(t.viewCount))]),a("i",{staticClass:"el-icon-tickets",staticStyle:{"margin-left":"15px"},attrs:{title:"弹幕数"}}),a("span",[t._v(t._s(t.danmakuCount))])])])]):t._e(),a("div",{staticClass:"playerWrapper playerWrapper-showAnim"},[a("div",{attrs:{id:"dplayer"}},[a("d-player",{ref:"player",attrs:{options:t.playerOpts}})],1)]),a("div",{directives:[{name:"show",rawName:"v-show",value:""!==t.episodeId,expression:"episodeId!==''"}],staticClass:"cm-container"},[a("comment",{attrs:{replies:t.replies,episode_id:t.episodeId,page:t.page,hot:t.hot},on:{updateRepliesAndPage:t.updateRepliesAndPage,refreshComm:t.refreshComm}})],1)])},[],!1,null,null,null).exports),Se={data:function(){var t=this;return{isPwd1Valid:!1,isPwd2Valid:!1,isNickValid:!1,isEmailValid:!1,isRegSuccess:!1,registerData:{nick:"",password:"",email:"",dupwd:""},rules:{password:[{validator:function(e,a,i){""===a?i(new Error("请输入密码")):(new RegExp("[a-z0-9A-Z._]{6,20}","g").test(a)||i(new Error("密码格式不正确")),t.isPwd1Valid=!0,i())},trigger:"blur"}],dupwd:[{validator:function(e,a,i){""===a?i(new Error("请再次输入密码")):a!==t.registerData.password?i(new Error("两次输入密码不一致!")):(t.isPwd2Valid=!0,i())},trigger:"blur"}],nick:[{validator:function(e,a,i){if(!new RegExp("[a-z0-9A-Z\\u4e00-\\u9fa5_]{1,20}","g").test(a))return i(new Error("用户名格式不正确"));t.isNickValid=!0,i()},trigger:"blur"}],email:[{validator:function(e,a,i){if(!new RegExp("^[A-Za-z0-9\\u4e00-\\u9fa5]+@[a-zA-Z0-9_-]+(\\.[a-zA-Z0-9_-]+)+$","g").test(a))return i(new Error("邮箱格式不正确"));t.isEmailValid=!0,i()},trigger:"blur"}]},regNick:"",regEmail:""}},computed:{isRegInfoValid:function(){return this.isPwd1Valid&&this.isPwd2Valid&&this.isEmailValid&&this.isNickValid}},methods:{register:($t=Object(r.a)(regeneratorRuntime.mark(function t(){var e,a,i,s,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.isRegInfoValid){t.next=3;break}return this.$message.error("注册信息有误"),t.abrupt("return");case 3:return e={nick:this.registerData.nick,email:this.registerData.email,pwd:this.registerData.password},t.next=6,S(e);case 6:if(a=t.sent,this.tap("注册结果："+a),i=a.data.data,this.tap(i),0!==a.data.code){t.next=24;break}return this.tap("注册成功"),this.isRegSuccess=!0,this.regNick=i.nick,this.regEmail=i.email,t.next=17,h({principal:this.registerData.nick,password:this.registerData.password,remember_me:1});case 17:s=t.sent,this.tap("login res:"+s),n=s.data.data,this.tap(n),0===s.data.code&&(this.tap("偷偷登陆成功"),localStorage.setItem("USER_ID",n.user.uid),localStorage.setItem("JWT_TOKEN",n.token),localStorage.setItem("loginUserName",n.user.nick),localStorage.setItem("ROLE",n.user.role),setTimeout(function(){window.location.href="/"},3e3)),t.next=25;break;case 24:1001===a.data.code&&(this.tap("code === 1001"),this.$message.error(a.data.msg));case 25:case"end":return t.stop()}},t,this)})),function(){return $t.apply(this,arguments)})}},Re=(a("wLoz"),Object(X.a)(Se,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{"min-height":"37px"},attrs:{id:"mainer"}},[a("input",{attrs:{id:"rightNum",type:"hidden"}}),a("div",{attrs:{id:"mainer-inner"}},[a("div",{attrs:{id:"area-reg"}},[t._m(0),a("div",{staticClass:"block r"},[a("div",{staticClass:"area-reg"},[a("div",{staticClass:"after-reg",class:{hidden:!t.isRegSuccess}},[a("h3",{staticClass:"title"},[t._v("注册成功!")]),a("div",{staticClass:"area-info"},[a("p",[t._v("您的用户名为:"),a("span",{staticClass:"mobile"},[t._v(t._s(t.regNick))])]),a("p",[t._v("您的邮箱为:"),a("span",{staticClass:"mobile"},[t._v(t._s(t.regEmail))])]),a("p",[t._v("请妥善保管!")])]),a("a",{attrs:{href:"/"}},[t._v("稍后将会自动回到首页...")])]),a("el-form",{directives:[{name:"show",rawName:"v-show",value:!t.isRegSuccess,expression:"!isRegSuccess"}],ref:"reg",staticClass:"form",attrs:{id:"form-reg",model:t.registerData,"status-icon":"",rules:t.rules}},[a("h3",{staticClass:"title"},[t._v("  注册 Darker")]),a("div",{staticClass:"area"},[a("el-form-item",{attrs:{prop:"nick"}},[a("el-input",{staticClass:"regname name l error",attrs:{id:"ipt-username-reg",name:"name",type:"text","auto-complete":"off",placeholder:"请输入昵称",required:"required"},model:{value:t.registerData.nick,callback:function(e){t.$set(t.registerData,"nick",e)},expression:"registerData.nick"}})],1),a("span",{staticClass:"clearfix"})],1),a("div",{staticClass:"area"},[a("el-form-item",{attrs:{prop:"email"}},[a("el-input",{staticClass:"mobile l error",attrs:{id:"ipt-mobile-reg",name:"mobile",type:"text","auto-complete":"off",placeholder:"请输入邮箱",required:"required"},model:{value:t.registerData.email,callback:function(e){t.$set(t.registerData,"email",e)},expression:"registerData.email"}})],1),a("span",{staticClass:"clearfix"})],1),a("div",{staticClass:"area"},[a("el-form-item",{attrs:{prop:"password"}},[a("el-input",{staticClass:"password l error",attrs:{id:"ipt-pwd-reg",name:"password",type:"password","auto-complete":"off",placeholder:"请输入密码，6-20位",required:"required"},model:{value:t.registerData.password,callback:function(e){t.$set(t.registerData,"password",e)},expression:"registerData.password"}})],1),a("span",{staticClass:"clearfix"})],1),a("div",{staticClass:"area"},[a("el-form-item",{attrs:{prop:"dupwd"}},[a("el-input",{staticClass:"re-password l error",attrs:{id:"ipt-repwd-reg",name:"dupwd",type:"password","auto-complete":"off",placeholder:"确认密码",required:"required"},model:{value:t.registerData.dupwd,callback:function(e){t.$set(t.registerData,"dupwd",e)},expression:"registerData.dupwd"}})],1),a("span",{staticClass:"clearfix"})],1),a("div",{staticClass:"area-tool"},[a("a",{staticClass:"do login-btn primary",attrs:{disabled:t.isRegInfoValid?"disabled":""},on:{click:t.register}},[t._v("注册")]),a("div",{staticClass:"launchBtn bg hidden",attrs:{id:"launchBtn"}}),a("p"),a("span",{staticClass:"clearfix"})])])],1)]),a("span",{staticClass:"clearfix"})])])])},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"block l"},[e("div",{staticClass:"bg-login"})])}],!1,null,"375b2de2",null).exports),je={data:function(){return{show:!1,imgDataUrl:"",curImageUrl:""}},components:{"my-upload":Ce.a},methods:{toggleShow:function(){this.show=!this.show},cropSuccess:function(t,e){},cropUploadSuccess:function(t,e){var a=t.data.link,i=a=a.substring(a.lastIndexOf("/"));this.imgDataUrl=this.GLOBAL.imgURL+i,this.curImageUrl=this.GLOBAL.imgURL+i,this.updateUserAvatar()},cropUploadFail:function(t,e){},updateUserAvatar:(Mt=Object(r.a)(regeneratorRuntime.mark(function t(){var e,a,i,s=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=localStorage.getItem("USER_ID"),a={face:this.curImageUrl},t.next=5,R(e,a);case 5:i=t.sent,0===i.data.code&&(localStorage.setItem("face",this.curImageUrl),setTimeout(function(){s.$router.go(0)},800));case 9:case"end":return t.stop()}},t,this)})),function(){return Mt.apply(this,arguments)}),getUserFace:function(){return localStorage.getItem("face")}},mounted:function(){this.curImageUrl=this.getUserFace()}},Be=(a("G6UV"),a("zdsn"),Object(X.a)(je,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-container",{staticClass:"avatar-ctx-ani"},[a("el-main",[a("div",{staticClass:"cur-avatar"},[a("span",{staticStyle:{display:"block","font-size":"12px",color:"#99a2aa","padding-bottom":"15px"}},[t._v("当前头像")]),a("img",{staticStyle:{width:"100%",height:"100%","border-radius":"50%"},attrs:{src:t.curImageUrl?t.curImageUrl:"/static/akari.jpg"}})]),a("div",{staticClass:"upload-container",staticStyle:{"margin-top":"50px"}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.toggleShow}},[t._v("设置头像")]),a("my-upload",{attrs:{field:"image",width:300,height:300,noSquare:!0,url:t.GLOBAL.uploadURL,headers:t.GLOBAL.uploadHEADERS,"img-format":"jpg"},on:{"crop-success":t.cropSuccess,"crop-upload-success":t.cropUploadSuccess,"crop-upload-fail":t.cropUploadFail},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}})],1)])],1)},[],!1,null,"b6bc88aa",null).exports),Ee={data:function(){return{userInfo:{},sex:[{value:"不明"},{value:"男"},{value:"女"}]}},methods:{initUserInfo:(zt=Object(r.a)(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e=localStorage.getItem("USER_ID"))){t.next=9;break}return t.next=4,D(e);case 4:a=t.sent,0===(i=a.data).code&&(this.userInfo=i.data),t.next=10;break;case 9:case 10:case"end":return t.stop()}},t,this)})),function(){return zt.apply(this,arguments)}),updateUserInfo:(Pt=Object(r.a)(regeneratorRuntime.mark(function t(){var e,a,i,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=localStorage.getItem("USER_ID"),""===(a={sex:this.userInfo.sex,age:this.userInfo.age,sign:this.userInfo.sign}).sex||""===a.age){t.next=12;break}return t.next=7,R(e,a);case 7:i=t.sent,0===(s=i.data).code?(this.userInfo.age=s.data.age,this.userInfo.sex=s.data.sex,this.userInfo.sign=s.data.sign,this.$message.success("修改成功")):this.$message({message:s.msg,type:"error"});case 12:case"end":return t.stop()}},t,this)})),function(){return Pt.apply(this,arguments)})},created:function(){this.initUserInfo()}},Ne=(a("YKnW"),a("zJsb"),Object(X.a)(Ee,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"p-container"},[a("div",{staticClass:"p-infos"},[a("el-form",{ref:"udf",staticClass:"form",attrs:{id:"form-user-detail",size:"small","label-position":"top",model:t.userInfo,"status-icon":""}},[a("el-form-item",{attrs:{prop:"nick"}},[a("span",{staticClass:"p-label"},[t._v("昵称：")]),a("el-input",{staticStyle:{width:"200px"},attrs:{id:"nick",name:"nick",disabled:!0},model:{value:t.userInfo.nick,callback:function(e){t.$set(t.userInfo,"nick",e)},expression:"userInfo.nick"}})],1),a("el-form-item",{attrs:{prop:"sex"}},[a("span",{staticClass:"p-label"},[t._v("性别：")]),a("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择"},model:{value:t.userInfo.sex,callback:function(e){t.$set(t.userInfo,"sex",e)},expression:"userInfo.sex"}},t._l(t.sex,function(t){return a("el-option",{key:t.value,attrs:{label:t.value,value:t.value}})}))],1),a("el-form-item",{attrs:{prop:"age"}},[a("span",{staticClass:"p-label"},[t._v("年龄：")]),a("el-input",{staticStyle:{width:"200px"},attrs:{id:"age",name:"age"},model:{value:t.userInfo.age,callback:function(e){t.$set(t.userInfo,"age",e)},expression:"userInfo.age"}})],1),a("el-form-item",{attrs:{prop:"sign"}},[a("span",{staticClass:"p-label"},[t._v("我的签名：")]),a("el-input",{attrs:{rows:"3",resize:"none",type:"textarea",id:"sign",name:"sign"},model:{value:t.userInfo.sign,callback:function(e){t.$set(t.userInfo,"sign",e)},expression:"userInfo.sign"}})],1)],1),a("el-button",{attrs:{type:"primary"},on:{click:t.updateUserInfo}},[t._v("修改")])],1)])},[],!1,null,"3e171ce6",null).exports),Te={data:function(){var t=this;return{securityInfo:{},showPwdBox:!1,showEmailBox:!1,pwd:{opwd:"",npwd:"",cpwd:""},email:{email:""},pRules:{opwd:[{validator:function(t,e,a){""===e?a(new Error("请输入原密码")):a()},trigger:"blur"}],npwd:[{min:6,max:20,message:"密码长度在 6 到 20 个字符",trigger:"blur"},{validator:function(e,a,i){""===a?i(new Error("请输入密码")):(""!==t.pwd.npwd&&t.$refs["pwd-form"].validateField("cpwd"),i())},trigger:"blur"}],cpwd:[{validator:function(e,a,i){""===a?i(new Error("请再次输入密码")):a!==t.pwd.npwd?i(new Error("两次输入密码不一致!")):i()},trigger:"blur"}]},eRules:{email:[{validator:function(t,e,a){""===e?a():/^[A-Za-zd]+([-_.][A-Za-zd]+)*@([A-Za-zd]+[-.])+[A-Za-zd]{2,5}$/.test(e)?a():a(new Error("邮箱格式不正确!"))},trigger:"blur"}]},editPwdResult:"",changeEmailTip:"",changeEmailTime:0,emailOperaText:"",emailVerified:0,disabled:!1}},watch:{emailVerified:function(t){1===t?this.emailOperaText="更换邮箱":0===t&&(this.emailOperaText="验证邮箱")}},methods:{initSecurityInfo:(Ft=Object(r.a)(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e=localStorage.getItem("USER_ID"))){t.next=9;break}return t.next=4,D(e);case 4:a=t.sent,0===(i=a.data).code&&(this.securityInfo=i.data,this.emailVerified=i.data.emailVerified,1===this.emailVerified?this.emailOperaText="更换邮箱":this.emailOperaText="验证邮箱"),t.next=10;break;case 9:case 10:case"end":return t.stop()}},t,this)})),function(){return Ft.apply(this,arguments)}),updatePwd:(Vt=Object(r.a)(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e={opwd:this.pwd.opwd,cpwd:this.pwd.npwd},t.next=3,F(localStorage.getItem("USER_ID"),e);case 3:a=t.sent,0===(i=a.data).code?(this.$message.success("密码修改成功!"),this.showPwdBox=!1):this.$message.error(i.msg);case 6:case"end":return t.stop()}},t,this)})),function(){return Vt.apply(this,arguments)}),gotoPwd:function(){this.showPwdBox=!this.showPwdBox,this.showEmailBox=!1;var t=document.getElementById("edit-pwd");t&&t.scrollIntoView()},gotoEmail:function(){if(this.showPwdBox=!1,1===this.emailVerified){var t=document.getElementById("c-email");t&&(t.scrollIntoView(),this.showEmailBox=!this.showEmailBox)}else this.validateEmailAddr()},resetForm:function(t){this.$refs[t].resetFields()},timer:function(){this.changeEmailTime>0?(this.changeEmailTime--,this.emailOperaText=this.changeEmailTime+"s后可重新发送",setTimeout(this.timer,1e3)):(this.changeEmailTime=0,this.emailOperaText="验证邮箱",this.disabled=!1)},validateEmailAddr:(At=Object(r.a)(regeneratorRuntime.mark(function t(){var e,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.changeEmailTime=60,this.disabled=!0,this.timer(),t.next=6,V();case 6:e=t.sent,0===(a=e.data).code?this.$message.success("验证邮箱发送成功，请在20分钟内确认"):this.$message.error(a.msg);case 9:case"end":return t.stop()}},t,this)})),function(){return At.apply(this,arguments)}),forgetPwd:function(){this.$message.info("抱歉, 还没写")}},computed:{getEmailStatus:function(){return 1===this.securityInfo.emailVerified?this.securityInfo.email+"（已验证）":this.securityInfo.email+"（未验证）"},emailStyle:function(){return 1===this.securityInfo.emailVerified?{color:"green"}:{color:"rgb(153, 108, 25)"}},emailIconClass:function(){return 1===this.securityInfo.emailVerified?"el-icon-success":"el-icon-warning"},epwdStyle:function(){}},created:function(){this.initSecurityInfo()}},Oe=(a("AIeq"),Object(X.a)(Te,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"security-container"},[a("div",{staticClass:"security-wrapper"},[a("div",{staticClass:"s-item"},[t._m(0),t._m(1),a("p",{staticClass:"opera"},[a("a",{staticClass:"text",on:{click:t.gotoPwd}},[t._v("修改密码")])])]),a("div",{staticClass:"s-item"},[a("p",{staticClass:"title"},[t._v("绑定邮箱"),a("i",{class:t.emailIconClass,style:t.emailStyle})]),a("p",{staticClass:"tip"},[a("span",[t._v(t._s(t.getEmailStatus))])]),a("p",{staticClass:"opera"},[a("el-button",{staticClass:"text",attrs:{type:"text",disabled:t.disabled},on:{click:t.gotoEmail}},[t._v(t._s(t.emailOperaText))])],1)])]),a("div",{staticClass:"opera-wrapper"},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.showPwdBox,expression:"showPwdBox"}],staticClass:"edit-pwd-wrapper",attrs:{id:"edit-pwd"}},[t._m(2),a("el-form",{ref:"pwd-form",attrs:{model:t.pwd,rules:t.pRules,size:"small","label-position":"top"}},[a("el-form-item",{attrs:{prop:"opwd",label:"原密码"}},[a("el-input",{attrs:{type:"password"},model:{value:t.pwd.opwd,callback:function(e){t.$set(t.pwd,"opwd",e)},expression:"pwd.opwd"}})],1),a("el-form-item",{attrs:{prop:"npwd",label:"新密码"}},[a("el-input",{attrs:{type:"password"},model:{value:t.pwd.npwd,callback:function(e){t.$set(t.pwd,"npwd",e)},expression:"pwd.npwd"}})],1),a("el-form-item",{attrs:{prop:"cpwd",label:"确认新密码"}},[a("el-input",{attrs:{type:"password"},model:{value:t.pwd.cpwd,callback:function(e){t.$set(t.pwd,"cpwd",e)},expression:"pwd.cpwd"}})],1),a("el-form-item",{staticClass:"pwd-btn-group"},[a("el-button",{on:{click:t.updatePwd}},[t._v("修改")]),a("el-button",{on:{click:function(e){t.resetForm("pwd-form")}}},[t._v("重置")]),a("a",{staticStyle:{color:"#5757a5","margin-left":"5px","vertical-align":"-webkit-baseline-middle"},on:{click:t.forgetPwd}},[t._v(" 忘记密码？")])],1),a("el-form-item",[a("p",{style:t.epwdStyle},[t._v(t._s(t.editPwdResult))])])],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.showEmailBox,expression:"showEmailBox"}],staticClass:"edit-email-wrapper",attrs:{id:"c-email"}},[t._m(3),a("el-form",{ref:"email-form",attrs:{model:t.email,rules:t.eRules,size:"small",inline:!0}},[a("el-form-item",{attrs:{prop:"email"}},[a("el-input",{attrs:{disabled:!0,placeholder:"开发中..."},model:{value:t.email.email,callback:function(e){t.$set(t.email,"email",e)},expression:"email.email"}})],1),a("el-form-item",[a("el-button",{staticStyle:{"background-color":"#3f51b5",color:"#e4e4e6"}},[t._v("更换")])],1)],1)],1)])])},[function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticClass:"title"},[this._v("设置密码"),e("i",{staticClass:"el-icon-success",staticStyle:{color:"green"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticClass:"tip"},[e("span",[this._v("已设置")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"opera-header"},[e("h3",{staticClass:"op-title"},[this._v("修改密码")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"opera-header"},[e("h3",{staticClass:"op-title"},[this._v("更换邮箱")])])}],!1,null,"25782faf",null).exports),De={data:function(){return{pactiveIndex:"1"}},components:{AvatarInfo:Be,Personal:Ne,Security:Oe},methods:{}},Ue=(a("gN2b"),a("6+t+"),Object(X.a)(De,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"persondiv",staticStyle:{width:"980px",margin:"0 auto"}},[e("el-container",{staticStyle:{height:"800px","border-radius":"5px"}},[e("el-aside",{staticClass:"person-ctn-menu",staticStyle:{"margin-right":"20px","background-color":"#262633"},attrs:{width:"200px"}},[e("el-menu",{staticStyle:{"background-color":"#262633",border:"0"},attrs:{"default-active":this.pactiveIndex}},[e("router-link",{attrs:{to:{name:"avatar"}}},[e("el-menu-item",{staticClass:"nav-item",attrs:{index:"1"}},[this._v("头像信息")])],1),e("router-link",{attrs:{to:{name:"personal"}}},[e("el-menu-item",{staticClass:"nav-item",attrs:{index:"2"}},[this._v("个人资料")])],1),e("router-link",{attrs:{to:{name:"security"}}},[e("el-menu-item",{staticClass:"nav-item",attrs:{index:"3"}},[this._v("账号安全")])],1),e("router-link",{attrs:{to:{name:"postBangumi"}}},[e("el-menu-item",{staticClass:"nav-item",attrs:{index:"4"}},[this._v("番剧提交")])],1)],1)],1),e("el-container",{staticStyle:{overflow:"inherit","background-color":"#262633"}},[e("el-main",{staticStyle:{padding:"0"}},[e("router-view")],1)],1)],1)],1)},[],!1,null,"21fcb1c0",null).exports),Le=a("SHqN"),$e=a.n(Le),Me={data:function(){return{sysNotices:[],page:{pageNumber:0},busy:!1}},directives:{infiniteScroll:$e.a},methods:{getDateDiff:function(t){var e=(new Date).getTime()-t;if(!(e<0)){var a=e/36e5,i=e/6e4;return e/864e5>=1?yt(new Date(t),"yyyy-MM-dd hh:mm"):a>=1?parseInt(a)+"小时前":i>=1?parseInt(i)+"分钟前":"刚刚"}},initSysNotices:(Gt=Object(r.a)(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=localStorage.getItem("USER_ID"),t.next=5,B(e,"system");case 5:a=t.sent,0===(i=a.data).code&&(this.sysNotices=i.data.messages,this.page=i.data.pageInfo);case 9:case"end":return t.stop()}},t,this)})),function(){return Gt.apply(this,arguments)}),loadMore:function(){var t=this;this.busy=!0;var e=localStorage.getItem("USER_ID");e&&setTimeout(Object(r.a)(regeneratorRuntime.mark(function a(){var i,s;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,E(e,"system",t.page.pageNumber+1);case 2:i=a.sent,0===(s=i.data).code&&s.data.messages.length>0&&(t.sysNotices=t.sysNotices.concat(s.data.messages),t.page=s.data.pageInfo);case 5:case"end":return a.stop()}},a,this)})),100),this.busy=!1}},created:function(){}},Pe=(a("Kd1n"),Object(X.a)(Me,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"sys-container"},[a("el-scrollbar",{staticStyle:{height:"100%"}},[a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMore,expression:"loadMore"}],staticClass:"card-container",attrs:{"infinite-scroll-disabled":"busy","infinite-scroll-distance":"20"}},[t._l(t.sysNotices,function(e){return a("el-card",{key:e.id,staticClass:"box-card"},[a("div",{staticClass:"card-item"},[a("div",{staticClass:"item-content"},[a("div",{staticClass:"sys-content"},[a("div",{staticClass:"ctx-head"},[a("span",{staticClass:"title-text"},[t._v(t._s(e.title))]),a("span",{staticClass:"time-text"},[t._v(t._s(t.getDateDiff(e.modify_time)))])]),a("div",{staticClass:"ctx-body"},[a("span",[t._v(t._s(e.content))])])])])])])}),a("div",{directives:[{name:"show",rawName:"v-show",value:0===t.sysNotices.length,expression:"sysNotices.length===0"}]},[a("h1",[t._v("暂无系统通知")])])],2)])],1)},[],!1,null,"c0c0cdf0",null).exports),ze={data:function(){return{replyNotices:[],page:{pageNumber:0},busy:!1}},directives:{infiniteScroll:$e.a},methods:{getDateDiff:function(t){var e=(new Date).getTime()-t;if(!(e<0)){var a=e/36e5,i=e/6e4;return e/864e5>=1?yt(new Date(t),"yyyy-MM-dd hh:mm"):a>=1?parseInt(a)+"小时前":i>=1?parseInt(i)+"分钟前":"刚刚"}},initReplyNotices:(Wt=Object(r.a)(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=localStorage.getItem("USER_ID"),t.next=5,B(e,"reply");case 5:a=t.sent,0===(i=a.data).code&&(this.replyNotices=i.data.messages,this.page=i.data.pageInfo);case 9:case"end":return t.stop()}},t,this)})),function(){return Wt.apply(this,arguments)}),loadMore:function(){var t=this;this.busy=!0;var e=localStorage.getItem("USER_ID");e&&setTimeout(Object(r.a)(regeneratorRuntime.mark(function a(){var i,s;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,E(e,"reply",t.page.pageNumber+1);case 2:i=a.sent,0===(s=i.data).code&&s.data.messages.length>0&&(t.replyNotices=t.replyNotices.concat(s.data.messages),t.page=s.data.pageInfo);case 5:case"end":return a.stop()}},a,this)})),100),this.busy=!1}},created:function(){}},Ae=(a("ytDo"),a("vWkq"),Object(X.a)(ze,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"reply-me-container"},[a("el-scrollbar",{staticClass:"m-scroll",staticStyle:{height:"100%"}},[a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMore,expression:"loadMore"}],staticClass:"card-container",attrs:{"infinite-scroll-disabled":"busy","infinite-scroll-distance":"20"}},[t._l(t.replyNotices,function(e){return a("el-card",{key:e.id,staticClass:"box-card"},[a("div",{staticClass:"card-item"},[a("el-popover",{attrs:{"popper-class":"del-pop",placement:"bottom",trigger:"click"}},[a("div",[t._v("删除")]),a("el-button",{staticStyle:{float:"right",padding:"2px 0",color:"#999",transform:"rotate(90deg)","font-size":"18px"},attrs:{slot:"reference",icon:"el-icon-more",type:"text"},slot:"reference"})],1),a("div",{staticClass:"item-content"},[a("div",{staticClass:"user-face"},[a("a",{attrs:{href:"#/user/"+e.publisher.uid,target:"_blank"}},[a("img",{staticClass:"avatar",attrs:{src:e.publisher.face?e.publisher.face:"/static/akari.jpg"}})])]),a("div",{staticClass:"reply-content"},[a("div",{staticClass:"nick-time"},[a("a",{staticClass:"nick-text",attrs:{href:"#/user/"+e.publisher.uid,target:"_blank"}},[t._v(t._s(e.publisher.nick))]),a("span",{staticClass:"time-text"},[t._v(t._s(t.getDateDiff(e.modify_time)))])]),a("div",{staticClass:"reply-ctx"},[a("a",{staticClass:"reply-text",attrs:{href:"#/video/"+e.ep_id+"?rid="+e.reply_id,target:"_blank"}},[t._v(t._s(e.content))])])])]),a("div",{staticClass:"item-footer"},[a("div",{staticClass:"footer-ctx"},[a("span",{staticClass:"footer-ctx-text"},[a("a",{staticClass:"fo-link",attrs:{target:"_blank",href:"#/video/"+e.ep_id}},[t._v(t._s(e.title))]),t._v("评论中回复了你")])])])],1)])}),a("div",{directives:[{name:"show",rawName:"v-show",value:0===t.replyNotices.length,expression:"replyNotices.length===0"}]},[a("h1",[t._v("暂无回复")])])],2)])],1)},[],!1,null,"53d559b1",null).exports),Ve={data:function(){return{replyNotices:[],page:{pageNumber:0},busy:!1}},directives:{infiniteScroll:$e.a},methods:{getDateDiff:function(t){var e=(new Date).getTime()-t;if(!(e<0)){var a=e/36e5,i=e/6e4;return e/864e5>=1?yt(new Date(t),"yyyy-MM-dd hh:mm"):a>=1?parseInt(a)+"小时前":i>=1?parseInt(i)+"分钟前":"刚刚"}},initReplyNotices:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=localStorage.getItem("USER_ID"),t.next=5,B(e,"at");case 5:a=t.sent,0===(i=a.data).code&&(this.replyNotices=i.data.messages,this.page=i.data.pageInfo);case 9:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),loadMore:function(){var t=this;this.busy=!0;var e=localStorage.getItem("USER_ID");e&&setTimeout(Object(r.a)(regeneratorRuntime.mark(function a(){var i,s;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,E(e,"at",t.page.pageNumber+1);case 2:i=a.sent,0===(s=i.data).code&&s.data.messages.length>0&&(t.replyNotices=t.replyNotices.concat(s.data.messages),t.page=s.data.pageInfo);case 5:case"end":return a.stop()}},a,this)})),100),this.busy=!1}},created:function(){}},Fe=(a("wO9Z"),Object(X.a)(Ve,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"reply-me-container"},[a("el-scrollbar",{staticClass:"m-scroll",staticStyle:{height:"100%"}},[a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMore,expression:"loadMore"}],staticClass:"card-container",attrs:{"infinite-scroll-disabled":"busy","infinite-scroll-distance":"20"}},[t._l(t.replyNotices,function(e){return a("el-card",{key:e.id,staticClass:"box-card"},[a("div",{staticClass:"card-item"},[a("el-popover",{attrs:{"popper-class":"del-pop",placement:"bottom",trigger:"click"}},[a("div",[t._v("删除")]),a("el-button",{staticStyle:{float:"right",padding:"2px 0",color:"#999",transform:"rotate(90deg)","font-size":"18px"},attrs:{slot:"reference",icon:"el-icon-more",type:"text"},slot:"reference"})],1),a("div",{staticClass:"item-content"},[a("div",{staticClass:"user-face"},[a("a",{attrs:{href:"#/user/"+e.publisher.uid,target:"_blank"}},[a("img",{staticClass:"avatar",attrs:{src:e.publisher.face?e.publisher.face:"/static/akari.jpg"}})])]),a("div",{staticClass:"reply-content"},[a("div",{staticClass:"nick-time"},[a("a",{staticClass:"nick-text",attrs:{href:"#/user/"+e.publisher.uid,target:"_blank"}},[t._v(t._s(e.publisher.nick))]),a("span",{staticClass:"time-text"},[t._v(t._s(t.getDateDiff(e.modify_time)))])]),a("div",{staticClass:"reply-ctx"},[a("a",{staticClass:"reply-text",attrs:{href:"#/video/"+e.ep_id+"?rid="+e.reply_id,target:"_blank"}},[t._v(t._s(e.content))])])])]),a("div",{staticClass:"item-footer"},[a("div",{staticClass:"footer-ctx"},[a("span",{staticClass:"footer-ctx-text"},[a("a",{staticClass:"fo-link",attrs:{target:"_blank",href:"#/video/"+e.ep_id}},[t._v(t._s(e.title))]),t._v("评论中@了你")])])])],1)])}),a("div",{directives:[{name:"show",rawName:"v-show",value:0===t.replyNotices.length,expression:"replyNotices.length===0"}]},[a("h1",[t._v("暂无@我的")])])],2)])],1)},[],!1,null,"5df8f8c0",null).exports),Ge={data:function(){return{pactiveIndex:"1",msgType:"系统通知"}},components:{SystemNotice:Pe,ReplyNotice:Ae,AtNotice:Fe},methods:{changeMsgTypeTitle:function(t){this.msgType=t},getParams:function(){var t=this.$route.params.type;t&&(this.msgType=t)}},watch:{$route:"getParams"},mounted:function(){var t=this.$route.params.type;t&&(this.msgType=t)}},We=(a("zfpp"),a("qyc5"),Object(X.a)(Ge,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"message-div",staticStyle:{width:"980px",margin:"0 auto"}},[a("el-container",{staticStyle:{"min-height":"800px","border-radius":"5px"}},[a("el-aside",{staticClass:"msg-ctx-menu",staticStyle:{"margin-right":"20px","background-color":"#262633"},attrs:{width:"200px"}},[a("div",{staticClass:"msg-icon"}),a("div",{staticClass:"msg-station",staticStyle:{color:"#19584e"}},[t._v("消息中心")]),a("el-menu",{staticStyle:{"background-color":"#262633",border:"0"},attrs:{"default-active":t.pactiveIndex}},[a("router-link",{attrs:{to:{name:"snotice"}}},[a("el-menu-item",{staticClass:"nav-item",attrs:{index:"1"},on:{click:function(e){t.changeMsgTypeTitle("系统通知")}}},[t._v("系统通知")])],1),a("router-link",{attrs:{to:{name:"rnotice"}}},[a("el-menu-item",{staticClass:"nav-item",attrs:{index:"2"},on:{click:function(e){t.changeMsgTypeTitle("回复我的")}}},[t._v("回复我的 ")])],1),a("router-link",{attrs:{to:{name:"anotice"}}},[a("el-menu-item",{staticClass:"nav-item",attrs:{index:"3"},on:{click:function(e){t.changeMsgTypeTitle("@我的")}}},[t._v("@我的")])],1),a("router-link",{attrs:{to:{name:"lnotice"}}},[a("el-menu-item",{staticClass:"nav-item",attrs:{index:"4"},on:{click:function(e){t.changeMsgTypeTitle("收到的赞")}}},[t._v("收到的赞")])],1)],1)],1),a("el-container",{staticStyle:{overflow:"inherit"}},[a("el-header",{staticStyle:{"background-color":"#262633","margin-bottom":"10px",height:"50px"}},[a("p",{staticClass:"msg-type-title"},[t._v(t._s(t.msgType))])]),a("el-main",{staticStyle:{padding:"0"}},[a("router-view")],1)],1)],1)],1)},[],!1,null,"7e07c674",null).exports),Ze={data:function(){return{switchval:!1,loginData:{principal:"",password:"",remember_me:0}}},computed:{},methods:{login:(Zt=Object(r.a)(regeneratorRuntime.mark(function t(){var e,a,i,s,n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(""!=(e={principal:this.loginData.principal,password:this.loginData.password,remember_me:this.loginData.remember_me?1:0}).principal&&""!=e.password){t.next=4;break}return this.$message({message:"账号或密码为空",type:"info"}),t.abrupt("return",!1);case 4:return t.next=6,h(e);case 6:if(a=t.sent,i=a.data,s="",n="",r="",2002!==i.code&&null!=i.data){t.next=14;break}return this.$message({message:i.msg,type:"error"}),t.abrupt("return",!1);case 14:0!==i.code&&"OK"!==i.msg||(n=i.data.token,r=e.principal,s=i.data.user.uid,this.tap("uid:"+s),n||this.$message({message:"无法获取到Token",type:"error"})),this.checkLocalStorage()&&(localStorage.setItem("USER_ID",s),localStorage.setItem("JWT_TOKEN",n),localStorage.setItem("loginUserName",r),localStorage.setItem("face",i.data.user.face),localStorage.setItem("ROLE",i.data.user.role),window.location.href="/");case 16:case"end":return t.stop()}},t,this)})),function(){return Zt.apply(this,arguments)}),checkLocalStorage:function(){return void 0!==window.localStorage||(this.$message({message:"请关闭隐私模式,或者浏览器太老旧了,否则无法保存登录状态",type:"warning"}),!1)}}},Ke=(a("zn61"),Object(X.a)(Ze,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{"min-height":"37px"},attrs:{id:"mainer"}},[a("input",{attrs:{id:"rightNum",type:"hidden"}}),a("div",{attrs:{id:"mainer-inner"}},[a("div",{attrs:{id:"area-reg"}},[t._m(0),a("div",{staticClass:"block r"},[a("div",{staticClass:"area-reg"},[a("el-form",{ref:"reg",staticClass:"form",attrs:{id:"form-reg","status-icon":""}},[a("h3",{staticClass:"title"},[t._v("登入 Darker")]),a("div",{staticClass:"area"},[a("el-form-item",[a("el-input",{staticClass:"regname name l error",attrs:{id:"ipt-username-reg",name:"name",type:"text","auto-complete":"off",placeholder:"昵称/邮箱",required:"required"},model:{value:t.loginData.principal,callback:function(e){t.$set(t.loginData,"principal",e)},expression:"loginData.principal"}})],1),a("span",{staticClass:"clearfix"})],1),a("div",{staticClass:"area"},[a("el-form-item",[a("el-input",{staticClass:"password l error",attrs:{id:"ipt-pwd-reg",name:"password",type:"password","auto-complete":"off",placeholder:"请输入密码，6-20位",required:"required"},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.login(e):null}},model:{value:t.loginData.password,callback:function(e){t.$set(t.loginData,"password",e)},expression:"loginData.password"}})],1),a("span",{staticClass:"clearfix"})],1),a("div",{staticClass:"area"},[a("el-form-item",[a("span",{staticStyle:{display:"inline-block",color:"#717171","margin-right":"10px"}},[t._v("记住我")]),a("el-switch",{attrs:{"active-color":"#3a86ef","inactive-color":"#777"},model:{value:t.switchval,callback:function(e){t.switchval=e},expression:"switchval"}}),a("span",{staticStyle:{color:"#bbb","margin-left":"10px"}},[t._v("不是自己的电脑上不要勾选此项")])],1),a("span",{staticClass:"clearfix"})],1),a("div",{staticClass:"area-tool"},[a("a",{staticClass:"do login-btn primary",on:{click:t.login}},[t._v("登入")]),a("div",{staticClass:"launchBtn bg hidden",attrs:{id:"launchBtn"}}),a("p"),a("span",{staticClass:"clearfix"})])])],1)]),a("span",{staticClass:"clearfix"})])])])},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"block l"},[e("div",{staticClass:"bg-login"})])}],!1,null,"7f0e15de",null).exports),Je={},qe=(a("5GW5"),Object(X.a)(Je,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"f-container"},[e("p",{staticClass:"site-footer__copyright"},[this._v("© "+this._s((new Date).getFullYear())+" Darker.  Power By\n        "),e("img",{staticClass:"heart",attrs:{src:"/static/love.png"}})])])},[],!1,null,"32775f6c",null).exports),He={data:function(){return{verifyResult:{code:1,result:""}}},methods:{verifyEmailAddr:(Kt=Object(r.a)(regeneratorRuntime.mark(function t(e,a){var i,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O(e,a);case 2:i=t.sent,s=i.data,this.verifyResult.code=s.code,this.verifyResult.result=s.msg;case 7:case"end":return t.stop()}},t,this)})),function(t,e){return Kt.apply(this,arguments)})},created:function(){var t=this.$route.query.userId,e=this.$route.query.uuid;t&&e?this.verifyEmailAddr(t,e):this.verifyResult.result="邮箱验证失败"}},Xe=(a("vQ27"),Object(X.a)(He,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"email-verify"},[e("div",{staticClass:"verify-result"},[this._v("\n        "+this._s(this.verifyResult.result)+"\n    ")]),e("div",{staticStyle:{"margin-top":"40px"}},[e("el-button",{attrs:{type:"primary"}},[this._v("回到首页")])],1)])},[],!1,null,"1a68552d",null).exports),Ye={data:function(){return{userInfo:""}},methods:{initUserInfo:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(e){var a,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,D(e);case 2:a=t.sent,0===(i=a.data).code?this.userInfo=i.data:this.$message({message:i.msg,type:"error"});case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},created:function(){var t=this.$route.params.uid;t&&this.initUserInfo(t)}},Qe=(a("h/34"),a("cSy8"),Object(X.a)(Ye,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"user-p-container"},[a("div",{staticClass:"profile-wrapper"},[a("div",{staticClass:"u-avatar"},[a("img",{staticClass:"avatar-img",attrs:{src:t.userInfo.face?t.userInfo.face:"/static/akari.jpg"}})]),a("div",{staticClass:"u-infos"},[a("div",{staticClass:"u-nick"},[a("span",[t._v(t._s(t.userInfo.nick))])]),a("div",{staticClass:"u-id"},[a("span",[t._v("id:"+t._s(t.userInfo.uid))])]),a("div",{staticClass:"u-sex"},[a("span",[t._v("性别 "+t._s(t.userInfo.sex))])]),a("div",{staticClass:"u-sign"},[a("span",[t._v(t._s(t.userInfo.sign))])])])])])},[],!1,null,"38cf6ff9",null).exports),ta={name:"app",components:{HelloWorld:tt,WatchVideo:Ie,Register:Re,PersonalStation:Ue,MessageStation:We,Login:Ke,EmailVerify:Xe,UserProfile:Qe,myfooter:qe},data:function(){return{showLogin:!1,nameInput:"",passwordInput:"",rememberMe:!1,activeIndex:"1",isLogin:!1,loginUserName:"",uid:"",msgnum:0,vuepages:{hello:"HelloWorld",video:"video",space:"space"},curUserFace:"",unreadMsg:0,unreadSysMsg:0,unreadReplyMsg:0,unreadAtMsg:0,unreadLikeMsg:0,intervalId:"",activeDate:""}},methods:{handleSelect:function(t,e){this.tap(t,e)},registerPage:function(){this.tap("goto register page"),this.showLogin=!1,this.$router.push({path:"/register"})},login:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(){var e,a,i,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(""!==(e={principal:this.nameInput,password:this.passwordInput,remember_me:this.rememberMe?1:0}).principal&&""!==e.password){t.next=4;break}return this.$message({message:"账号或密码为空",type:"info"}),t.abrupt("return",!1);case 4:return t.next=6,h(e);case 6:if(a=t.sent,i=a.data,s="",2002!==i.code&&null!=i.data){t.next=12;break}return this.$message({message:"账号不存在或密码错误",type:"error"}),t.abrupt("return",!1);case 12:0!==i.code&&"OK"!==i.msg||(s=i.data.token,this.isLogin=!0,this.loginUserName=e.principal,this.tap("login return data:"+i.data),this.uid=i.data.user.uid,this.tap("uid:"+this.uid),s||this.$message({message:"无法获取到Token",type:"error"})),this.checkLocalStorage()&&(localStorage.setItem("USER_ID",this.uid),localStorage.setItem("JWT_TOKEN",s),localStorage.setItem("loginUserName",this.loginUserName));case 14:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),checkLocalStorage:function(){return void 0!==window.localStorage||(this.$message({message:"请关闭隐私模式,或者浏览器太老旧了,否则无法保存登录状态",type:"warning"}),!1)},getLoginUsername:function(){return localStorage.getItem("loginUserName")},logout:(Ht=Object(r.a)(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,g();case 3:0!==(e=t.sent).data.code&&"登出成功"!==e.data.msg||(this.isLogin=!1,localStorage.setItem("JWT_TOKEN",""),localStorage.setItem("loginUserName",""),localStorage.setItem("USER_ID","")),this.isLogin=!1,localStorage.removeItem("USER_ID"),localStorage.removeItem("JWT_TOKEN"),localStorage.removeItem("loginUserName"),localStorage.removeItem("face"),window.location.href="/";case 11:case"end":return t.stop()}},t,this)})),function(){return Ht.apply(this,arguments)}),getCurUserFace:function(){return localStorage.getItem("face")},countUnreadMsg:(qt=Object(r.a)(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e=localStorage.getItem("USER_ID"))){t.next=9;break}return t.next=4,N(e);case 4:a=t.sent,0===(i=a.data).code?(this.unreadMsg=i.data.total,this.unreadSysMsg=i.data.system,this.unreadReplyMsg=i.data.reply,this.unreadAtMsg=i.data.at,this.unreadLikeMsg=i.data.like):(this.unreadMsg=0,this.unreadSysMsg=0,this.unreadReplyMsg=0,this.unreadAtMsg=0,this.unreadLikeMsg=0),t.next=10;break;case 9:case 10:case"end":return t.stop()}},t,this)})),function(){return qt.apply(this,arguments)}),clearMsgCount:function(t){switch(t){case"reply":this.unreadMsg-=this.unreadReplyMsg,this.unreadReplyMsg=0;break;case"system":this.unreadMsg-=this.unreadSysMsg,this.unreadSysMsg=0;break;case"like":this.unreadMsg-=this.unreadLikeMsg,this.unreadLikeMsg=0;break;case"at":this.unreadMsg-=this.unreadAtMsg,this.unreadAtMsg=0}},goMP:function(){this.activeDate=(new Date).getTime()},goVideo:function(){this.activeDate=(new Date).getTime()}},mounted:(Jt=Object(r.a)(regeneratorRuntime.mark(function t(){var e,a,i,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.checkLocalStorage()){t.next=13;break}if(e=localStorage.getItem("loginUserName"),a=localStorage.getItem("JWT_TOKEN"),i=localStorage.getItem("USER_ID"),this.tap("check userid: "+i),null!=a&&""!==a){t.next=8;break}return this.isLogin=!1,t.abrupt("return");case 8:return t.next=10,f(a);case 10:s=t.sent,this.tap(s.data),0!==s.data.code&&"ojbk"!==s.data.msg||(this.isLogin=!0,this.loginUserName=e);case 13:this.curUserFace=this.getCurUserFace();case 15:case"end":return t.stop()}},t,this)})),function(){return Jt.apply(this,arguments)}),created:function(){var t=this;this.countUnreadMsg(),this.checkLocalStorage()&&(localStorage.getItem("USER_ID")&&localStorage.getItem("JWT_TOKEN")&&localStorage.getItem("loginUserName")&&localStorage.getItem("ROLE")?this.isLogin=!0:this.isLogin=!1,localStorage.getItem("USER_ID")&&this.isLogin&&(this.intervalId=setInterval(function(){t.countUnreadMsg()},6e4)))},beforeDestroy:function(){this.intervalId&&clearInterval(this.intervalId)}},ea=(a("ZL7j"),Object(X.a)(ta,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{height:"100%"},attrs:{id:"app"}},[a("el-container",{staticStyle:{height:"100%"}},[a("el-header",{staticClass:"appheader",staticStyle:{"background-color":"rgb(20, 20, 34)","box-shadow":"0 1px 3px rgba(0,0,0,.12), 0 1px 2px rgba(0,0,0,.24)"}},[a("div",{staticStyle:{width:"980px",margin:"0 auto",position:"relative","z-index":"200"}},[a("el-menu",{staticClass:"el-menu-demo",staticStyle:{"border-bottom":"none","background-color":"inherit"},attrs:{"default-active":t.activeIndex,mode:"horizontal"},on:{select:t.handleSelect}},[a("el-menu-item",{staticClass:"header-link",staticStyle:{"border-bottom":"none"},attrs:{index:"1"}},[a("router-link",{attrs:{to:{name:"HelloWorld"}},nativeOn:{click:function(e){return t.goMP(e)}}},[t._v("首页")])],1),a("el-menu-item",{staticClass:"header-link",staticStyle:{"border-bottom":"none"},attrs:{index:"2"}},[a("router-link",{attrs:{to:{name:"video"}},nativeOn:{click:function(e){return t.goVideo(e)}}},[t._v("观看")])],1),a("el-dropdown",{staticClass:"avatar-container",attrs:{placement:"bottom"}},[a("div",{staticClass:"avatar-wrapper"},[a("img",{staticClass:"user-avatar",attrs:{src:t.curUserFace?t.curUserFace:"/static/akari.jpg"}})]),t.isLogin?a("el-dropdown-menu",{staticClass:"user-dropdown",attrs:{slot:"dropdown",visibleArrow:!1},slot:"dropdown"},[a("router-link",{attrs:{to:{name:"personal"}}},[a("el-dropdown-item",[a("span",{staticStyle:{"font-size":"10px"}},[t._v(t._s(t.getLoginUsername()))])])],1),a("router-link",{attrs:{to:{name:"avatar"}}},[a("el-dropdown-item",[a("span",{staticStyle:{display:"block"}},[t._v("个人中心")])])],1),a("div",{on:{click:t.logout}},[a("el-dropdown-item",[a("span",{staticStyle:{display:"block"}},[t._v("退出登录")])])],1)],1):a("el-dropdown-menu",{staticClass:"user-dropdown",attrs:{slot:"dropdown",visibleArrow:!1},slot:"dropdown"},[a("el-dropdown-item",{staticStyle:{"background-color":"#fff"}},[a("div",{staticClass:"login-container"},[a("div",{staticClass:"i_menu i_menu_login"},[a("p",{staticClass:"tip"},[t._v("登录后你可以：")]),a("div",{staticClass:"img"},[a("img",{attrs:{src:"/static/sticker.webp"}})])]),a("el-button",{staticStyle:{width:"320px"},attrs:{type:"primary"},on:{click:function(e){t.$router.push({path:"/login"})}}},[t._v("\n                              登入\n                            ")]),a("p",{staticClass:"reg"},[t._v("首次使用？"),a("a",{attrs:{href:"#/register"}},[t._v("点我去注册")])])],1)])],1)],1),t.isLogin?a("el-dropdown",{staticClass:"message-container",attrs:{placement:"bottom"}},[t.isLogin?a("div",[t.unreadMsg>0?a("el-badge",{staticClass:"item",attrs:{value:t.unreadMsg,max:99}},[a("el-button",{staticClass:"header-link",attrs:{type:"text"}},[t._v("消息")])],1):a("el-button",{staticClass:"header-link",attrs:{type:"text"}},[t._v("消息")])],1):t._e(),a("el-dropdown-menu",{staticClass:"user-dropdown",attrs:{slot:"dropdown",visibleArrow:!1},slot:"dropdown"},[a("div",{on:{click:function(e){t.clearMsgCount("system")}}},[a("router-link",{attrs:{to:{name:"snotice",params:{type:"系统通知"}}}},[a("el-dropdown-item",[t.unreadSysMsg>0?a("el-badge",{staticClass:"item",attrs:{value:t.unreadSysMsg,max:99}},[a("div",{staticClass:"notice-item"},[t._v("系统通知")])]):a("div",{staticClass:"notice-item"},[t._v("系统通知")])],1)],1)],1),a("div",{on:{click:function(e){t.clearMsgCount("reply")}}},[a("router-link",{attrs:{to:{name:"rnotice",params:{type:"回复我的"}}}},[a("el-dropdown-item",[t.unreadReplyMsg>0?a("el-badge",{staticClass:"item",attrs:{value:t.unreadReplyMsg,max:99}},[a("div",{staticClass:"notice-item"},[t._v("回复我的")])]):a("div",{staticClass:"notice-item"},[t._v("回复我的")])],1)],1)],1),a("div",{on:{click:function(e){t.clearMsgCount("at")}}},[a("router-link",{attrs:{to:{name:"anotice",params:{type:"@我的"}}}},[a("el-dropdown-item",[t.unreadAtMsg>0?a("el-badge",{staticClass:"item",attrs:{value:t.unreadAtMsg,max:99}},[a("div",{staticClass:"notice-item"},[t._v("@我的")])]):a("div",{staticClass:"notice-item"},[t._v("@我的")])],1)],1)],1),a("div",{on:{click:function(e){t.clearMsgCount("like")}}},[a("router-link",{attrs:{to:{name:"lnotice",params:{type:"收到的赞"}}}},[a("el-dropdown-item",[t.unreadLikeMsg>0?a("el-badge",{staticClass:"item",attrs:{value:t.unreadLikeMsg,max:99}},[a("div",{staticClass:"notice-item"},[t._v("收到的赞")])]):a("div",{staticClass:"notice-item"},[t._v("收到的赞")])],1)],1)],1)])],1):t._e()],1)],1)]),a("el-main",{staticStyle:{"background-color":"#141422",overflow:"initial",padding:"0"}},[a("router-view",{key:t.activeDate})],1),a("myfooter")],1)],1)},[],!1,null,null,null).exports),aa=a("jE9Z"),ia={data:function(){return{likeNotices:[],page:{pageNumber:0},busy:!1}},directives:{infiniteScroll:$e.a},methods:{getDateDiff:function(t){var e=(new Date).getTime()-t;if(!(e<0)){var a=e/36e5,i=e/6e4;return e/864e5>=1?yt(new Date(t),"yyyy-MM-dd hh:mm"):a>=1?parseInt(a)+"小时前":i>=1?parseInt(i)+"分钟前":"刚刚"}},initReplyNotices:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=localStorage.getItem("USER_ID"),t.next=5,B(e,"like");case 5:a=t.sent,0===(i=a.data).code&&(this.likeNotices=i.data.messages,this.page=i.data.pageInfo);case 9:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),loadMore:function(){var t=this;this.busy=!0;var e=localStorage.getItem("USER_ID");e&&setTimeout(Object(r.a)(regeneratorRuntime.mark(function a(){var i,s;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,E(e,"like",t.page.pageNumber+1);case 2:i=a.sent,0===(s=i.data).code&&s.data.messages.length>0&&(t.likeNotices=t.likeNotices.concat(s.data.messages),t.page=s.data.pageInfo);case 5:case"end":return a.stop()}},a,this)})),100),this.busy=!1}},created:function(){}},sa=(a("/0Mw"),Object(X.a)(ia,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"like-container"},[a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMore,expression:"loadMore"}],staticClass:"card-container",attrs:{"infinite-scroll-disabled":"busy","infinite-scroll-distance":"20"}},[t._l(t.likeNotices,function(e){return a("el-card",{key:e.id,staticClass:"box-card"},[a("div",{staticClass:"card-item"},[a("div",{staticClass:"item-content"},[a("div",{staticClass:"user-face"},[a("div",{staticClass:"like-image-holder"},[a("img",{staticClass:"avatar2",attrs:{src:"/static/like2.png"}})])]),a("div",{staticClass:"reply-content"},[a("div",{staticClass:"like-ctxs"},[a("a",{staticClass:"nick-text",attrs:{href:"#/user/"+e.publisher.uid,target:"_blank"}},[t._v(t._s(e.publisher.nick))]),a("div",{staticClass:"like-ctx"},[a("a",{staticClass:"reply-text",attrs:{href:"#/video/"+e.ep_id+"?rid="+e.reply_id,target:"_blank"}},[t._v(t._s(e.content))])]),a("span",{staticClass:"time-text"},[t._v(t._s(t.getDateDiff(e.modify_time)))])])])])])])}),a("div",{directives:[{name:"show",rawName:"v-show",value:0===t.likeNotices.length,expression:"likeNotices.length===0"}]},[a("h1",[t._v("暂无点赞")])])],2)])},[],!1,null,"e83113d6",null).exports),na={props:["postBangumi"],name:"PostBangumiCard",components:{"my-upload":Ce.a},data:function(){return{dialogVisible:!1,pb:{id:this.postBangumi.id,bn:this.postBangumi.bn,et:this.postBangumi.et,hzi:this.postBangumi.hzi,thumb:this.postBangumi.thumb},pbTemp:this.postBangumi,show:!1,imgDataUrl:"",curImageUrl:"",isDelete:!1,langExtObj:{preview:"封面预览"}}},computed:{isPending:function(){return"待处理"===this.pbTemp.pbs_name},isSuccess:function(){return"已采纳"===this.pbTemp.pbs_name},isNotPerfect:function(){return"待完善"===this.pbTemp.pbs_name},isFailed:function(){return"未被采纳"===this.pbTemp.pbs_name},isAuditing:function(){return"待审核"===this.pbTemp.pbs_name}},methods:{updatePostBangumi:(Qt=Object(r.a)(regeneratorRuntime.mark(function t(){var e,a,i=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,M(this.pb);case 3:e=t.sent,0===(a=e.data).code?this.$alert(a.msg,"修改成功",{confirmButtonText:"确定",callback:function(t){i.pbTemp=a.data,setTimeout(function(){return i.dialogVisible=!1},400)}}):5003===a.code?this.$alert(a.msg,"提示",{confirmButtonText:"确定"}):this.$alert(a.msg,"参数有误",{confirmButtonText:"确定",callback:function(t){}});case 6:case"end":return t.stop()}},t,this)})),function(){return Qt.apply(this,arguments)}),toggleShow:function(){this.show=!this.show},cropUploadSuccess:function(t,e){var a=t.data.link;a=a.substring(a.lastIndexOf("/")),this.pbTemp.thumb=this.GLOBAL.imgURL+a,this.pb.thumb=this.GLOBAL.imgURL+a,"SUCCESS"!==this.pbTemp.pbs&&"AUDITING"!==this.pbTemp.pbs||this.updatePostBangumiThumb()},cropSuccess:function(t,e){},cropUploadFail:function(t,e){},updatePostBangumiThumb:(Yt=Object(r.a)(regeneratorRuntime.mark(function t(){var e,a,i,s=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e={id:this.pbTemp.id,thumb:this.pbTemp.thumb},t.next=4,P(e);case 4:a=t.sent,0===(i=a.data).code?(this.pbTemp=i.data,setTimeout(function(){return s.show=!1},100),this.$alert("修改封面需要审核，结果请留意系统通知","封面提交成功",{confirmButtonText:"确定",callback:function(t){s.pbTemp=i.data}})):this.$message.error(i.msg);case 7:case"end":return t.stop()}},t,this)})),function(){return Yt.apply(this,arguments)}),deletePostBangumi:function(){var t=this;this.$confirm("注意! 一旦删除将无法恢复, 本操作仅会删除个人记录, 已采纳的番剧信息将会保留","确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(r.a)(regeneratorRuntime.mark(function e(){var a,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z(t.pbTemp.id);case 2:a=e.sent,0===(i=a.data).code?(t.isDelete=!0,t.$message.success("删除成功")):t.$message.error(i.msg);case 6:case"end":return e.stop()}},e,this)}))).catch(function(){})}},doDeletePostBangumi:(Xt=Object(r.a)(regeneratorRuntime.mark(function t(){var e,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,z(this.pbTemp.id);case 2:e=t.sent,0===(a=e.data).code?(this.isDelete=!0,this.$message({type:"success",message:"删除成功!"})):this.$message.error(a.msg);case 5:case"end":return t.stop()}},t,this)})),function(){return Xt.apply(this,arguments)}),created:function(){}},ra=(a("gc/w"),{name:"PostBangumi",components:{postBangumiCard:Object(X.a)(na,function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.isDelete?t._e():a("div",{staticClass:"pb-card-container"},[a("div",{staticClass:"pb-thumb"},[a("img",{attrs:{src:t.pbTemp.thumb?t.pbTemp.thumb:"/static/2.jpg",alt:"暂无封面"}})]),a("div",{staticClass:"pb-card-header"},[a("div",{staticClass:"pb-name"},[a("h2",[t._v(t._s(t.pb.bn))])]),a("div",{staticClass:"pb-episode"},[a("span",[a("span",{staticStyle:{color:"cadetblue"}},[t._v(" | ")]),t._v(" 共"+t._s(t.pbTemp.et)+"集")])]),a("div",{staticClass:"pb-status"},[t._v("\n      状态:\n      "),a("div",{class:{pending:t.isPending,failed:t.isFailed,success:t.isSuccess,nperfect:t.isNotPerfect,auditing:t.isAuditing},staticStyle:{float:"right","border-radius":"5px",width:"auto",height:"21px"}},[a("span",[t._v(t._s(t.pbTemp.pbs_name))])])])]),a("div",{staticClass:"pb-time-holder"},[""!==t.pbTemp.msg?a("div",{staticClass:"pb-message"},[t._v("\n      修改建议:"+t._s(t.pbTemp.msg)+"\n    ")]):t._e(),""!==t.pbTemp.msg?a("br"):t._e(),a("div",{staticClass:"pb-time"},[t._v("\n      创建时间: "+t._s(new Date(t.pbTemp.create_time).toLocaleString())+"\n    ")]),a("br"),a("div",{staticClass:"pb-time"},[t._v("\n      修改时间: "+t._s(new Date(t.pbTemp.modify_time).toLocaleString())+"\n    ")])]),a("div",{staticClass:"action-btn-group-container"},[a("el-dropdown",[a("span",{staticClass:"el-dropdown-link"},[a("span",{staticStyle:{color:"#e4e4e6"}},[t._v("操作")]),a("i",{staticClass:"el-icon-arrow-down el-icon--right",staticStyle:{color:"#8bc34a"}})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[a("div",{staticClass:"action-btn-group"},["SUCCESS"===t.postBangumi.pbs||"AUDITING"===t.postBangumi.pbs?a("el-button",{staticClass:"show",attrs:{size:"mini"}},[t._v("设置为可见\n            ")]):t._e()],1)]),a("el-dropdown-item",[a("div",{staticClass:"action-btn-group"},["SUCCESS"===t.postBangumi.pbs||"AUDITING"===t.postBangumi.pbs?a("el-button",{staticClass:"thumb",attrs:{size:"mini"},on:{click:t.toggleShow}},[t._v("修改封面\n          ")]):t._e()],1)]),a("el-dropdown-item",[a("div",{staticClass:"action-btn-group"},["SUCCESS"!==t.postBangumi.pbs&&"AUDITING"!==t.postBangumi.pbs?a("el-button",{staticClass:"edit",attrs:{size:"mini"},on:{click:function(e){t.dialogVisible=!0}}},[t._v("修改\n          ")]):t._e()],1)]),a("el-dropdown-item",[a("div",{staticClass:"action-btn-group"},[a("el-button",{staticClass:"delete",attrs:{size:"mini"},on:{click:t.deletePostBangumi}},[t._v("删除")])],1)])],1)],1)],1),a("el-dialog",{attrs:{title:"修改番剧信息",visible:t.dialogVisible,width:"550px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",[a("el-form-item",{staticClass:"post-bangumi-explain"},[a("div",{staticClass:"explain-container"},[a("span",[a("strong",[t._v("* 番剧名称定义需要按照以下规则")])]),a("br"),a("span",[t._v("- 番剧名称以百度百科为准")]),a("br"),a("span",[t._v("- 第一个季度直接采取该名称,例如「darker」")]),a("br"),a("span",[t._v("- 多个季度,则以「番剧名称+空格+第几季」命名,例如「darker 第二季」")]),a("br"),a("span",[t._v("- sp,ova,剧场版规则与以上规则一致,例如「darker ova」")]),a("br"),a("span",[t._v("- 当然也不仅限于番剧,电影也是一样可以的")])])]),a("el-form-item",{attrs:{label:"番剧名称","label-width":"140"}},[a("el-input",{staticStyle:{width:"350px",display:"inherit"},attrs:{"auto-complete":"off"},model:{value:t.pb.bn,callback:function(e){t.$set(t.pb,"bn",e)},expression:"pb.bn"}})],1),a("el-form-item",{attrs:{label:"是否有第0集"}},[a("div",{staticStyle:{float:"left","margin-left":"20px"}},[a("el-radio-group",{attrs:{size:"small","text-color":"#141422"},model:{value:t.pb.hzi,callback:function(e){t.$set(t.pb,"hzi",e)},expression:"pb.hzi"}},[a("el-radio",{attrs:{border:"",label:0}},[t._v("没有")]),a("el-radio",{attrs:{border:"",label:1}},[t._v("有")])],1)],1)]),a("el-form-item",{staticStyle:{"margin-bottom":"0"}},[a("div",{staticClass:"explain-container"},[a("span",[t._v("* 若剧场版或电影则集数为「1」")]),a("br")])]),a("el-form-item",{attrs:{label:"总集数","label-width":"120"}},[a("el-input",{staticStyle:{width:"80px",display:"inherit"},attrs:{type:"text"},model:{value:t.pb.et,callback:function(e){t.$set(t.pb,"et",e)},expression:"pb.et"}})],1),a("el-form-item",{attrs:{label:"封面"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pb.thumb,expression:"pb.thumb"}],attrs:{type:"hidden"},domProps:{value:t.pb.thumb},on:{input:function(e){e.target.composing||t.$set(t.pb,"thumb",e.target.value)}}}),a("el-button",{staticStyle:{float:"left",margin:"7px 0",border:"none"},attrs:{type:"primary",size:"mini"},on:{click:function(e){t.show=!0}}},[t._v("上传封面")])],1),a("el-form-item",[a("img",{directives:[{name:"show",rawName:"v-show",value:t.pb.thumb,expression:"pb.thumb"}],staticStyle:{"border-radius":"5px"},attrs:{src:t.pb.thumb,alt:"加载不出来呢",width:"100%"}})]),a("el-form-item",{staticStyle:{"margin-bottom":"0"}},[a("div",{staticClass:"explain-container"},[a("span",[a("strong",[t._v("* 若本次提交被收录后封面仍可修改 *")])]),a("br")])])],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"cancel-btn",attrs:{size:"small"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消\n      ")]),a("el-button",{staticClass:"submit-btn",attrs:{type:"primary",size:"small"},on:{click:t.updatePostBangumi}},[t._v("确 定")])],1)],1),a("div",{staticClass:"upload-container",staticStyle:{"margin-top":"50px"}},[a("my-upload",{attrs:{field:"image",width:620,height:350,noCircle:!0,url:t.GLOBAL.uploadURL,headers:t.GLOBAL.uploadHEADERS,langExt:t.langExtObj,"img-format":"jpg"},on:{"crop-success":t.cropSuccess,"crop-upload-success":t.cropUploadSuccess,"crop-upload-fail":t.cropUploadFail},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}})],1)],1)},[],!1,null,"700bbd6a",null).exports,myUpload:Ce.a},data:function(){return{pageInfo:[],busy:!1,postBangumiList:[],options:[{value:"0",label:"全部"},{value:"1",label:"待处理"},{value:"2",label:"已采纳"},{value:"3",label:"待完善"},{value:"4",label:"未被采纳"},{value:"5",label:"待审核"}],value:"0",timeSort:"0",searchBangumiName:"",pbParams:{pn:1,ps:10,sc:"",pbsc:"",pc:"",dc:"",bn:""},dialogVisible:!1,postBangumi:{bangumiName:"",episodeIndex:"",hasZeroIndex:0,thumb:""},show:!1,langExtObj:{preview:"封面预览"}}},directives:{infiniteScroll:$e.a},methods:{initPostBangumi:(re=Object(r.a)(regeneratorRuntime.mark(function t(){var e,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,$(this.pbParams);case 2:e=t.sent,0===(a=e.data).code&&(this.postBangumiList=a.data.postBangumi,this.pageInfo=a.data.page);case 5:case"end":return t.stop()}},t,this)})),function(){return re.apply(this,arguments)}),getPostBangumiByStatus:(ne=Object(r.a)(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=this.value,this.pbParams.pbsc="0"===e?"":e,this.pbParams.pn=1,this.doGetPostBangumiList();case 4:case"end":return t.stop()}},t,this)})),function(){return ne.apply(this,arguments)}),changePage:(se=Object(r.a)(regeneratorRuntime.mark(function t(e){var a,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.pbParams.pn=e,t.next=3,$(this.pbParams);case 3:a=t.sent,0===(i=a.data).code&&(this.postBangumiList=i.data.postBangumi,this.pageInfo=i.data.page);case 6:case"end":return t.stop()}},t,this)})),function(t){return se.apply(this,arguments)}),getPostBangumiByTimeSort:(ie=Object(r.a)(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.pbParams.pc=this.timeSort,this.pbParams.pn=1,this.doGetPostBangumiList();case 3:case"end":return t.stop()}},t,this)})),function(){return ie.apply(this,arguments)}),doGetPostBangumiList:(ae=Object(r.a)(regeneratorRuntime.mark(function t(){var e,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,$(this.pbParams);case 2:e=t.sent,0===(a=e.data).code?(this.postBangumiList=a.data.postBangumi,this.pageInfo=a.data.page):this.$message.error(a.msg);case 5:case"end":return t.stop()}},t,this)})),function(){return ae.apply(this,arguments)}),searchByBn:(ee=Object(r.a)(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.pbParams.bn=this.searchBangumiName,this.pbParams.pn=1,this.doGetPostBangumiList();case 3:case"end":return t.stop()}},t,this)})),function(){return ee.apply(this,arguments)}),cancelSearch:(te=Object(r.a)(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:""===this.searchBangumiName&&(this.pbParams.pn=1,this.doGetPostBangumiList());case 1:case"end":return t.stop()}},t,this)})),function(){return te.apply(this,arguments)}),sendPostBangumiInfo:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(){var e,a,i,s,n,r=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.postBangumi.bangumiName,a=this.postBangumi.episodeTotal,i=this.postBangumi.hasZeroIndex,s={bangumiName:e,episodeTotal:a,hasZeroIndex:i,thumb:this.postBangumi.thumb},t.next=7,L(s);case 7:0===(n=t.sent.data).code?this.$alert(n.msg,"提交成功",{confirmButtonText:"确定",callback:function(t){r.postBangumi.bangumiName="",r.postBangumi.episodeTotal="",r.postBangumi.hasZeroIndex=0,setTimeout(function(){return r.dialogVisible=!1},400),r.postBangumiList.unshift(n.data)}}):5003===n.code?this.$alert(n.msg,"提示",{confirmButtonText:"确定",callback:function(t){r.postBangumi.bangumiName="",r.postBangumi.episodeTotal="",r.postBangumi.hasZeroIndex=0}}):this.$alert(n.msg,"参数有误",{confirmButtonText:"确定",callback:function(t){}});case 9:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),cropUploadSuccess:function(t,e){var a=t.data.link;a=a.substring(a.lastIndexOf("/")),this.postBangumi.thumb=this.GLOBAL.imgURL+a},cropSuccess:function(t,e){},cropUploadFail:function(t,e){}},created:function(){this.initPostBangumi()}}),oa=(a("XOEp"),a("pF2d"),Object(X.a)(ra,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"post-bangumi-container"},[a("el-scrollbar",{staticStyle:{height:"100%"}},[a("div",{staticClass:"pb-header"},[a("div",{staticClass:"left"},[a("h2",{staticClass:"pb-header-title"},[t._v("全部提交")]),a("span",{staticClass:"num"},[t._v("(12)")])]),a("div",{staticClass:"right"},[a("el-select",{on:{change:t.getPostBangumiByStatus},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},t._l(t.options,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)]),a("div",{staticClass:"action-bar"},[a("div",{staticClass:"new-post-bangumi"},[a("el-badge",{staticClass:"item",attrs:{value:"hot"}},[a("el-button",{staticClass:"new-pb-btn",attrs:{size:"mini"},on:{click:function(e){t.dialogVisible=!0}}},[t._v("提交番剧信息")])],1)],1),a("div",{staticClass:"bar-search"},[a("el-input",{staticClass:"bar-search-input",attrs:{placeholder:"请输入番剧名称",size:"mini"},on:{blur:t.cancelSearch},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.searchByBn(e):null}},model:{value:t.searchBangumiName,callback:function(e){t.searchBangumiName=e},expression:"searchBangumiName"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1),a("div",{staticClass:"bar-time-sort"},[a("el-select",{attrs:{size:"mini",value:"0"},on:{change:t.getPostBangumiByTimeSort},model:{value:t.timeSort,callback:function(e){t.timeSort=e},expression:"timeSort"}},[a("el-option",{attrs:{value:"0",label:"创建时间"}}),a("el-option",{attrs:{value:"1",label:"修改时间"}})],1)],1)]),a("div",{staticClass:"pb-content"},[t._l(t.postBangumiList,function(t){return a("post-bangumi-card",{key:t.id,attrs:{"post-bangumi":t}})}),0===t.postBangumiList.length?a("div",[a("h2",[t._v("暂无信息")])]):t._e(),0!==t.postBangumiList.length?a("div",{staticClass:"page-container"},[a("el-pagination",{attrs:{"current-page":t.pageInfo.pageNumber,"page-size":t.pageInfo.pageSize,layout:"prev, pager, next",total:t.pageInfo.totalSize},on:{"current-change":t.changePage}})],1):t._e()],2),a("el-dialog",{attrs:{title:"修改番剧信息",visible:t.dialogVisible,width:"550px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",[a("el-form-item",{staticClass:"post-bangumi-explain"},[a("div",{staticClass:"explain-container"},[a("span",[a("strong",[t._v("* 番剧名称定义需要按照以下规则")])]),a("br"),a("span",[t._v("- 番剧名称以百度百科为准")]),a("br"),a("span",[t._v("- 第一个季度直接采取该名称,例如「darker」")]),a("br"),a("span",[t._v("- 多个季度,则以「番剧名称+空格+第几季」命名,例如「darker 第二季」")]),a("br"),a("span",[t._v("- sp,ova,剧场版规则与以上规则一致,例如「darker ova」")]),a("br"),a("span",[t._v("- 当然也不仅限于番剧,电影也是一样可以的")])])]),a("el-form-item",{attrs:{label:"番剧名称","label-width":"140"}},[a("el-input",{staticStyle:{width:"350px",display:"inherit"},attrs:{"auto-complete":"off"},model:{value:t.postBangumi.bangumiName,callback:function(e){t.$set(t.postBangumi,"bangumiName",e)},expression:"postBangumi.bangumiName"}})],1),a("el-form-item",{attrs:{label:"是否有第0集"}},[a("div",{staticStyle:{float:"left","margin-left":"20px"}},[a("el-radio-group",{attrs:{size:"small","text-color":"#141422"},model:{value:t.postBangumi.hasZeroIndex,callback:function(e){t.$set(t.postBangumi,"hasZeroIndex",e)},expression:"postBangumi.hasZeroIndex"}},[a("el-radio",{attrs:{border:"",label:0}},[t._v("没有")]),a("el-radio",{attrs:{border:"",label:1}},[t._v("有")])],1)],1)]),a("el-form-item",{staticStyle:{"margin-bottom":"0"}},[a("div",{staticClass:"explain-container"},[a("span",[t._v("* 若剧场版或电影则集数为「1」")]),a("br")])]),a("el-form-item",{attrs:{label:"总集数","label-width":"120"}},[a("el-input",{staticStyle:{width:"80px",display:"inherit"},attrs:{type:"text"},model:{value:t.postBangumi.episodeTotal,callback:function(e){t.$set(t.postBangumi,"episodeTotal",e)},expression:"postBangumi.episodeTotal"}})],1),a("el-form-item",{attrs:{label:"封面"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.postBangumi.thumb,expression:"postBangumi.thumb"}],attrs:{type:"hidden"},domProps:{value:t.postBangumi.thumb},on:{input:function(e){e.target.composing||t.$set(t.postBangumi,"thumb",e.target.value)}}}),a("el-button",{staticStyle:{float:"left",margin:"7px 0",border:"none"},attrs:{type:"primary",size:"mini"},on:{click:function(e){t.show=!0}}},[t._v("上传封面")])],1),a("el-form-item",[a("img",{directives:[{name:"show",rawName:"v-show",value:t.postBangumi.thumb,expression:"postBangumi.thumb"}],staticStyle:{"border-radius":"5px"},attrs:{src:t.postBangumi.thumb,alt:"加载不出来呢",width:"100%"}})]),a("el-form-item",{staticStyle:{"margin-bottom":"0"}},[a("div",{staticClass:"explain-container"},[a("span",[a("strong",[t._v("* 若本次提交被收录后封面仍可修改 *")])]),a("br")])])],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"cancel-btn",attrs:{size:"small"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消\n        ")]),a("el-button",{staticClass:"submit-btn",attrs:{type:"primary",size:"small"},on:{click:t.sendPostBangumiInfo}},[t._v("确 定")])],1)],1),a("my-upload",{attrs:{field:"image",width:620,height:350,noCircle:!0,url:t.GLOBAL.uploadURL,headers:t.GLOBAL.uploadHEADERS,langExt:t.langExtObj,"img-format":"jpg"},on:{"crop-success":t.cropSuccess,"crop-upload-success":t.cropUploadSuccess,"crop-upload-fail":t.cropUploadFail},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}})],1)],1)},[],!1,null,"74c43384",null).exports),ca={name:"BangumiDetail",data:function(){return{episodes:"",page:"",bangumi:"",blurImageStyle:""}},methods:{initEpisodes:(ce=Object(r.a)(regeneratorRuntime.mark(function t(e){var a,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,G(e);case 2:a=t.sent,0===(i=a.data).code&&(this.episodes=i.data.episodes,this.page=i.data.page);case 6:case"end":return t.stop()}},t,this)})),function(t){return ce.apply(this,arguments)}),initBangumi:(oe=Object(r.a)(regeneratorRuntime.mark(function t(e){var a,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,Z(e);case 3:a=t.sent,0===(i=a.data).code&&(this.bangumi=i.data,this.blurImageStyle={"background-image":"url("+i.data.thumb+")"});case 7:case"end":return t.stop()}},t,this)})),function(t){return oe.apply(this,arguments)})},created:function(){var t=this.$route.params.bid;this.$route.params.bangumi,t&&(this.initBangumi(t),this.initEpisodes(t))}},la=(a("Ehod"),a("/2vu"),Object(X.a)(ca,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"bangumi-detail"},[a("div",{staticClass:"bangumi-bg-wrap"},[a("div",{staticClass:"bangumi-bg-blur"},[a("div",{staticClass:"bangumi-bg-blur-img",style:t.blurImageStyle})])]),a("div",{staticClass:"bangumi-top"},[a("div",{staticClass:"top-inner"},[a("div",{staticClass:"bangumi-name"},[a("span",[t._v(t._s(t.bangumi.bangumiName))])]),a("div",{staticClass:"bangumi-thumb"},[a("img",{attrs:{src:t.bangumi.thumb}})])])]),a("div",{staticClass:"bangumi-bottom"},[a("div",{staticClass:"bottom-inner"},[a("div",{staticClass:"bangumi-episodes"},t._l(t.episodes,function(e){return a("a",{staticClass:"episode-link",attrs:{target:"_blank",href:"#/video/"+e.epId}},[t._v("\n          "+t._s(e.epIndex)+"\n        ")])}))])])])},[],!1,null,"6f84b60f",null).exports),ua={name:"Announce",data:function(){return{notice:""}},filters:{formatDate:function(t){return yt(new Date(t),"yyyy-MM-dd hh:mm")}},methods:{initNotice:(le=Object(r.a)(regeneratorRuntime.mark(function t(e){var a,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,q(e);case 2:a=t.sent,0===(i=a.data).code&&(this.notice=i.data);case 5:case"end":return t.stop()}},t,this)})),function(t){return le.apply(this,arguments)})},created:function(){var t=this.$route.params.id;t&&this.initNotice(t)}},pa=(a("sJJX"),a("OPwn"),Object(X.a)(ua,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"announce"},[a("div",{staticClass:"page-container"},[a("div",{staticClass:"title-container"},[a("h1",[t._v(t._s(t.notice.title))]),a("div",[a("span",[a("i",{staticClass:"el-icon-date",staticStyle:{"padding-right":"5px"},attrs:{title:"发布时间"}}),t._v(t._s(t._f("formatDate")(t.notice.createTime)))]),a("span",{staticStyle:{"margin-left":"15px"}},[a("i",{staticClass:"el-icon-view",staticStyle:{"padding-right":"5px"},attrs:{title:"阅读量"}}),t._v(t._s(t.notice.viewCount))])])]),a("div",{staticClass:"content-container"},[a("div",{staticClass:"ctx-text",domProps:{innerHTML:t._s(t.notice.content)}})]),a("div",{staticClass:"comment-container"}),a("div",{staticClass:"bottom-container"})])])},[],!1,null,"a5e0e4e8",null).exports);i.default.use(aa.a);var da=[{path:"/",name:"HelloWorld",component:tt},{path:"/video",name:"video",component:Ie},{path:"/register",name:"register",component:Re},{path:"/login",name:"login",component:Ke},{path:"/video/:epid",name:"videor",component:Ie},{path:"/vemail",name:"vemail",component:Xe},{path:"/user/:uid",name:"user",component:Qe},{path:"/bdtl/:bid",name:"bangumidetail",component:la},{path:"/announce/:id",name:"announce",component:pa},{path:"/space",component:Ue,name:"space",children:[{path:"avatar",component:Be,name:"avatar"},{path:"personal",component:Ne,name:"personal"},{path:"security",component:Oe,name:"security"},{path:"postBangumi",component:oa,name:"postBangumi"}]},{path:"/message",component:We,name:"message",children:[{path:"snotice",component:Pe,name:"snotice"},{path:"rnotice",component:Ae,name:"rnotice"},{path:"anotice",component:Fe,name:"anotice"},{path:"lnotice",component:sa,name:"lnotice"}]}],ma=new aa.a({routes:da}),ha={uploadURL:"imgur-api/3/image",imgURL:"imgur",uploadHEADERS:{Authorization:"Client-ID 3855bbe9883a511"}},ga=a("AoTc"),fa=a.n(ga);i.default.config.productionTip=!1,i.default.use(n.a),i.default.prototype.tap=function(t){return t},i.default.use(fa.a,{id:"UA-122809613-1",router:ma}),i.default.prototype.GLOBAL=ha,new i.default({render:function(t){return t(ea)},router:ma}).$mount("#app")},"Wi+7":function(t,e,a){},XOEp:function(t,e,a){"use strict";var i=a("sgIC");a.n(i).a},Xxua:function(t,e,a){},YKnW:function(t,e,a){"use strict";var i=a("nSgl");a.n(i).a},Yavw:function(t,e,a){"use strict";var i=a("lRNN");a.n(i).a},ZL7j:function(t,e,a){"use strict";var i=a("bP1M");a.n(i).a},bP1M:function(t,e,a){},"bW/s":function(t,e,a){},bp7G:function(t,e,a){},cIwn:function(t,e,a){},cSy8:function(t,e,a){"use strict";var i=a("nO0U");a.n(i).a},fGVc:function(t,e,a){},fKhJ:function(t,e,a){"use strict";var i=a("fGVc");a.n(i).a},g5eD:function(t,e,a){},"gCL+":function(t,e,a){},gN2b:function(t,e,a){"use strict";var i=a("kDLa");a.n(i).a},"gc/w":function(t,e,a){"use strict";var i=a("3LyO");a.n(i).a},"h/34":function(t,e,a){"use strict";var i=a("g5eD");a.n(i).a},i20A:function(t,e,a){},iDRx:function(t,e,a){},jd1T:function(t,e,a){},kDLa:function(t,e,a){},kSG2:function(t,e,a){},kYI5:function(t,e,a){},lRNN:function(t,e,a){},lmhV:function(t,e,a){"use strict";var i=a("kYI5");a.n(i).a},lpWx:function(t,e,a){"use strict";var i=a("Xxua");a.n(i).a},lxyZ:function(t,e,a){},mDzO:function(t,e,a){},nO0U:function(t,e,a){},nSgl:function(t,e,a){},pF2d:function(t,e,a){"use strict";var i=a("KtVF");a.n(i).a},qxA7:function(t,e,a){},qyc5:function(t,e,a){"use strict";var i=a("RmXx");a.n(i).a},sJJX:function(t,e,a){"use strict";var i=a("MIgP");a.n(i).a},sWhz:function(t,e,a){"use strict";var i=a("lxyZ");a.n(i).a},sgIC:function(t,e,a){},t85p:function(t,e,a){},vQ27:function(t,e,a){"use strict";var i=a("5Pec");a.n(i).a},vWkq:function(t,e,a){"use strict";var i=a("Ky9A");a.n(i).a},wLoz:function(t,e,a){"use strict";var i=a("t85p");a.n(i).a},wO9Z:function(t,e,a){"use strict";var i=a("P24W");a.n(i).a},xFsN:function(t,e,a){"use strict";var i=a("Wi+7");a.n(i).a},y0k4:function(t,e,a){},ytDo:function(t,e,a){"use strict";var i=a("y0k4");a.n(i).a},zJsb:function(t,e,a){"use strict";var i=a("L0Vw");a.n(i).a},zdsn:function(t,e,a){"use strict";var i=a("mDzO");a.n(i).a},zfpp:function(t,e,a){"use strict";var i=a("HJDd");a.n(i).a},zn61:function(t,e,a){"use strict";var i=a("kSG2");a.n(i).a}});