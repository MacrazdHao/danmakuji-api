!function(e){function t(t){for(var n,r,o=t[0],c=t[1],u=t[2],m=0,p=[];m<o.length;m++)r=o[m],s[r]&&p.push(s[r][0]),s[r]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);for(l&&l(t);p.length;)p.shift()();return i.push.apply(i,u||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],n=!0,o=1;o<a.length;o++){var c=a[o];0!==s[c]&&(n=!1)}n&&(i.splice(t--,1),e=r(r.s=a[0]))}return e}var n={},s={1:0},i=[];function r(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=n,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var o=window.webpackJsonp=window.webpackJsonp||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var l=c;i.push([31,0]),a()}({"+mZH":function(e,t,a){},"+sf7":function(e,t,a){},"/t1F":function(e,t,a){},"0jeU":function(e,t,a){"use strict";var n=a("2i7R");a.n(n).a},"19Xi":function(e,t,a){},"2NF1":function(e,t,a){},"2i7R":function(e,t,a){},31:function(e,t,a){e.exports=a("Vtdi")},"3zFs":function(e,t,a){"use strict";var n=a("lu/m");a.n(n).a},"46K/":function(e,t,a){"use strict";var n=a("S+sB");a.n(n).a},"4foK":function(e,t,a){"use strict";var n=a("idlE");a.n(n).a},"4pXa":function(e,t,a){"use strict";var n=a("qO6A");a.n(n).a},"5voI":function(e,t,a){"use strict";var n=a("K+Tw");a.n(n).a},"6f9O":function(e,t,a){"use strict";var n=a("/t1F");a.n(n).a},"7akC":function(e,t,a){"use strict";var n=a("9VaN");a.n(n).a},"7oW/":function(e,t,a){},"9VaN":function(e,t,a){},A99O:function(e,t,a){"use strict";var n=a("K+RO");a.n(n).a},Am9v:function(e,t,a){},CnAV:function(e,t,a){},EDI0:function(e,t,a){},EnFz:function(e,t,a){"use strict";var n=a("U979");a.n(n).a},GI03:function(e,t,a){"use strict";var n=a("pV8X");a.n(n).a},GbT4:function(e,t,a){},H89L:function(e,t,a){"use strict";var n=a("m5OW");a.n(n).a},J08L:function(e,t,a){},JOII:function(e,t,a){"use strict";var n=a("GbT4");a.n(n).a},"K+RO":function(e,t,a){},"K+Tw":function(e,t,a){},K1iC:function(e,t,a){"use strict";var n=a("PENP");a.n(n).a},LNHh:function(e,t,a){"use strict";var n=a("hAJP");a.n(n).a},NxvS:function(e,t,a){"use strict";var n=a("Am9v");a.n(n).a},PENP:function(e,t,a){},Ppry:function(e,t,a){"use strict";var n=a("7oW/");a.n(n).a},"S+sB":function(e,t,a){},U979:function(e,t,a){},Vtdi:function(e,t,a){"use strict";a.r(t),a("VRzm");var n=a("Kw5r"),s=a("XJYT"),i=a.n(s),r=(a("D66Q"),a("vDqi")),o=a.n(r);o.a.interceptors.request.use(function(e){return localStorage.getItem("token")&&(e.headers.Authorization=localStorage.getItem("token")),e},function(e){return Promise.reject(e)}),o.a.interceptors.response.use(function(e){return e},function(e){if(e&&e.response){switch(e.response.status){case 403:e.message=e.response.data.msg;break;case 404:e.message="请求地址出错: ".concat(e.response.config.url);break;case 408:e.message="请求超时";break;case 500:e.message="服务器内部错误";break;default:e.message=e.response.data.msg}n.default.prototype.$message({message:e.message,type:"error"})}return Promise.reject(e)});var c,u,l=function(e){return o.a.post("".concat("","/auth/login"),e)},m=function(){return o.a.get("".concat("","/auth/logout"))},p=function(e,t){return o.a.get("".concat("","/replies"),{params:{epId:e,pn:t}})},d=function(){return o.a.get("".concat("","/admin/mainInfo"))},g=function(e,t){return o.a.get("".concat("","/admin/users"),{params:{pn:e,ps:t}})},f=function(e){return o.a.get("".concat("","/admin/users/").concat(e))},h=function(e,t,a){return o.a.get("".concat("","/admin/users/nick"),{params:{nick:e,pn:t,ps:a}})},v=function(e){return o.a.delete("".concat("","/admin/users/").concat(e))},b=function(e,t){return o.a.put("".concat("","/admin/users/").concat(e,"/lock/1/").concat(t))},y=function(e){return o.a.put("".concat("","/admin/users/").concat(e,"/lock/0"))},w=function(e,t,a){return o.a.put("".concat("","/admin/users/").concat(e,"/role/").concat(t),{pwd:a})},x=function(e,t){return o.a.get("".concat("","/admin/bangumis"),{params:{pageNum:e,pageSize:t}})},_=function(e,t,a){return o.a.get("".concat("","/admin/bangumis"),{params:{bangumiName:e,pageNum:t,pageSize:a}})},C=function(e){return o.a.get("".concat("","/admin/bangumis/").concat(e))},k=function(e){return o.a.post("".concat("","/admin/bangumis"),e)},I=function(e,t){return o.a.put("".concat("","/admin/bangumis/").concat(e),t)},R=function(e){return o.a.delete("".concat("","/admin/bangumis/").concat(e))},S=function(e){return o.a.delete("".concat("","/admin/bangumis"),{data:{bangumis:e}})},O=function(e,t,a){return o.a.get("".concat("","/admin/episodes/bid/").concat(e),{params:{pageNum:t,pageSize:a}})},$=function(e){return o.a.delete("".concat("","/admin/episodes/").concat(e))},E=function(e,t,a){return o.a.get("".concat("","/admin/videos"),{params:{isMatch:e,pageNum:t,pageSize:a}})},j=function(e,t,a){return o.a.get("".concat("","/admin/videos/eid/").concat(e),{params:{pageNum:t,pageSize:a}})},B=function(e,t){return o.a.put("".concat("","/admin/videos/").concat(e),t)},L=function(e){return o.a.delete("".concat("","/admin/videos/").concat(e))},U=function(e,t){return o.a.get("".concat("","/admin/postBangumis"),{params:{pn:e,ps:t}})},z=function(e){return o.a.get("".concat("","/admin/postBangumis"),{params:e})},A=function(e){return o.a.put("".concat("","/admin/postBangumis/").concat(e),{type:1})},T=function(e,t,a){return o.a.put("".concat("","/admin/postBangumis/").concat(e),{type:t,msg:a})},N=function(e){return o.a.get("".concat("","/admin/notices"),{params:{pn:e}})},D=function(e){return o.a.post("".concat("","/admin/notices"),e)},P=function(e){return o.a.put("".concat("","/admin/notices"),e)},M=function(e){return o.a.delete("".concat("","/admin/notices/").concat(e))},q=function(e){return o.a.get("".concat("").concat(e))},F=function(e,t,a){return o.a.get("".concat("","/admin/online"),{params:{t:a,pn:e,ps:t}})},V=(a("tUrg"),a("ls82"),a("MECJ")),G={name:"ApiTest",data:function(){return{epId:15,pn:1,jsonResult:"",options:{maxDepth:2,rootObjectKey:"replies",modifiable:!1},imgurl:"",imgResult:"",myURL:"",myResult:""}},methods:{getReplyJson:(u=Object(V.a)(regeneratorRuntime.mark(function e(){var t,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.epId&&this.pn){e.next=3;break}return this.$message({message:"参数有误",type:"error"}),e.abrupt("return");case 3:return e.next=5,p(this.epId,this.pn);case 5:t=e.sent,a=t.data,this.jsonResult=a;case 9:case"end":return e.stop()}},e,this)})),function(){return u.apply(this,arguments)}),handleChange:function(e){},handleAvatarSuccess:function(e,t){this.imgResult=e.data,this.imgurl=e.data.link},beforeAvatarUpload:function(e){var t=e.size/1024/1024<4;return t||this.$message.error("上传头像图片大小不能超过 4MB!"),t},sendRequest:(c=Object(V.a)(regeneratorRuntime.mark(function e(){var t,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==this.myURL){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,q(this.myURL);case 4:t=e.sent,0===(a=t.data).code&&(this.myResult=a.data);case 7:case"end":return e.stop()}},e,this)})),function(){return c.apply(this,arguments)})}},J=(a("EnFz"),a("LNHh"),a("KHd+")),H=Object(J.a)(G,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"api-test"},[a("el-collapse",{on:{change:e.handleChange}},[a("el-collapse-item",{attrs:{title:"replies",name:"1"}},[a("div",{staticClass:"rpy-json"},[a("div",{staticClass:"rpy-input"},[a("span",[e._v("episode id")]),a("el-input",{staticStyle:{width:"100px"},attrs:{size:"small"},model:{value:e.epId,callback:function(t){e.epId=t},expression:"epId"}})],1),a("div",{staticClass:"rpy-input"},[a("span",[e._v("page number")]),a("el-input",{staticStyle:{width:"100px"},attrs:{size:"small"},model:{value:e.pn,callback:function(t){e.pn=t},expression:"pn"}})],1),a("el-button",{attrs:{type:"primary"},on:{click:e.getReplyJson}},[e._v("获取replies")]),e.jsonResult?a("div",{staticClass:"content"},[a("tree-view",{attrs:{data:e.jsonResult,options:e.options}})],1):e._e()],1)])],1),a("div",{staticClass:"img-api"},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"https://api.imgur.com/3/image",headers:e.GLOBAL.uploadHEADERS,name:"image","show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[a("img",{directives:[{name:"show",rawName:"v-show",value:e.imgurl,expression:"imgurl"}],staticClass:"upload-img",attrs:{src:e.imgurl}}),a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),a("tree-view",{attrs:{data:e.imgResult}})],1),a("div",{staticStyle:{"margin-top":"100px"}},[a("el-input",{model:{value:e.myURL,callback:function(t){e.myURL=t},expression:"myURL"}}),a("el-button",{on:{click:e.sendRequest}},[e._v("发送")]),a("tree-view",{attrs:{data:e.myResult}})],1)],1)},[],!1,null,"8fc03b1a",null).exports;function K(e,t){/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));var a={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds()};for(var n in a)if(new RegExp("(".concat(n,")")).test(t)){var s=a[n]+"";t=t.replace(RegExp.$1,1===RegExp.$1.length?s:Q(s))}return t}function Q(e){return("00"+e).substr(e.length)}a("Oyvg"),a("pIFo");var Z,X,Y,W,ee,te,ae,ne,se,ie,re,oe,ce,ue,le,me,pe,de,ge,fe,he,ve,be,ye,we,xe,_e,Ce,ke,Ie,Re={name:"UserList",data:function(){return{list:[],page:{},query:{nick:"",lastQuery:""},temp:{nick:"",email:"",phone:"",age:""},showAddUserDialog:!1,listLoading:!0,roles:[{text:"普通用户",value:"ROLE_USER"},{text:"管理员",value:"ROLE_ADMIN"},{text:"系统管理员",value:"ROLE_MANAGER"}],checkList:[]}},filters:{formatDate:function(e){return K(new Date(e),"yyyy-MM-dd hh:mm")}},mounted:function(){this.getUsersList()},methods:{test:function(){},getUsersList:(ae=Object(V.a)(regeneratorRuntime.mark(function e(){var t,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.listLoading=!0,this.$route.query,e.next=5,g(1,20);case 5:t=e.sent,0===(a=t.data).code?(this.list=a.data.users,this.page=a.data.page,this.query.lastQuery=""):this.$message({showClose:!0,message:a.msg,type:"error"}),this.listLoading=!1;case 11:case"end":return e.stop()}},e,this)})),function(){return ae.apply(this,arguments)}),resetForm:function(e){this.$refs[e].resetFields()},handleEdit:function(e,t){},handleDelete:(te=Object(V.a)(regeneratorRuntime.mark(function e(t,a){var n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.$confirm("删除用户："+a.nick,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",callback:function(){var e=Object(V.a)(regeneratorRuntime.mark(function e(s,i){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("confirm"!==s){e.next=9;break}return e.next=5,v(a.userId);case 5:0===(r=e.sent).data.code?(n.$message({showClose:!0,message:r.data.msg,type:"success"}),n.list.splice(t,1)):n.$message({showClose:!0,message:r.data.msg,type:"error"}),e.next=10;break;case 9:n.$message({showClose:!0,message:"已取消删除",type:"info"});case 10:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()});case 3:case"end":return e.stop()}},e,this)})),function(e,t){return te.apply(this,arguments)}),handleSearch:(ee=Object(V.a)(regeneratorRuntime.mark(function e(){var t,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==this.query.nick){e.next=4;break}return this.$message({showClose:!0,message:"请输入搜索内容",type:"info"}),e.abrupt("return");case 4:return e.next=6,h(this.query.nick,1,20);case 6:t=e.sent,0===(a=t.data).code?(this.list=a.data.users,this.page=a.data.page,this.query.lastQuery=this.query.nick,0===a.data.users.length&&this.$message({showClose:!0,message:"无搜索结果",type:"info"})):(this.list=[],this.page.totalSize=0,this.$message({showClose:!0,message:a.msg,type:"info"}));case 9:case"end":return e.stop()}},e,this)})),function(){return ee.apply(this,arguments)}),handleSizeChange:(W=Object(V.a)(regeneratorRuntime.mark(function e(t){var a,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""===this.query.lastQuery){e.next=7;break}return e.next=4,h(this.query.lastQuery,1,t);case 4:a=e.sent,e.next=10;break;case 7:return e.next=9,g(1,t);case 9:a=e.sent;case 10:0===(n=a.data).code?(this.list=n.data.users,this.page=n.data.page):this.$message({showClose:!0,message:n.msg,type:"error"});case 13:case"end":return e.stop()}},e,this)})),function(e){return W.apply(this,arguments)}),handleCurrentChange:(Y=Object(V.a)(regeneratorRuntime.mark(function e(t){var a,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""===this.query.lastQuery){e.next=7;break}return e.next=4,h(this.query.lastQuery,t,this.page.pageSize);case 4:a=e.sent,e.next=10;break;case 7:return e.next=9,g(t,this.page.pageSize);case 9:a=e.sent;case 10:0===(n=a.data).code?(this.list=n.data.users,this.page=n.data.page):this.$message({showClose:!0,message:n.msg,type:"error"});case 13:case"end":return e.stop()}},e,this)})),function(e){return Y.apply(this,arguments)}),handleAddUser:function(){},roleFilter:function(e,t){return t.role===e},sexFilter:function(e,t){return t.sex===e},lockUser:function(e){var t,a=this;this.$prompt("封禁时长：","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",callback:(t=Object(V.a)(regeneratorRuntime.mark(function t(n,s){var i,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("confirm"!==n){t.next=10;break}return t.next=4,b(e.userId,s.inputValue);case 4:i=t.sent,0===(r=i.data).code?(e.isLock=1,a.$message({showClose:!0,message:r.msg,type:"success"})):a.$message({showClose:!0,message:"封禁用户失败",type:"error"}),t.next=11;break;case 10:a.$message({showClose:!0,message:"已取消",type:"info"});case 11:case"end":return t.stop()}},t,this)})),function(e,a){return t.apply(this,arguments)})})},unlockUser:(X=Object(V.a)(regeneratorRuntime.mark(function e(t){var a,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,y(t.userId);case 3:a=e.sent,0===(n=a.data).code?(t.isLock=0,this.$message({showClose:!0,message:n.msg,type:"success"})):this.$message({showClose:!0,message:"解封用户失败",type:"error"});case 7:case"end":return e.stop()}},e,this)})),function(e){return X.apply(this,arguments)}),changeRole:(Z=Object(V.a)(regeneratorRuntime.mark(function e(t,a){var n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.$prompt("请输入密码","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",callback:function(){var e=Object(V.a)(regeneratorRuntime.mark(function e(s,i){var r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("confirm"!==s){e.next=11;break}return e.next=4,w(t.userId,a,i.inputValue);case 4:r=e.sent,0===(o=r.data).code?(t.role=0===a?"ROLE_USER":1===a?"ROLE_MANAGER":"ROLE_ADMIN",n.$message({showClose:!0,message:o.msg,type:"success"})):n.$message({showClose:!0,message:o.msg,type:"error"}),n.$message({showClose:!0,message:o.msg,type:"success"}),e.next=12;break;case 11:n.$message({showClose:!0,message:"已取消",type:"info"});case 12:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()});case 3:case"end":return e.stop()}},e,this)})),function(e,t){return Z.apply(this,arguments)})}},Se=(a("NxvS"),Object(J.a)(Re,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"user-container"},[a("div",{staticClass:"filter-container"},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"用户昵称"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.handleSearch(t):null}},model:{value:e.query.nick,callback:function(t){e.$set(e.query,"nick",t)},expression:"query.nick"}}),a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{circle:"",type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch}}),a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-edit"},on:{click:function(t){e.showAddUserDialog=!0}}},[e._v("添加")]),a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-delete"}},[e._v("批量删除")]),a("el-button",{staticClass:"filter-item",attrs:{type:"primary"},on:{click:e.getUsersList}},[e._v("显示有用户")])],1),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{height:"600",data:e.list,"element-loading-text":"loading...",border:"","highlight-current-row":""}},[a("el-table-column",{attrs:{type:"selection",width:"35"}}),a("el-table-column",{attrs:{label:"用户名",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"nick-link"},[a("el-popover",{attrs:{placement:"top-start",width:"200",trigger:"hover"}},[a("div",{staticClass:"short-user-info"},[a("div",{staticClass:"u-avatar-wrapper"},[a("img",{staticClass:"u-avatar-img",attrs:{src:t.row.face?t.row.face:"/static/akari.jpg"}})]),a("div",{staticClass:"u-other-info"},[a("span",{staticClass:"user-nick-link"},[a("a",{attrs:{target:"_blank",href:"#/home/userdetail/"+t.row.userId}},[e._v("\n                  "+e._s(t.row.nick)+"\n                ")])]),a("span",[e._v("\n                "+e._s(t.row.sex)+"\n              ")]),a("span",[e._v("\n                "+e._s(t.row.age)+"\n              ")]),a("span",[e._v("\n                "+e._s(t.row.role)+"\n              ")])])]),a("a",{attrs:{slot:"reference",target:"_blank",href:"#/home/userdetail/"+t.row.userId},slot:"reference"},[e._v("\n            "+e._s(t.row.nick)+"\n          ")])])],1)]}}])}),a("el-table-column",{attrs:{prop:"role",filters:e.roles,"filter-method":e.roleFilter,label:"角色",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return["ROLE_USER"===t.row.role?a("el-button",{attrs:{type:"success",size:"small"},on:{click:function(a){e.changeRole(t.row,1)}}},[e._v("提升为管理员")]):e._e(),"ROLE_MANAGER"===t.row.role?a("el-button",{attrs:{type:"info",size:"small"},on:{click:function(a){e.changeRole(t.row,2)}}},[e._v("提升为系统管理员")]):e._e(),"ROLE_ADMIN"===t.row.role?a("el-button",{attrs:{type:"warning",size:"small"},on:{click:function(a){e.changeRole(t.row,0)}}},[e._v("撤销管理员")]):e._e()]}}])}),a("el-table-column",{attrs:{align:"center",label:"注册时间",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("formatDate")(t.row.createTime)))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"邮箱",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.email))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"锁定",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(1===t.row.isLock?"是":"否"))]),1===t.row.isLock?a("el-button",{attrs:{type:"success",size:"small"},on:{click:function(a){e.unlockUser(t.row)}}},[e._v("解封")]):e._e(),0===t.row.isLock?a("el-button",{attrs:{type:"warning",size:"small"},on:{click:function(a){e.lockUser(t.row)}}},[e._v("封禁")]):e._e()]}}])}),a("el-table-column",{attrs:{align:"center",label:"解除锁定日期",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("formatDate")(t.row.lockTime)))])]}}])}),a("el-table-column",{attrs:{prop:"sex",filters:[{text:"男",value:"男"},{text:"女",value:"女"},{text:"不明",value:"不明"}],"filter-method":e.sexFilter,align:"center",label:"性别",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.sex))])]}}])}),a("el-table-column",{attrs:{label:"年龄",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n      "+e._s(t.age)+"\n    ")]}}])}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(a){e.handleEdit(t.row.userId,t.row)}}}),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){e.handleDelete(t.$index,t.row)}}})]}}])})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.listLoading,expression:"!listLoading"}],staticClass:"pagination-container"},[a("el-pagination",{attrs:{"current-page":e.page.pageNumber,"page-sizes":[10,20,30,50],"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.page.totalSize},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.$set(e.page,"pageNumber",t)}}})],1),a("el-dialog",{attrs:{title:"添加用户",visible:e.showAddUserDialog},on:{"update:visible":function(t){e.showAddUserDialog=t}}},[a("el-form",{staticClass:"small-space",staticStyle:{width:"400px","margin-left":"50px"},attrs:{model:e.temp,"label-position":"left","label-width":"70px"}},[a("el-form-item",{attrs:{label:"昵称"}},[a("el-input",{model:{value:e.temp.nick,callback:function(t){e.$set(e.temp,"nick",t)},expression:"temp.nick"}})],1),a("el-form-item",{attrs:{label:"邮箱"}},[a("el-input",{model:{value:e.temp.email,callback:function(t){e.$set(e.temp,"email",t)},expression:"temp.email"}})],1),a("el-form-item",{attrs:{label:"电话"}},[a("el-input",{model:{value:e.temp.phone,callback:function(t){e.$set(e.temp,"phone",t)},expression:"temp.phone"}})],1),a("el-form-item",{attrs:{label:"年龄"}},[a("el-input",{model:{value:e.temp.age,callback:function(t){e.$set(e.temp,"age",t)},expression:"temp.age"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.showAddUserDialog=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleAddUser}},[e._v("确 定")])],1)],1)],1)},[],!1,null,"7df59895",null).exports),Oe={data:function(){return{activeIndex:"0",userInfo:{uid:"",nick:"",face:"",role:""}}},components:{ApiTest:H,UserList:Se},methods:{logout:function(){var e=!1;localStorage.getItem("token")&&(e=!0),e&&m(),localStorage.clear(),window.location.href="#/login"}},created:function(){this.userInfo.uid=localStorage.getItem("uid"),this.userInfo.nick=localStorage.getItem("nick"),this.userInfo.face=localStorage.getItem("face"),this.userInfo.role=localStorage.getItem("role")}},$e=(a("3zFs"),Object(J.a)(Oe,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"home"}},[a("el-container",{staticStyle:{"z-index":"1000",position:"fixed",height:"60px","background-color":"transparent",width:"100%",right:"0",top:"0"}},[a("el-header",{staticStyle:{"background-color":"rgba(20,20,34,0.9)","text-align":"right","font-size":"12px"}},[a("el-dropdown",[a("div",{staticClass:"avatar-wrapper"},[a("img",{staticClass:"avatar",attrs:{src:e.userInfo.face?e.userInfo.face:"/static/akari.jpg"}})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[e._v(e._s(e.userInfo.nick))]),a("div",{on:{click:e.logout}},[a("el-dropdown-item",[e._v("登出")])],1)],1)],1)],1)],1),a("el-container",{staticStyle:{"margin-top":"60px"}},[a("el-aside",{staticStyle:{"margin-right":"20px"},attrs:{width:"200px"}},[a("el-menu",{attrs:{"background-color":"#262633","text-color":"#f9efc1",router:!0,"active-text-color":"#d8c13a","default-active":e.activeIndex}},[a("el-menu-item",{attrs:{route:{path:"/home/index"},index:"0"}},[e._v("\n          DARKER后台首页\n        ")]),a("el-submenu",{attrs:{index:"1"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-message"}),e._v("番剧管理")]),a("el-menu-item",{attrs:{route:{path:"/home/bangumi"},index:"1-1"}},[e._v("番剧列表")]),a("el-menu-item",{attrs:{route:{path:"/home/bangumiedit"},index:"#"}},[e._v("新增番剧")]),a("el-menu-item",{attrs:{route:{path:"/home/bangumi/userpost"},index:"1-3"}},[e._v("提交列表")])],2),a("el-submenu",{attrs:{index:"2"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-message"}),e._v("剧集管理")]),a("el-menu-item",{attrs:{route:{path:"/home/episode"},index:"2-1"}},[e._v("剧集列表")]),a("el-menu-item",{attrs:{index:"#"}},[e._v("新增剧集")])],2),a("el-submenu",{attrs:{index:"3"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-message"}),e._v("视频管理")]),a("el-menu-item",{attrs:{route:{path:"/home/video"},index:"3-1"}},[e._v("视频列表")]),a("el-menu-item",{attrs:{route:{path:"/home/video/userpost"},index:"3-2"}},[e._v("提交列表")]),a("el-menu-item",{attrs:{index:"#"}},[e._v("新增视频")])],2),a("el-submenu",{attrs:{index:"4"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-message"}),e._v("弹幕管理")]),a("el-menu-item",{attrs:{route:{path:"/home/danmaku"},index:"4-1"}},[e._v("弹幕列表")]),a("el-menu-item",{attrs:{index:"#"}},[e._v("被举报弹幕")]),a("el-menu-item",{attrs:{index:"#"}},[e._v("弹幕过滤规则")])],2),a("el-submenu",{attrs:{index:"5"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-message"}),e._v("用户管理")]),a("el-menu-item",{attrs:{route:{path:"/home/user"},index:"5-1"}},[e._v("用户列表")]),a("el-menu-item",{attrs:{index:"#"}},[e._v("锁定用户")])],2),a("el-submenu",{attrs:{index:"6"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-message"}),e._v("公告管理")]),a("el-menu-item",{attrs:{route:{path:"/home/announce"},index:"6-1"}},[e._v("公告列表")]),a("el-menu-item",{attrs:{route:{path:"/home/announce/new"},index:"6-2"}},[e._v("新增公告")])],2),a("el-menu-item",{attrs:{route:{path:"/home/apitest"},index:"7"}},[e._v("\n          API JSON数据展示\n        ")])],1)],1),a("el-container",[a("el-main",{staticStyle:{"background-color":"#262633"}},[a("router-view")],1)],1)],1)],1)},[],!1,null,"5ed4725e",null).exports),Ee={name:"app",components:{Home:$e},data:function(){return{isLogin:!1}}},je=(a("ZL7j"),Object(J.a)(Ee,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},[],!1,null,null,null).exports),Be=a("jE9Z"),Le={data:function(){return{loginInfo:{principal:"",password:"",remember_me:0}}},methods:{login:(ne=Object(V.a)(regeneratorRuntime.mark(function e(){var t,a,n,s,i,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==this.loginInfo.principal&&""!==this.loginInfo.password){e.next=3;break}return this.$message({message:"账号或密码为空",type:"info"}),e.abrupt("return",!1);case 3:return e.next=5,l(this.loginInfo);case 5:if(t=e.sent,a=t.data,n="",s="",i="",r="",o="",2002!==a.code&&null!=a.data){e.next=16;break}return this.$message({message:"账号不存在或密码错误",type:"error"}),e.abrupt("return",!1);case 16:if(0!==a.code&&"OK"!==a.msg){e.next=27;break}if(s=a.data.token,o=a.data.user.nick,n=a.data.user.uid,i=a.data.user.face,"ROLE_USER"!==(r=a.data.user.role)){e.next=26;break}return this.$message({message:"该用户没有权限",type:"error"}),window.location.href="#/login",e.abrupt("return");case 26:s||this.$message({message:"无法获取到Token",type:"error"});case 27:this.checkLocalStorage()&&(localStorage.setItem("uid",n),localStorage.setItem("token",s),localStorage.setItem("nick",o),localStorage.setItem("face",i),localStorage.setItem("role",r),window.location.href="#/home/index");case 28:case"end":return e.stop()}},e,this)})),function(){return ne.apply(this,arguments)}),checkLocalStorage:function(){return void 0!==window.localStorage||(this.$message({message:"请关闭隐私模式,或者浏览器太老旧了,否则无法保存登录状态",type:"warning"}),!1)}}},Ue=(a("cP/g"),Object(J.a)(Le,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"loginctx",staticClass:"login-container"},[a("div",{staticClass:"login-box"},[a("h1",[e._v("LOGIN")]),a("div",{staticClass:"login-form"},[a("el-form",{ref:"Login",staticStyle:{"margin-left":"0","margin-right":"0"},attrs:{size:"small","label-position":"left","label-width":"40px",model:e.loginInfo}},[a("el-form-item",{attrs:{label:"账户"}},[a("el-input",{model:{value:e.loginInfo.principal,callback:function(t){e.$set(e.loginInfo,"principal",t)},expression:"loginInfo.principal"}})],1),a("el-form-item",{attrs:{label:"密钥"}},[a("el-input",{attrs:{type:"password"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.login(t):null}},model:{value:e.loginInfo.password,callback:function(t){e.$set(e.loginInfo,"password",t)},expression:"loginInfo.password"}})],1),a("el-form-item",{staticStyle:{"text-align":"left"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.login}},[e._v("登入")])],1)],1)],1)])])},[],!1,null,"3007fdfe",null).exports),ze={name:"Index",data:function(){return{sysInfo:""}},methods:{initSystemInfo:(se=Object(V.a)(regeneratorRuntime.mark(function e(){var t,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d();case 2:t=e.sent,a=t.data,this.sysInfo=a.data;case 6:case"end":return e.stop()}},e,this)})),function(){return se.apply(this,arguments)}),getOnlineUsers:function(){this.$router.push({name:"onlineuser"})},getTodayOnlineUsers:function(){this.$router.push({name:"onlineuser",params:{today:"today"}})}},created:function(){this.initSystemInfo()}},Ae=(a("K1iC"),a("JOII"),Object(J.a)(ze,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"index"},[a("div",{staticClass:"main-info"},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("在线用户")])]),a("div",{staticClass:"text item"},[a("a",{attrs:{href:"javascript:void(0);"},on:{click:e.getOnlineUsers}},[e._v(e._s(e.sysInfo.authOnline))])])]),a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("在线游客")])]),a("div",{staticClass:"text item"},[e._v("\n        "+e._s(e.sysInfo.anonOnline)+"\n      ")])]),a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("当前在线人数")])]),a("div",{staticClass:"text item"},[e._v("\n        "+e._s(e.sysInfo.totalOnline)+"\n      ")])]),a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("今日注册用户")])]),a("div",{staticClass:"text item"},[e._v("\n        "+e._s(e.sysInfo.newUsers)+"\n      ")])]),a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("用户总数")])]),a("div",{staticClass:"text item"},[e._v("\n        "+e._s(e.sysInfo.totalUsers)+"\n      ")])]),a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("游客总数")])]),a("div",{staticClass:"text item"},[e._v("\n        "+e._s(e.sysInfo.totalVisitors)+"\n      ")])]),a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("今日在线用户")])]),a("div",{staticClass:"text item"},[a("a",{attrs:{href:"javascript:void(0);"},on:{click:e.getTodayOnlineUsers}},[e._v(e._s(e.sysInfo.maxAuthOnline))])])]),a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("今日评论")])]),a("div",{staticClass:"text item"},[e._v("\n        "+e._s(e.sysInfo.newReplies)+"\n      ")])]),a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("今日在线游客")])]),a("div",{staticClass:"text item"},[e._v("\n        "+e._s(e.sysInfo.maxAnonOnline)+"\n      ")])]),a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("访问量")])]),a("div",{staticClass:"text item"},[e._v("\n        "+e._s(e.sysInfo.visit)+"\n      ")])])],1)])},[],!1,null,"1e58e174",null).exports),Te=function(e){var t=new Date(e),a=function(e){return e<10?"0"+e:e};return t.getFullYear()+"/"+a(t.getMonth()+1)+"/"+a(t.getDate())+" "+a(t.getHours())+":"+a(t.getMinutes())+":"+a(t.getSeconds())},Ne={name:"UserDetail",data:function(){return{userInfo:{},tmpUserInfo:{},edit:!1,sexOptions:[{value:"男",label:"男"},{value:"女",label:"女"},{value:"不明",label:"不明"}]}},methods:{getUserDetail:(ie=Object(V.a)(regeneratorRuntime.mark(function e(t){var a,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f(t);case 2:a=e.sent,0===(n=a.data).code?this.userInfo=n.data:this.$message({message:n.msg,type:"error"});case 6:case"end":return e.stop()}},e,this)})),function(e){return ie.apply(this,arguments)}),formateDate:function(e){return Te(e)},handleAvatarSuccess:function(e,t){var a=e.data.link;a=a.substring(a.lastIndexOf("/")),this.userInfo.face=this.GLOBAL.imgURL+a},beforeAvatarUpload:function(e){var t=e.size/1024/1024<2;return t||this.$message.error("上传头像图片大小不能超过 2MB!"),t},handleEdit:function(){this.edit=!0,this.tmpUserInfo=JSON.parse(JSON.stringify(this.userInfo))},handleSaveUserInfo:function(){this.userInfo=JSON.parse(JSON.stringify(this.tmpUserInfo)),this.edit=!1},handleDiscardUserInfo:function(){this.edit=!1}},created:function(){var e=this.$route.params.uid;e&&this.getUserDetail(e)}},De=(a("4foK"),Object(J.a)(Ne,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"user-detail"},[a("div",{staticClass:"user-avatar-container"},[a("div",{staticClass:"user-avatar-wrapper"},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.GLOBAL.uploadURL,name:"image",headers:e.GLOBAL.uploadHEADERS,"show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[a("img",{staticClass:"user-avatar-img",attrs:{src:e.userInfo.face?e.userInfo.face:"/static/akari.jpg"}})])],1)]),a("div",{staticClass:"user-other-info"},[e.edit?a("div",{staticClass:"edit-user"},[a("i",{staticClass:"el-icon-success save-icon",staticStyle:{"margin-right":"5px"},on:{click:e.handleSaveUserInfo}}),a("i",{staticClass:"el-icon-error discard-icon",on:{click:e.handleDiscardUserInfo}})]):a("div",{staticClass:"edit-user",on:{click:e.handleEdit}},[a("i",{staticClass:"el-icon-edit edit-icon"})]),a("div",{staticClass:"user-info-item"},[a("div",{staticClass:"user-id"},[a("p",[e._v("用户id："+e._s(e.userInfo.userId))])])]),a("div",{staticClass:"user-info-item"},[a("div",{staticClass:"user-nick"},[e.edit?a("p",[e._v("\n          昵称："),a("el-input",{staticStyle:{width:"200px"},attrs:{size:"mini"},model:{value:e.tmpUserInfo.nick,callback:function(t){e.$set(e.tmpUserInfo,"nick",t)},expression:"tmpUserInfo.nick"}})],1):a("p",[e._v("昵称："+e._s(e.userInfo.nick))])])]),a("div",{staticClass:"user-info-item"},[a("div",{staticClass:"user-sex"},[e.edit?a("p",[e._v("\n          性别：\n          "),a("el-select",{staticStyle:{width:"100px"},attrs:{size:"mini"},model:{value:e.tmpUserInfo.sex,callback:function(t){e.$set(e.tmpUserInfo,"sex",t)},expression:"tmpUserInfo.sex"}},e._l(e.sexOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1):a("p",[e._v("性别："+e._s(e.userInfo.sex))])])]),a("div",{staticClass:"user-info-item"},[a("div",{staticClass:"user-age"},[e.edit?a("p",[e._v("\n          年龄："),a("el-input",{staticStyle:{width:"100px"},attrs:{size:"mini"},model:{value:e.tmpUserInfo.age,callback:function(t){e.$set(e.tmpUserInfo,"age",t)},expression:"tmpUserInfo.age"}})],1):a("p",[e._v("年龄："+e._s(e.userInfo.age))])])]),a("div",{staticClass:"user-info-item"},[a("div",{staticClass:"user-role"},[a("p",[e._v("角色："+e._s(e.userInfo.role))])])]),a("div",{staticClass:"user-info-item"},[a("div",{staticClass:"user-email"},[a("p",[e._v("邮箱："+e._s(e.userInfo.email))])])]),a("div",{staticClass:"user-info-item"},[a("div",{staticClass:"user-email-v"},[a("p",[e._v("邮箱已验证："+e._s(e.userInfo.emailVerified))])])]),a("div",{staticClass:"user-info-item"},[a("div",{staticClass:"user-phone"},[a("p",[e._v("手机号："+e._s(e.userInfo.phone))])])]),a("div",{staticClass:"user-info-item"},[a("div",{staticClass:"user-phone-v"},[a("p",[e._v("手机号已验证："+e._s(e.userInfo.phoneVerified))])])]),a("div",{staticClass:"user-info-item"},[a("div",{staticClass:"user-reg-time"},[a("p",[e._v("注册时间："+e._s(e.formateDate(e.userInfo.createTime)))])])]),a("div",{staticClass:"user-info-item"},[a("div",{staticClass:"user-modify-time"},[a("p",[e._v("修改时间："+e._s(e.formateDate(e.userInfo.modifyTime)))])])]),a("div",{staticClass:"user-info-item"},[a("div",{staticClass:"user-lock"},[a("p",[e._v("是否被锁定："+e._s(e.userInfo.isLock))])])]),a("div",{staticClass:"user-info-item"},[a("div",{staticClass:"user-lock-time"},[a("p",[e._v("锁定时长："+e._s(e.userInfo.lockTime))])])])])])},[],!1,null,"535b7a53",null).exports),Pe=a("SHqN"),Me=a.n(Pe),qe={name:"OnlineUserList",data:function(){return{users:[],page:{pageNumber:0},busy:!0,today:!1}},directives:{infiniteScroll:Me.a},methods:{initOnlineUsers:(ce=Object(V.a)(regeneratorRuntime.mark(function e(){var t,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.today){e.next=6;break}return e.next=3,F(1,30,1);case 3:t=e.sent,e.next=9;break;case 6:return e.next=8,F(1,30);case 8:t=e.sent;case 9:0===(a=t.data).code&&(this.users=a.data.users,this.page=a.data.page);case 11:case"end":return e.stop()}},e,this)})),function(){return ce.apply(this,arguments)}),getOnlineUsers:(oe=Object(V.a)(regeneratorRuntime.mark(function e(t,a){var n,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F(t,a);case 2:n=e.sent,0===(s=n.data).code&&(this.users=s.data.users,this.page=s.data.page);case 5:case"end":return e.stop()}},e,this)})),function(e,t){return oe.apply(this,arguments)}),loadMore:(re=Object(V.a)(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.busy=!0,setTimeout(Object(V.a)(regeneratorRuntime.mark(function e(){var a,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.today){e.next=6;break}return e.next=3,F(t.page.pageNumber+1,30,1);case 3:a=e.sent,e.next=9;break;case 6:return e.next=8,F(t.page.pageNumber+1,30);case 8:a=a=e.sent;case 9:0===(n=a.data).code&&n.data.users.length>0&&(t.users=t.users.concat(n.data.users),t.page=n.data.page);case 11:case"end":return e.stop()}},e,this)})),100),this.busy=!1;case 3:case"end":return e.stop()}},e,this)})),function(){return re.apply(this,arguments)})},created:function(){var e=this.$route.params.today;e&&(this.today=!0),this.initOnlineUsers()}},Fe=(a("6f9O"),Object(J.a)(qe,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"online-user"},[a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.loadMore,expression:"loadMore"}],staticClass:"online-user-container",attrs:{"infinite-scroll-disabled":"busy","infinite-scroll-distance":"30"}},e._l(e.users,function(t){return a("div",{key:t.userId,staticClass:"ol-user-item"},[a("div",{staticClass:"user-face-wrap"},[a("img",{staticClass:"ol-user-face",attrs:{src:t.face?t.face:"/static/akari.jpg"}})]),a("div",{staticClass:"ol-user-info"},[a("div",{staticClass:"u-nick"},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.nick,placement:"top-start"}},[a("a",{attrs:{target:"_blank",href:"#/home/userdetail/"+t.userId}},[e._v("\n              "+e._s(t.nick.substring(0,6))+"\n            ")])])],1),a("div",{staticClass:"u-age"},[e._v(e._s(t.age))]),a("div",{staticClass:"u-sex"},[e._v(e._s(t.sex))])])])}))])},[],!1,null,"fdd25732",null).exports),Ve=(a("201c"),a("C03Y")),Ge={name:"bangumilist",data:function(){return{list:[],page:{},query:{bangumiName:"",lastQuery:""},showAddBangumiDialog:!1,temp:{bangumiId:"",bangumiName:"",thumb:"",episodeTotal:""},listLoading:!0,multiSelection:[],headers:{"Content-Type":"multipart/form-data"},show:!1}},components:{"my-upload":Ve.a},mounted:function(){this.getDefaultBangumis()},methods:{handleSearch:function(){var e=Object(V.a)(regeneratorRuntime.mark(function e(){var t,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==this.query.bangumiName){e.next=4;break}return this.$message({showClose:!0,message:"请输入搜索内容",type:"info"}),e.abrupt("return");case 4:return e.next=6,_(this.query.bangumiName,1,20);case 6:t=e.sent,0===(a=t.data).code?(this.list=a.data.content,this.page=a.data.page,0===a.data.content.length&&this.$message({showClose:!0,message:"无搜索结果",type:"info"}),this.query.lastQuery=this.query.bangumiName):(this.list=[],this.page.totalSize=0,this.$message({showClose:!0,message:a.msg,type:"info"}));case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),getDefaultBangumis:(le=Object(V.a)(regeneratorRuntime.mark(function e(){var t,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x(1,20);case 2:t=e.sent,0===(a=t.data).code?(this.list=a.data.content,this.page=a.data.page,this.query.bangumiName="",this.query.lastQuery=""):this.$message({showClose:!0,message:t.data.msg,type:"error"}),this.listLoading=!1;case 8:case"end":return e.stop()}},e,this)})),function(){return le.apply(this,arguments)}),clearTempBangumiInfo:function(e){this.temp.bangumiName="",this.temp.episodeTotal="",this.temp.thumb="",this.temp.bangumiId="",e()},handleEdit:function(e,t,a){this.temp.bangumiName=a.bangumiName,this.temp.episodeTotal=a.episodeTotal,this.temp.thumb=a.thumb,this.temp.bangumiId=a.bangumiId,this.showAddBangumiDialog=!0},handleDelete:function(e,t){var a,n=this;this.$confirm("删除番剧："+t.bangumiName,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",callback:(a=Object(V.a)(regeneratorRuntime.mark(function a(s,i){var r;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if("confirm"!==s){a.next=8;break}return a.next=4,R(t.bangumiId);case 4:0===(r=a.sent).data.code?(n.$message({showClose:!0,message:r.data.msg,type:"success"}),n.list.splice(e,1)):n.$message({showClose:!0,message:r.data.msg,type:"error"}),a.next=9;break;case 8:n.$message({showClose:!0,message:"已取消删除",type:"info"});case 9:case"end":return a.stop()}},a,this)})),function(e,t){return a.apply(this,arguments)})})},handleDeleteInBatch:function(){var e,t=this;0!==this.multiSelection.length?this.$confirm("确定要删除多部番剧？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",callback:(e=Object(V.a)(regeneratorRuntime.mark(function e(a,n){var s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("confirm"!==a){e.next=8;break}return e.next=4,S(t.multiSelection);case 4:0===(s=e.sent).data.code?(t.$message({showClose:!0,message:s.data.msg,type:"success"}),t.getDefaultBangumis(),t.multiSelection=[]):t.$message({showClose:!0,message:s.data.msg,type:"error"}),e.next=13;break;case 8:t.temp.bangumiName="",t.temp.episodeTotal="",t.temp.thumb="",t.temp.bangumiId="",t.$message({showClose:!0,message:"已取消删除",type:"info"});case 13:case"end":return e.stop()}},e,this)})),function(t,a){return e.apply(this,arguments)})}):this.$message({showClose:!0,message:"未选中番剧",type:"info"})},handleAddBangumi:(ue=Object(V.a)(regeneratorRuntime.mark(function e(){var t,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==this.temp.bangumiId){e.next=9;break}return e.next=6,k(this.temp);case 6:t=e.sent,e.next=13;break;case 9:return e.next=12,I(this.temp.bangumiId,this.temp);case 12:t=e.sent;case 13:0===(a=t.data).code?(this.$message({showClose:!0,message:"操作成功",type:"success"}),this.showAddBangumiDialog=!1,this.temp.bangumiName="",this.temp.episodeTotal="",this.temp.thumb="",this.temp.bangumiId="",this.getDefaultBangumis()):this.$message({showClose:!0,message:a.msg,type:"error"});case 16:case"end":return e.stop()}},e,this)})),function(){return ue.apply(this,arguments)}),handleSelectionChange:function(e){this.multiSelection=e},getPrettyTime:function(e){return e},formateDate:function(e){return Te(e)},toggleShow:function(){this.show=!this.show},cropSuccess:function(e,t){},cropUploadSuccess:function(e,t){var a=e.data.link;a=a.substring(a.lastIndexOf("/")),this.temp.thumb=this.GLOBAL.imgURL+a},cropUploadFail:function(e,t){},cancelAddBangumi:function(){this.showAddBangumiDialog=!1,this.temp.bangumiName="",this.temp.thumb="",this.temp.episodeTotal="",this.temp.bangumiId=""},handleSizeChange:function(){var e=Object(V.a)(regeneratorRuntime.mark(function e(t){var a,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""===this.query.lastQuery){e.next=8;break}return e.next=5,_(this.query.lastQuery,1,t);case 5:a=e.sent,e.next=12;break;case 8:return e.next=11,x(1,t);case 11:a=e.sent;case 12:0===(n=a.data).code?(this.list=n.data.content,this.page=n.data.page):this.$message({showClose:!0,message:n.msg,type:"error"});case 15:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),handleCurrentChange:function(){var e=Object(V.a)(regeneratorRuntime.mark(function e(t){var a,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""===this.query.lastQuery){e.next=8;break}return e.next=5,_(this.query.lastQuery,t,this.page.pageSize);case 5:a=e.sent,e.next=12;break;case 8:return e.next=11,x(t,this.page.pageSize);case 11:a=e.sent;case 12:0===(n=a.data).code?(this.list=n.data.content,this.page=n.data.page):this.$message({showClose:!0,message:n.msg,type:"error"});case 15:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),toEpisode:function(e){this.$router.push({name:"episodeList",params:{bid:e}})}}},Je=(a("nqxv"),Object(J.a)(Ge,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"bangumi-list"},[a("div",{staticClass:"filter-container"},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"番剧名称"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.handleSearch(t):null}},model:{value:e.query.bangumiName,callback:function(t){e.$set(e.query,"bangumiName",t)},expression:"query.bangumiName"}}),a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{circle:"",type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch}}),a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-edit"},on:{click:function(t){e.showAddBangumiDialog=!0}}},[e._v("添加\n    ")]),a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-delete"},on:{click:e.handleDeleteInBatch}},[e._v("批量删除")]),a("el-button",{staticClass:"filter-item",attrs:{type:"primary"},on:{click:e.getDefaultBangumis}},[e._v("显示所有番剧")])],1),a("el-table",{ref:"multipleTable",attrs:{height:"600",data:e.list,"element-loading-text":"loading...",border:"","highlight-current-row":""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"35"}}),a("el-table-column",{attrs:{label:"id",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{attrs:{href:"#/home/bangumidetail/"+t.row.bangumiId}},[e._v(e._s(t.row.bangumiId))])]}}])}),a("el-table-column",{attrs:{label:"thumb",align:"center",width:"180"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("img",{attrs:{width:"160px",height:"90px",src:e.row.thumb}})]}}])}),a("el-table-column",{attrs:{label:"番剧名",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{attrs:{href:"#/home/bangumidetail/"+t.row.bangumiId}},[e._v(e._s(t.row.bangumiName))])]}}])}),a("el-table-column",{attrs:{label:"总集数",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{attrs:{href:"#/home/bangumidetail/"+t.row.bangumiId}},[a("span",[e._v(e._s(t.row.episodeTotal))])])]}}])}),a("el-table-column",{attrs:{label:"创建时间",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.formateDate(t.row.createTime)))])]}}])}),a("el-table-column",{attrs:{label:"修改时间",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.formateDate(t.row.modifyTime)))])]}}])}),a("el-table-column",{attrs:{fixed:"right",align:"center","min-width":"120",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(a){e.handleEdit(t.$index,t.row.bangumiId,t.row)}}}),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){e.handleDelete(t.$index,t.row)}}})]}}])})],1),e.listLoading?e._e():a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{"current-page":e.page.pageNumber,"page-sizes":[10,20,30,50],"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.page.totalSize},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.$set(e.page,"pageNumber",t)}}})],1),a("el-dialog",{attrs:{"before-close":e.clearTempBangumiInfo,title:"添加番剧",visible:e.showAddBangumiDialog},on:{"update:visible":function(t){e.showAddBangumiDialog=t}}},[a("el-form",{staticClass:"small-space",staticStyle:{"margin-left":"50px"},attrs:{model:e.temp,"label-position":"left","label-width":"70px"}},[a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:""!=e.temp.bangumiId,expression:"temp.bangumiId!=''"}],attrs:{label:"id"}},[a("el-input",{model:{value:e.temp.bangumiId,callback:function(t){e.$set(e.temp,"bangumiId",t)},expression:"temp.bangumiId"}})],1),a("el-form-item",{attrs:{label:"番剧名称"}},[a("el-input",{model:{value:e.temp.bangumiName,callback:function(t){e.$set(e.temp,"bangumiName",t)},expression:"temp.bangumiName"}})],1),a("el-form-item",{attrs:{label:"总集数"}},[a("el-input",{model:{value:e.temp.episodeTotal,callback:function(t){e.$set(e.temp,"episodeTotal",t)},expression:"temp.episodeTotal"}})],1),a("el-form-item",{attrs:{label:"图片"}},[a("div",{staticClass:"avatar-uploader"},[a("img",{directives:[{name:"show",rawName:"v-show",value:e.temp.thumb,expression:"temp.thumb"}],staticClass:"upload-img",attrs:{src:e.temp.thumb},on:{click:e.toggleShow}}),a("i",{directives:[{name:"show",rawName:"v-show",value:!e.temp.thumb,expression:"!temp.thumb"}],staticClass:"el-icon-plus avatar-uploader-icon",on:{click:e.toggleShow}}),a("my-upload",{attrs:{field:"image",width:960,height:540,noCircle:!0,url:e.GLOBAL.uploadURL,"img-format":"jpg",headers:e.GLOBAL.uploadHEADERS},on:{"crop-success":e.cropSuccess,"crop-upload-success":e.cropUploadSuccess,"crop-upload-fail":e.cropUploadFail},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}})],1)])],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelAddBangumi}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleAddBangumi}},[e._v("确 定")])],1)],1)],1)},[],!1,null,"7cbe4c48",null).exports),He={name:"BangumiDetail",data:function(){return{bangumiInfo:"",episodes:"",page:"",videos:"",episodeComm:0,curEpisodeInfo:"",loading:!0}},methods:{getEpisodesByBangumiId:(fe=Object(V.a)(regeneratorRuntime.mark(function e(t){var a,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O(t,1,20);case 2:a=e.sent,0===(n=a.data).code&&(this.episodes=n.data.episodes,this.page=n.data.page,this.loading=!1);case 6:case"end":return e.stop()}},e,this)})),function(e){return fe.apply(this,arguments)}),getBangumiById:(ge=Object(V.a)(regeneratorRuntime.mark(function e(t){var a,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C(t);case 2:a=e.sent,0===(n=a.data).code&&(this.bangumiInfo=n.data);case 6:case"end":return e.stop()}},e,this)})),function(e){return ge.apply(this,arguments)}),getVideosByEid:(de=Object(V.a)(regeneratorRuntime.mark(function e(t){var a,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(t,1,20);case 2:a=e.sent,0===(n=a.data).code&&(this.videos=n.data.videos);case 6:case"end":return e.stop()}},e,this)})),function(e){return de.apply(this,arguments)}),getNumOfCommentsByEid:(pe=Object(V.a)(regeneratorRuntime.mark(function e(t){var a,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p(t,1);case 2:a=e.sent,0===(n=a.data).code&&(this.episodeComm=n.data.page.totalSize);case 5:case"end":return e.stop()}},e,this)})),function(e){return pe.apply(this,arguments)}),handleClickEpIndex:function(e){this.curEpisodeInfo=e,this.getVideosByEid(e.epId),this.getNumOfCommentsByEid(e.epId)},handelDelVideo:function(e){var t,a=this;this.$confirm("确定要删除该视频？","提示",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning",callback:(t=Object(V.a)(regeneratorRuntime.mark(function t(n){var s,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("confirm"!==n){t.next=7;break}return t.next=3,L(e);case 3:s=t.sent,0===(i=s.data).code?(a.videos=a.videos.filter(function(t){return t.videoId!=e}),a.$message({showClose:!0,message:"已删除",type:"success"})):a.$message({showClose:!0,message:i.msg,type:"error"});case 7:case"end":return t.stop()}},t,this)})),function(e){return t.apply(this,arguments)})})},formateDate:function(e){return Te(e)},handleSizeChange:function(){var e=Object(V.a)(regeneratorRuntime.mark(function e(t){var a,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,O(this.bangumiInfo.bangumiId,1,t);case 3:a=e.sent,0===(n=a.data).code?(this.episodes=n.data.episodes,this.page=n.data.page):this.$message({showClose:!0,message:n.msg,type:"error"});case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),handleCurrentChange:function(){var e=Object(V.a)(regeneratorRuntime.mark(function e(t){var a,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,O(this.bangumiInfo.bangumiId,t,this.page.pageSize);case 3:a=e.sent,0===(n=a.data).code?(this.episodes=n.data.episodes,this.page=n.data.page):this.$message({showClose:!0,message:n.msg,type:"error"});case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),delEpisode:(me=Object(V.a)(regeneratorRuntime.mark(function e(t){var a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.$confirm("确定要删除该集？","提示",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning",callback:function(){var e=Object(V.a)(regeneratorRuntime.mark(function e(n){var s,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("confirm"!==n){e.next=6;break}return e.next=3,$(t);case 3:s=e.sent,0===(i=s.data).code?(a.curEpisodeInfo="",a.videos="",a.episodes=a.episodes.filter(function(e){return e.epId!=t}),a.$message({showClose:!0,message:"已删除",type:"success"})):a.$message({showClose:!0,message:i.msg,type:"error"});case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()});case 2:case"end":return e.stop()}},e,this)})),function(e){return me.apply(this,arguments)})},created:function(){var e=this.$route.params.bid;e&&(this.getBangumiById(e),this.getEpisodesByBangumiId(e))}},Ke=(a("46K/"),Object(J.a)(He,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"bangumi-detail"},[a("h1",[e._v("番剧详情")]),a("div",{staticClass:"bangumi-info"},[a("div",{staticClass:"bangumi-img-wrapper"},[a("img",{staticClass:"bangumi-img",attrs:{src:e.bangumiInfo.thumb}})]),a("div",{staticClass:"bangumi-other"},[a("div",{staticClass:"b-item"},[a("p",[e._v("bangumiId："+e._s(e.bangumiInfo.bangumiId))])]),a("div",{staticClass:"b-item"},[a("p",[e._v("名称："+e._s(e.bangumiInfo.bangumiName))])]),a("div",{staticClass:"b-item"},[a("p",[e._v("总集数："+e._s(e.bangumiInfo.episodeTotal))])]),a("div",{staticClass:"b-item"},[a("p",[e._v("创建时间："+e._s(e.formateDate(e.bangumiInfo.createTime)))])]),a("div",{staticClass:"b-item"},[a("p",[e._v("修改时间: "+e._s(e.formateDate(e.bangumiInfo.modifyTime)))])])])]),a("div",{staticClass:"episodes-container"},[e._l(e.episodes,function(t){return a("div",{key:t.epId,staticClass:"episodes"},[a("div",{staticClass:"episode"},[a("el-button",{attrs:{size:"mini"},on:{click:function(a){e.handleClickEpIndex(t)}}},[e._v(e._s(t.epIndex))])],1)])}),a("div",{directives:[{name:"show",rawName:"v-show",value:e.page.totalSize&&e.page.totalSize>10,expression:"page.totalSize && page.totalSize >10"}],staticClass:"page-info"},[e.loading?e._e():a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{"current-page":e.page.pageNumber,"page-sizes":[10,20,30,50],"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.page.totalSize},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.$set(e.page,"pageNumber",t)}}})],1)]),e.curEpisodeInfo?a("div",{staticClass:"episode-detail-wrapper"},[a("div",{staticClass:"simple-ep-info"},[a("p",[a("span",[e._v("第"+e._s(e.curEpisodeInfo.epIndex)+"集")]),a("i",{staticClass:"el-icon-delete del-ep-icon",on:{click:function(t){e.delEpisode(e.curEpisodeInfo.epId)}}})]),a("p",[e._v("danmakuId: "+e._s(e.curEpisodeInfo.danmakuId))]),a("p",[e._v(e._s(1===e.curEpisodeInfo.replyable?"可评论":"禁止评论"))]),a("p",[e._v("创建："+e._s(e.formateDate(e.curEpisodeInfo.createTime)))]),a("p",[e._v("修改："+e._s(e.formateDate(e.curEpisodeInfo.modifyTime)))]),a("p",[e._v("评论数："+e._s(e.episodeComm))]),a("p",[e._v("关联视频数："+e._s(e.videos.length))])]),a("div",{staticClass:"related-videos"},e._l(e.videos,function(t){return a("div",{key:t.videoId,staticClass:"r-video"},[a("div",{staticClass:"v-operation",on:{click:function(a){e.handelDelVideo(t.videoId)}}},[a("i",{staticClass:"el-icon-delete v-del-icon"})]),a("p",[e._v("videoId:\n            "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.videoId,placement:"top"}},[a("span",[e._v(e._s(t.videoId.substring(0,6)))])])],1),a("p",[e._v("vMD5:\n            "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.vMd5,placement:"top"}},[a("span",[e._v(e._s(t.vMd5.substring(0,6)))])])],1),a("p",[e._v("大小："+e._s((t.fileSize/1024/1024).toFixed(2))+"MB")]),a("p",[e._v(e._s(e.formateDate(t.createTime)))]),a("p",[e._v(e._s(1===t.isMatch?"已验证":"未验证"))])])}))]):e._e()],2)])},[],!1,null,"7d14ec1d",null).exports),Qe={name:"BangumiEdit",data:function(){return{temp:{bangumiId:"",bangumiName:"",thumb:"",episodeTotal:""},imageUrl:"",show:!1}},components:{"my-upload":Ve.a},methods:{toggleShow:function(){this.show=!this.show},cropSuccess:function(e,t){},cropUploadSuccess:function(e,t){var a=e.data.link;a=a.substring(a.lastIndexOf("/")),this.temp.thumb=this.GLOBAL.imgURL+a,this.imageUrl=this.GLOBAL.imgURL+a},cropUploadFail:function(e,t){},handleAddBangumi:function(){var e=Object(V.a)(regeneratorRuntime.mark(function e(){var t,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==this.temp.bangumiId){e.next=9;break}return e.next=6,k(this.temp);case 6:t=e.sent,e.next=13;break;case 9:return e.next=12,I(this.temp.bangumiId,this.temp);case 12:t=e.sent;case 13:0===(a=t.data).code?(this.$message({showClose:!0,message:"操作成功",type:"success"}),this.temp.bangumiName="",this.temp.episodeTotal="",this.temp.thumb="",this.temp.bangumiId="",this.imageUrl=""):this.$message({showClose:!0,message:a.msg,type:"error"});case 16:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}},Ze=(a("7akC"),Object(J.a)(Qe,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"bangumi-edit"},[a("div",{staticClass:"be-form"},[a("el-form",{staticClass:"small-space",attrs:{model:e.temp,"label-position":"left","label-width":"70px"}},[a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:""!=e.temp.bangumiId,expression:"temp.bangumiId!=''"}],attrs:{label:"id"}},[a("el-input",{model:{value:e.temp.bangumiId,callback:function(t){e.$set(e.temp,"bangumiId",t)},expression:"temp.bangumiId"}})],1),a("el-form-item",{attrs:{label:"番剧名称"}},[a("el-input",{model:{value:e.temp.bangumiName,callback:function(t){e.$set(e.temp,"bangumiName",t)},expression:"temp.bangumiName"}})],1),a("el-form-item",{attrs:{label:"总集数"}},[a("el-input",{model:{value:e.temp.episodeTotal,callback:function(t){e.$set(e.temp,"episodeTotal",t)},expression:"temp.episodeTotal"}})],1),a("el-form-item",{attrs:{label:"图片"}},[a("div",{staticClass:"upload-container"},[e.imageUrl?a("img",{staticClass:"upload-img",attrs:{src:e.imageUrl},on:{click:e.toggleShow}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon",on:{click:e.toggleShow}}),a("my-upload",{attrs:{field:"image",width:960,height:540,noCircle:!0,url:e.GLOBAL.uploadURL,headers:e.GLOBAL.uploadHEADERS,"img-format":"jpg"},on:{"crop-success":e.cropSuccess,"crop-upload-success":e.cropUploadSuccess,"crop-upload-fail":e.cropUploadFail},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}})],1)])],1),a("el-button",{attrs:{type:"primary"},on:{click:e.handleAddBangumi}},[e._v("添加")])],1),a("div")])},[],!1,null,"48c3df9b",null).exports),Xe={props:["bangumi"],data:function(){return{validBangumiInfo:{bangumiId:"",bangumiName:"",thumb:"",episodeTotal:""},amendMsg:""}},computed:{isPending:function(){return"待处理"===this.bangumi.pbs_name},isSuccess:function(){return"已采纳"===this.bangumi.pbs_name},isNotPerfect:function(){return"待完善"===this.bangumi.pbs_name},isFailed:function(){return"未被采纳"===this.bangumi.pbs_name},isAuditting:function(){return"待审核"===this.bangumi.pbs_name},getMsg:function(){return this.bangumi.msg&&this.bangumi.msg.length>10?this.bangumi.msg.substring(0,10)+"...":this.bangumi.msg}},methods:{formateDate:function(e){return Te(e)},approveUPB:(ve=Object(V.a)(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.validBangumiInfo.bangumiName=this.bangumi.bn,this.validBangumiInfo.thumb=this.bangumi.thumb,this.validBangumiInfo.episodeTotal=this.bangumi.et,this.$confirm("确认番剧信息无误？","提示",{confirmButtonText:"OK",cancelButtonText:"不行",type:"warning",callback:function(){var e=Object(V.a)(regeneratorRuntime.mark(function e(a){var n,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("confirm"!==a){e.next=8;break}return e.next=4,A(t.bangumi.id);case 4:n=e.sent,0===(s=n.data).code?(t.bangumi.pbs_name="已采纳",t.$emit("updatePostBangumiCard",s.data.id),t.$message({showClose:!0,message:"已添加对应番剧信息",type:"success"})):t.$message({showClose:!0,message:s.msg,type:"error"});case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()});case 6:case"end":return e.stop()}},e,this)})),function(){return ve.apply(this,arguments)}),declineUPB:(he=Object(V.a)(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.$prompt("错误信息提示：","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",callback:function(){var e=Object(V.a)(regeneratorRuntime.mark(function e(a,n){var s,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("confirm"!==a){e.next=8;break}return e.next=4,T(t.bangumi.id,2,n.inputValue);case 4:s=e.sent,0===(i=s.data).code?(t.bangumi.pbs_name="待完善",t.$emit("updatePostBangumiCard",i.data.id),t.$message({showClose:!0,message:"已反馈错误信息",type:"success"})):t.$message({showClose:!0,message:i.msg,type:"error"});case 8:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()});case 2:case"end":return e.stop()}},e,this)})),function(){return he.apply(this,arguments)}),handleAvatarSuccess:function(e,t){var a=e.data.link;a=a.substring(a.lastIndexOf("/")),this.bangumi.thumb=this.GLOBAL.imgURL+a},beforeAvatarUpload:function(e){var t=e.size/1024/1024<2;return t||this.$message.error("上传头像图片大小不能超过 2MB!"),t}}},Ye=(a("H89L"),{name:"UserPostBangumi",data:function(){return{bangumis:[],page:"",loading:!0,pbOptions:[{value:"0",label:"全部"},{value:"1",label:"待处理"},{value:"2",label:"已采纳"},{value:"3",label:"待完善"},{value:"4",label:"未被采纳"},{value:"5",label:"待审核"}],pbParams:{pn:1,ps:10,sc:"",pbsc:"",pc:"",dc:"",bn:""}}},components:{"my-card":Object(J.a)(Xe,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"upb-card"},[a("div",{staticClass:"box-card"},[a("div",{staticClass:"card-header clearfix"},[a("span",{staticStyle:{display:"inline-block",padding:"3px 5px",color:"#d2cece"}},[e._v(e._s(e.bangumi.bn))]),a("span",{staticClass:"pb-status",class:{pending:e.isPending,failed:e.isFailed,success:e.isSuccess,nperfect:e.isNotPerfect,auditting:e.isAuditting}},[e._v("\n        "+e._s(e.bangumi.pbs_name)+"\n      ")])]),a("div",{staticClass:"card-body"},[a("div",{staticClass:"bangumi-info"},[a("div",{staticClass:"thumb-wrapper"},[a("img",{staticClass:"thumb",attrs:{src:e.bangumi.thumb}})]),a("div",{staticClass:"bangumi-info-item"},[a("p",[e._v("提交日期:"),a("br"),e._v(e._s(e.formateDate(e.bangumi.create_time)))]),a("p",[e._v("修改日期:"),a("br"),e._v(e._s(e.formateDate(e.bangumi.modify_time)))]),a("p",{staticClass:"item-left"},[e._v("共"+e._s(e.bangumi.et)+"集")]),a("p",{staticClass:"item-left"},[e._v(e._s(1===e.bangumi.hzi?"有第0集":"无第0集"))]),e.bangumi.manager_user?a("p",{staticClass:"item-left"},[e._v("审核:\n            "),a("el-popover",{attrs:{placement:"top-start",trigger:"hover"}},[a("div",{staticClass:"manager-info"},[a("div",{staticClass:"manager-avatar-wrapper"},[a("img",{staticClass:"manager-avatar-img",attrs:{src:e.bangumi.manager_user.face}})]),a("div",{staticClass:"manager-nick"},[a("span",{staticClass:"manager-nick-link"},[a("a",{attrs:{target:"_blank",href:"#/home/userdetail/"+e.bangumi.manager_user.uid}},[e._v("\n                      "+e._s(e.bangumi.manager_user.nick)+"\n                    ")])])])]),a("span",{staticClass:"manager-nick-link",attrs:{slot:"reference"},slot:"reference"},[a("a",{attrs:{target:"_blank",href:"#/home/userdetail/"+e.bangumi.manager_user.uid}},[e._v("\n                  "+e._s(e.bangumi.manager_user.nick)+"\n                ")])])])],1):e._e(),e.bangumi.msg?a("p",{staticClass:"item-right-bottom"},[e._v("修改意见:"),a("br"),a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v(e._s(e.bangumi.msg))]),a("span",[e._v(e._s(e.getMsg))])])],1):e._e()])])]),a("div",{staticClass:"card-footer"},[a("div",{staticClass:"post-user"},[a("div",{staticClass:"avatar-wrapper"},[a("img",{staticClass:"avatar-img",attrs:{src:e.bangumi.post_user.face}})]),a("div",{staticClass:"user-nick"},[a("a",{attrs:{target:"_blank",href:"#/home/userdetail/"+e.bangumi.post_user.uid}},[a("span",{staticStyle:{color:"#a5a5a5"}},[e._v("\n              "+e._s(e.bangumi.post_user.nick)+"\n            ")])])])]),a("div",{staticClass:"operation"},[a("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-check",circle:""},on:{click:e.approveUPB}}),a("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete",circle:""},on:{click:e.declineUPB}})],1)])])])},[],!1,null,"1c165e67",null).exports},methods:{initUserPostBangumis:(we=Object(V.a)(regeneratorRuntime.mark(function e(){var t,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U(1,10);case 2:t=e.sent,0===(a=t.data).code?(this.bangumis=a.data.postBangumi,this.page=a.data.page,this.loading=!1):this.$message({showClose:!0,message:a.msg,type:"error"});case 5:case"end":return e.stop()}},e,this)})),function(){return we.apply(this,arguments)}),handleSizeChange:function(){var e=Object(V.a)(regeneratorRuntime.mark(function e(t){var a,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.pbParams.pn=1,this.pbParams.ps=t,e.next=5,z(this.pbParams);case 5:a=e.sent,0===(n=a.data).code?(this.bangumis=n.data.postBangumi,this.page=n.data.page):this.$message({showClose:!0,message:n.msg,type:"error"});case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),handleCurrentChange:function(){var e=Object(V.a)(regeneratorRuntime.mark(function e(t){var a,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.pbParams.pn=t,this.pbParams.ps=this.page.pageSize,e.next=5,z(this.pbParams);case 5:a=e.sent,0===(n=a.data).code?(this.bangumis=n.data.postBangumi,this.page=n.data.page):this.$message({showClose:!0,message:n.msg,type:"error"});case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),formateDate:function(e){return Te(e)},updatePostBangumiCard:function(e){var t=this;setTimeout(function(){t.bangumis=t.bangumis.filter(function(t){return t.id!=e})},3e3)},showAll:(ye=Object(V.a)(regeneratorRuntime.mark(function e(){var t,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U(1,10);case 2:t=e.sent,0===(a=t.data).code?(this.bangumis=a.data.postBangumi,this.page=a.data.page):this.$message({showClose:!0,message:a.msg,type:"error"});case 5:case"end":return e.stop()}},e,this)})),function(){return ye.apply(this,arguments)}),handleCommand:(be=Object(V.a)(regeneratorRuntime.mark(function e(t){var a,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.pbParams.pbsc="0"===t?"":t,this.pbParams.pn=1,e.next=5,z(this.pbParams);case 5:a=e.sent,0===(n=a.data).code&&(this.bangumis=n.data.postBangumi,this.page=n.data.page,this.loading=!1);case 8:case"end":return e.stop()}},e,this)})),function(e){return be.apply(this,arguments)})},created:function(){this.initUserPostBangumis()}}),We=(a("XjJy"),Object(J.a)(Ye,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"user-post-bangumi"},[a("div",{staticClass:"filter-container"},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"用户名"}}),a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{circle:"",type:"primary",icon:"el-icon-search"}}),a("el-button",{staticClass:"filter-item",attrs:{type:"primary"},on:{click:e.showAll}},[e._v("显示全部")]),a("div",{staticStyle:{display:"inline-block",float:"right"}},[a("el-dropdown",{on:{command:e.handleCommand}},[a("span",{staticClass:"el-dropdown-link"},[e._v("标签\n          "),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.pbOptions,function(t){return a("el-dropdown-item",{key:t.label,attrs:{command:t.value}},[e._v("\n            "+e._s(t.label)+"\n          ")])}))],1)],1)],1),a("div",{staticClass:"cards"},e._l(e.bangumis,function(t){return a("div",{key:t.id,staticClass:"card-wrapper"},[a("my-card",{attrs:{bangumi:t},on:{updatePostBangumiCard:e.updatePostBangumiCard}})],1)})),e.loading?e._e():a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{"current-page":e.page.pageNumber,"page-sizes":[10,20,30,50],"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.page.totalSize},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.$set(e.page,"pageNumber",t)}}})],1)])},[],!1,null,"3219cc69",null).exports),et={name:"EpisodeList"},tt=(a("GI03"),Object(J.a)(et,function(){return this.$createElement,this._self._c,this._m(0)},[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"episode-list"},[t("h1",[this._v("剧集列表")])])}],!1,null,"3e967fd8",null).exports),at={name:"EpisodeDetail"},nt=(a("kPcy"),Object(J.a)(at,function(){return this.$createElement,this._self._c,this._m(0)},[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"episode-detail"},[t("h1",[this._v("剧集详情")])])}],!1,null,"0f5a3086",null).exports),st={name:"VideoList"},it=(a("A99O"),Object(J.a)(st,function(){return this.$createElement,this._self._c,this._m(0)},[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"video-list"},[t("h1",[this._v("视频列表")])])}],!1,null,"e58c50e8",null).exports),rt={name:"VideoDetail"},ot=(a("rDlX"),Object(J.a)(rt,function(){return this.$createElement,this._self._c,this._m(0)},[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"video-detail"},[t("h1",[this._v("视频详情")])])}],!1,null,"1f293131",null).exports),ct={name:"UserPostVideo",data:function(){return{videos:[],page:"",loading:!0}},methods:{initVideos:(Ce=Object(V.a)(regeneratorRuntime.mark(function e(){var t,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E(0,1,20);case 2:t=e.sent,0===(a=t.data).code?(this.videos=a.data.videos,this.page=a.data.pageInfo,this.loading=!1):this.$message({showClose:!0,message:a.msg,type:"error"});case 5:case"end":return e.stop()}},e,this)})),function(){return Ce.apply(this,arguments)}),handleSizeChange:function(){var e=Object(V.a)(regeneratorRuntime.mark(function e(t){var a,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,E(0,1,t);case 3:a=e.sent,0===(n=a.data).code?(this.videos=n.data.videos,this.page=n.data.pageInfo):this.$message({showClose:!0,message:n.msg,type:"error"});case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),handleCurrentChange:function(){var e=Object(V.a)(regeneratorRuntime.mark(function e(t){var a,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,E(0,t,this.page.pageSize);case 3:a=e.sent,0===(n=a.data).code?(this.videos=n.data.videos,this.page=n.data.pageInfo):this.$message({showClose:!0,message:n.msg,type:"error"});case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),acceptVideo:(_e=Object(V.a)(regeneratorRuntime.mark(function e(t){var a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.isMatch=1,this.$confirm("添加该视频匹配信息？","提示",{confirmButtonText:"OK",cancelButtonText:"不行",type:"warning",callback:function(){var e=Object(V.a)(regeneratorRuntime.mark(function e(n){var s,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("confirm"!==n){e.next=6;break}return e.next=3,B(t.videoId,t);case 3:s=e.sent,0===(i=s.data).code?(a.$message({showClose:!0,message:"已添加对应视频匹配信息",type:"success"}),a.intervalId=setTimeout(function(){a.videos=a.videos.filter(function(e){return e.videoId!=t.videoId})},2e3)):a.$message({showClose:!0,message:i.msg,type:"error"});case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()});case 2:case"end":return e.stop()}},e,this)})),function(e){return _e.apply(this,arguments)}),deleteVideo:(xe=Object(V.a)(regeneratorRuntime.mark(function e(t){var a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.$confirm("删除该视频匹配信息？","提示",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning",callback:function(){var e=Object(V.a)(regeneratorRuntime.mark(function e(n){var s,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("confirm"!==n){e.next=7;break}return e.next=4,L(t);case 4:s=e.sent,0===(i=s.data).code?(a.$message({showClose:!0,message:"已删除对应视频匹配信息",type:"success"}),a.videos=a.videos.filter(function(e){return e.videoId!=t})):a.$message({showClose:!0,message:i.msg,type:"error"});case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()});case 1:case"end":return e.stop()}},e,this)})),function(e){return xe.apply(this,arguments)}),formateDate:function(e){var t=new Date(e);return t.getFullYear()+"/"+this.fillZero(t.getMonth()+1)+"/"+this.fillZero(t.getDate())+" "+this.fillZero(t.getHours())+":"+this.fillZero(t.getMinutes())+":"+this.fillZero(t.getSeconds())},fillZero:function(e){return e<10?"0"+e:e}},created:function(){this.initVideos()}},ut=(a("Ppry"),Object(J.a)(ct,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"user-post-video"},[a("h1",[e._v("用户提交的视频信息列表")]),a("div",{staticClass:"videos"},[a("div",{staticClass:"filter-container"},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"}}),a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{circle:"",type:"primary",icon:"el-icon-search"}}),a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-delete"}},[e._v("批量删除")]),a("el-button",{staticClass:"filter-item",attrs:{type:"primary"}},[e._v("显示全部")])],1),a("el-table",{ref:"video-tb",attrs:{height:"600",data:e.videos,border:"","highlight-current-row":""}},[a("el-table-column",{attrs:{type:"selection",width:"35"}}),a("el-table-column",{attrs:{label:"id",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.videoId)+"\n        ")]}}])}),a("el-table-column",{attrs:{label:"md5",align:"center",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.vMd5)+"\n        ")]}}])}),a("el-table-column",{attrs:{label:"文件大小（MB）",align:"center",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v(e._s((t.row.fileSize/1024/1024).toFixed(2)))])]}}])}),a("el-table-column",{attrs:{label:"提交时间",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.formateDate(t.row.createTime)))])]}}])}),a("el-table-column",{attrs:{label:"修改时间",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.formateDate(t.row.modifyTime)))])]}}])}),a("el-table-column",{attrs:{label:"score",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.score))])]}}])}),a("el-table-column",{attrs:{fixed:"right",align:"center","min-width":"120",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-check",circle:""},on:{click:function(a){e.acceptVideo(t.row)}}}),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){e.deleteVideo(t.row.videoId)}}})]}}])})],1),e.loading?e._e():a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{"current-page":e.page.pageNumber,"page-sizes":[10,20,30,50],"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.page.totalSize},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.$set(e.page,"pageNumber",t)}}})],1)],1)])},[],!1,null,"6c5e2e06",null).exports),lt={name:"DanmakuList"},mt=(a("0jeU"),Object(J.a)(lt,function(){return this.$createElement,this._self._c,this._m(0)},[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"danmaku-list"},[t("h1",[this._v("弹幕列表")])])}],!1,null,"21e5117b",null).exports),pt={name:"AnnounceList",data:function(){return{announces:"",busy:!0,page:{pageNumber:0}}},directives:{infiniteScroll:Me.a},filters:{formatDate:function(e){return K(new Date(e),"yyyy-MM-dd hh:mm")}},methods:{initAnnounce:(Ie=Object(V.a)(regeneratorRuntime.mark(function e(){var t,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N();case 2:t=e.sent,0===(a=t.data).code&&(this.announces=a.data.notices,this.page=a.data.page);case 5:case"end":return e.stop()}},e,this)})),function(){return Ie.apply(this,arguments)}),loadMore:function(){var e=Object(V.a)(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.busy=!0,setTimeout(Object(V.a)(regeneratorRuntime.mark(function e(){var a,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N(t.page.pageNumber+1);case 2:a=e.sent,0===(n=a.data).code&&n.data.notices.length>0&&(t.announces=t.announces.concat(n.data.notices),t.page=n.data.page);case 5:case"end":return e.stop()}},e,this)})),100),this.busy=!1;case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),handleEdit:(ke=Object(V.a)(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.$router.push({name:"announcepost",params:{announce:t}});case 2:case"end":return e.stop()}},e,this)})),function(e){return ke.apply(this,arguments)}),handleDelete:function(){var e=Object(V.a)(regeneratorRuntime.mark(function e(t){var a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.$confirm("删除该公告","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",callback:function(){var e=Object(V.a)(regeneratorRuntime.mark(function e(n,s){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("confirm"!==n){e.next=6;break}return e.next=4,M(t);case 4:0===(i=e.sent).data.code?(a.$message({showClose:!0,message:i.data.msg,type:"success"}),a.announces=a.announces.filter(function(e){return e.id!=t})):a.$message({showClose:!0,message:i.data.msg,type:"error"});case 6:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()});case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},created:function(){this.initAnnounce()}},dt=(a("p5+9"),Object(J.a)(pt,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"announce-list"},[a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.loadMore,expression:"loadMore"}],staticClass:"announce-container",attrs:{"infinite-scroll-disabled":"busy","infinite-scroll-distance":"20"}},[e._l(e.announces,function(t){return a("div",{key:t.id,staticClass:"announce-item",class:{hlmp:t.isShowIndex}},[a("div",{staticClass:"page-container"},[a("div",{staticClass:"title-container"},[a("h1",[e._v(e._s(t.title))]),a("div",[a("span",[a("i",{staticClass:"el-icon-date",staticStyle:{"padding-right":"5px"},attrs:{title:"发布时间"}}),e._v(e._s(e._f("formatDate")(t.createTime)))]),a("span",{staticStyle:{"margin-left":"15px"}},[a("i",{staticClass:"el-icon-view",staticStyle:{"padding-right":"5px"},attrs:{title:"阅读量"}}),e._v(e._s(t.viewCount))])])]),a("div",{staticClass:"ann-oper"},[a("el-button",{on:{click:function(a){e.handleEdit(t)}}},[e._v("修改")]),a("el-button",{attrs:{type:"danger"},on:{click:function(a){e.handleDelete(t.id)}}},[e._v("删除")])],1)])])}),a("div",{directives:[{name:"show",rawName:"v-show",value:0===e.announces.length,expression:"announces.length===0"}]},[a("h1",[e._v("暂无公告")])])],2)])},[],!1,null,"63bc7a38",null).exports),gt=a("lT11"),ft=a("Xd6r");a("p1OT"),a("gJae"),a("FOEY"),gt.Quill.register("modules/ImageExtend",ft.a);var ht,vt={name:"AnnouncePost",data:function(){var e=this;return{content:"",editorOption:{placeholder:"请输入内容",modules:{ImageExtend:{name:"image",size:10,action:this.GLOBAL.uploadURL,response:function(t){var a=t.data.link;a=a.substring(a.lastIndexOf("/"));var n=e.GLOBAL.imgURL+a;return n},headers:function(e){e.setRequestHeader("Authorization","Client-ID 3855bbe9883a511")},sizeError:function(){e.$message({showClose:!0,message:"图片大小不能超过10MB",type:"error"})}},toolbar:{container:ft.c,handlers:{image:function(){ft.b.emit(this.quill.id)}}}}},title:"",showInMP:!1,editMode:!1,editAnnounce:""}},components:{quillEditor:gt.quillEditor},methods:{onEditorBlur:function(e){},onEditorFocus:function(e){},onEditorReady:function(e){},postAnnounce:(ht=Object(V.a)(regeneratorRuntime.mark(function e(){var t,a,n,s,i,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.editMode){e.next=15;break}if(t={title:this.title,content:this.content,isi:this.showInMP?1:0,nid:this.editAnnounce.id},""===this.title||""===this.content){e.next=12;break}return e.next=6,P(t);case 6:a=e.sent,0===(n=a.data).code?this.$message({message:"修改成功",type:"success"}):this.$message({message:n.msg,type:"error"}),e.next=13;break;case 12:this.$message({message:"请填写标题/内容",type:"error"});case 13:e.next=26;break;case 15:if(s={title:this.title,content:this.content,isi:this.showInMP?1:0},""===this.title||""===this.content){e.next=25;break}return e.next=19,D(s);case 19:i=e.sent,0===(r=i.data).code?this.$message({message:"发表成功",type:"success"}):this.$message({message:r.msg,type:"error"}),e.next=26;break;case 25:this.$message({message:"请填写标题/内容",type:"error"});case 26:case"end":return e.stop()}},e,this)})),function(){return ht.apply(this,arguments)}),preview:function(){var e=this.$router.resolve({name:"annpreview"});sessionStorage.setItem("annTitle",this.title),sessionStorage.setItem("annContent",this.content),window.open(e.href,"_blank")}},computed:{editor:function(){return this.$refs.myQuillEditor.quill},titleWord:function(){return this.title.length}},mounted:function(){},created:function(){var e=this.$route.params.announce;e&&(this.editMode=!0,this.editAnnounce=e,this.title=e.title,this.content=e.content)}},bt=(a("5voI"),a("aZZn"),Object(J.a)(vt,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"announce-post"},[a("div",{staticClass:"announce-inner"},[a("div",{staticClass:"announce-wrap"},[a("div",{staticClass:"announce-title"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.title,expression:"title"}],staticClass:"announce-text-area",staticStyle:{"overflow-y":"hidden",height:"104px"},attrs:{maxlength:"40",placeholder:"请输入标题（建议30字以内）"},domProps:{value:e.title},on:{input:function(t){t.target.composing||(e.title=t.target.value)}}}),a("span",{staticClass:"title-count"},[e._v("\n        "+e._s(e.titleWord)+"/40\n      ")])]),a("div",{staticClass:"editor"},[a("quill-editor",{ref:"myQuillEditor",attrs:{options:e.editorOption},on:{blur:function(t){e.onEditorBlur(t)},focus:function(t){e.onEditorFocus(t)},ready:function(t){e.onEditorReady(t)}},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}})],1),a("div",[a("span",{staticStyle:{display:"inline-block",color:"#717171","margin-right":"10px"}},[e._v("在首页显示")]),a("el-switch",{attrs:{"active-color":"#3a86ef","inactive-color":"#777"},model:{value:e.showInMP,callback:function(t){e.showInMP=t},expression:"showInMP"}})],1)]),a("div",{staticClass:"post-announce-botton"},[a("el-button",{attrs:{type:"primary"},on:{click:e.postAnnounce}},[e._v("发布")]),a("el-button",{on:{click:e.preview}},[e._v("预览")])],1)])])},[],!1,null,"16934ff4",null).exports),yt={name:"AnnouncePreview",data:function(){return{title:"",content:""}},created:function(){this.title=sessionStorage.getItem("annTitle"),this.content=sessionStorage.getItem("annContent")}},wt=(a("4pXa"),a("qKL+"),Object(J.a)(yt,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"announce-prev"},[t("div",{staticClass:"page-container"},[t("div",{staticClass:"title-container"},[t("h1",[this._v(this._s(this.title))]),this._m(0)]),t("div",{staticClass:"content-container"},[t("div",{staticClass:"ctx-text",domProps:{innerHTML:this._s(this.content)}})]),t("div",{staticClass:"comment-container"}),t("div",{staticClass:"bottom-container"})])])},[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("span",[t("i",{staticClass:"el-icon-date",staticStyle:{"padding-right":"5px"},attrs:{title:"发布时间"}}),this._v("8102/12/23 12:00")]),t("span",{staticStyle:{"margin-left":"15px"}},[t("i",{staticClass:"el-icon-view",staticStyle:{"padding-right":"5px"},attrs:{title:"阅读量"}}),this._v("233")])])}],!1,null,"7f28c0e2",null).exports);n.default.use(Be.a);var xt=[{path:"/login",name:"Login",component:Ue},{path:"/announce/preview",name:"annpreview",component:wt},{path:"/",redirect:"/home/index",hidden:!0},{path:"/home",component:$e,name:"home",children:[{path:"index",component:Ae,name:"index"},{path:"apitest",component:H,name:"apitest"},{path:"user",component:Se,name:"userlist"},{path:"userdetail/:uid",component:De,name:"userdetail"},{path:"bangumi",component:Je,name:"bangumilist"},{path:"bangumidetail/:bid",component:Ke,name:"bangumidetail"},{path:"bangumiedit",component:Ze,name:"bangumiedit"},{path:"bangumi/userpost",component:We,name:"userpostbangumi"},{path:"episode",component:tt,name:"episodelist"},{path:"episodedetail/:eid",component:nt,name:"episodedetail"},{path:"video",component:it,name:"videolist"},{path:"videodetail/:vid",component:ot,name:"videodetail"},{path:"video/userpost",component:ut,name:"userpostvideo"},{path:"danmaku",component:mt,name:"danmakulist"},{path:"announce",component:dt,name:"announcelist"},{path:"announce/new",component:bt,name:"announcepost"},{path:"online/users/:today",component:Fe,name:"onlineuser"}]}],_t=new Be.a({routes:xt}),Ct=a("VYzq"),kt=a.n(Ct),It={uploadURL:"imgur-api/3/image",imgURL:"imgur",uploadHEADERS:{Authorization:"Client-ID 3855bbe9883a511"}};n.default.config.productionTip=!1,n.default.use(i.a),n.default.use(kt.a),n.default.prototype.GLOBAL=It,_t.beforeEach(function(e,t,a){if("/login"!==e.path){var n=localStorage.getItem("token"),s=localStorage.getItem("uid"),i=localStorage.getItem("nick");if(n&&s&&i){var r=localStorage.getItem("role");"ROLE_USER"===r&&a("/login")}else a("/login")}a()}),new n.default({render:function(e){return e(je)},router:_t}).$mount("#app")},XjJy:function(e,t,a){"use strict";var n=a("J08L");a.n(n).a},XveT:function(e,t,a){},ZL7j:function(e,t,a){"use strict";var n=a("EDI0");a.n(n).a},aI2Y:function(e,t,a){},aZZn:function(e,t,a){"use strict";var n=a("2NF1");a.n(n).a},"cP/g":function(e,t,a){"use strict";var n=a("+sf7");a.n(n).a},hAJP:function(e,t,a){},idlE:function(e,t,a){},kPcy:function(e,t,a){"use strict";var n=a("+mZH");a.n(n).a},"lu/m":function(e,t,a){},m5OW:function(e,t,a){},nqxv:function(e,t,a){"use strict";var n=a("XveT");a.n(n).a},"p5+9":function(e,t,a){"use strict";var n=a("CnAV");a.n(n).a},pV8X:function(e,t,a){},"qKL+":function(e,t,a){"use strict";var n=a("aI2Y");a.n(n).a},qO6A:function(e,t,a){},rDlX:function(e,t,a){"use strict";var n=a("19Xi");a.n(n).a}});